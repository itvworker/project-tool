webpackJsonpSm_name_([13],{1847:function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),n.d(i,"PLUGIN_NAME",function(){return j});var r,e=n(223),s=(n.n(e),n(30)),u=(n.n(s),n(3)),o=n(2210),h=n.n(o),a=n(2211),c=n(1),f=n.n(c),l=this&&this.t||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),v=this&&this.u||function(){return(v=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t}).apply(this,arguments)},g=u.sheets.Core,A=(u.Editor,u.sheets),d=A.range,w=A.collection,p=A.perf,m=(A.root,A.path),b=A.fill,C=A.Plugin,O=(m.setByPath,u.sheets.Hooks),y=g.Spread.Sheets,R=u.sheets.Events,F=b.fillZhSR,D=s.isMac(),j="Fill",S=function(t){function i(n){var r=t.call(this,{name:j,Constructor:i,config:n})||this;r.render=function(){var t=r.A;r.init(),g.Spread.Sheets.Fill.initSpread(t.spread.gcSpread),r.registerFillShortcut()},r.registerFillShortcut=function(){var t=r.A,i=t.spread.gcSpread.commandManager();i.register("custom-fillBottom",function(){if(!t.permissions.query.U())return!0;var i=y.Fill,n=i.AutoFillType,e=i.FillDirection,s=r.A.spread.B();if(!s.E.isEditing()){var u=s.getCurSelection(),o=s.E,h=o._commandManager(),a=o.name(),c=void 0,f=void 0;if(1===u.rowCount){var l=u.row-1;if(-1===l)return!0;c=v({},u,{row:l}),f=v({},u,{row:u.row,rowCount:u.rowCount})}else c=v({},u,{row:u.row,rowCount:1}),f=v({},u,{row:u.row+1,rowCount:u.rowCount-1});return c=d.createRange(c.row,c.col,c.rowCount,c.colCount),f=d.createRange(f.row,f.col,f.rowCount,f.colCount),h.execute({cmd:"fill",sheetName:a,startRange:c,fillRange:f,autoFillType:n.copyCells,fillDirection:e.down,srcRange:c}),!0}});i.RX("custom-fillBottom",68,!D,!1,!1,D)},r.onCollectOperatorAfterDragFillBlockCompleted=function(t,i){var n=t.args,e=n.oldCells,s=n.sheet,u=w.appendNewCells(s,e,!0,!0);p.paintWrap({obj:s,func:a.a,suspendCalcService:!0})(s,u);var o={fnName:"editCell2Changeset",params:r.A.opProcessor([s.guid(),w.addLinkAttrInfoForEditCell2Changeset(u),{skipParseFormat:!0}])};return i.push(o),i};var e=n.A;return r.A=e,r.bindEditorEvents(),r.registerHooks(),r.A.isRendered&&r.render(),r.install(),r}return l(i,t),i.prototype.setLocale=function(t){f.a.setLocaleSync(t)},i.prototype.init=function(){g.Spread.Sheets.Fill||(h()(g),g.Spread.Sheets.Fill.install(g.Spread.Sheets),g.Spread.Sheets.Fill.SR.zh=function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n]);return t}(g.Spread.Common.SR.zh,F))},i.prototype.bindEditorEvents=function(){this.A.on(R.Rendered,this.render)},i.prototype.registerHooks=function(){(0,this.A.R.RR)(O.CollectOperatorAfterDragFillBlockCompleted,this.onCollectOperatorAfterDragFillBlockCompleted)},i}(C);i.default=S},2210:function(t,i){t.exports=function(i){i.Spread.Sheets.Fill=t.exports=function(t){var i={};function n(r){if(i[r])return i[r].exports;var e=i[r]={i:r,l:!1,exports:{}};return t[r].call(e.exports,e,e.exports,n),e.l=!0,e.exports}return n.m=t,n.c=i,n.d=function(t,i,r){n.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(i,"a",i),i},n.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},n.p="",n(n.s=14)}([function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),n.d(i,"ROW_COUNT",function(){return a}),n.d(i,"COLUMN_COUNT",function(){return c}),n.d(i,"NUMBER_STRING",function(){return f}),n.d(i,"SER_NUMBER_STRING",function(){return l}),n.d(i,"SER_STRING",function(){return v}),n.d(i,"MONTH_STRING",function(){return g}),n.d(i,"DAY_STRING",function(){return A}),n.d(i,"WEEK_STRING",function(){return d}),n.d(i,"DATE_STRING",function(){return w}),i.getValType=function(t){switch(!0){case t instanceof Date:return w;case p(t):return f;case C(t):return A;case b(t):return d;case O(t):return g;case m(t):return l+t.toString().split(".").length;case y(t):return v;default:return null}},i.toArray=function(t){var i=[t];return i.rowCount=1,i.colCount=t.length,i},i.isNumber=p,i.isSerialNum=m,i.isWeek=b,i.isDay=C,i.isMonth=O,i.isAllSame=function(t){return!t.length||!t.some(function(i){return i!==t[0]})},i.isSameStep=function(t){if(t.length<=2)return!0;var i=t[1]-t[0];return!t.some(function(n,r){return 0!==r&&i!==n-t[r-1]})},i.isSerialString=y,i._hasOwnProperty=R,i._CopyProperty=function(t,i){for(var n in i)R(i,n)&&(t[n]=i[n])},i.printException=F,i.isValidRange=function(t,i,n,r,e,s){if(-1<=t&&t<e&&-1<=i&&i<s){if(-1===t&&-1===i)return!0;if(-1===t){if(0!==r&&i+r<=s)return!0}else if(-1===i){if(0!==n&&t+n<=e)return!0}else if(0!==r&&i+r<=s&&0!==n&&t+n<=e)return!0}return!1},i.cellRangeInflate=function t(i,n){var r=i.length;for(var e=0;e<r;e++){var s=i[e];if(n.intersect(s.row,s.col,s.rowCount,s.colCount))return i.splice(e--,1),t(i,n.union(s))}return n},i.isDefined=function(t){return void 0!==t},i.createElement=function(t){return document.createElement(t)},i.documentInsertBefore=function(t){document.body&&document.body.insertBefore(t,null)},i.cancelDefault=function(t){t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1);return!1},i._getPreferredZIndex=function(t){var i=document.body,n=t;for(;n&&n.parentElement&&n.parentElement!==i;)n=n.parentElement;var r,e=1e3;n&&n.parentElement===i&&(r=parseInt(o(n).css("z-index")),isNaN(r)||(e+=r));return e},i.device=function(){var t,i,n,r,e=navigator.userAgent,s=e.match(/iPad/i);s&&(t=s[0])&&(i="ipad"===t.toLowerCase());(s=e.match(/iPhone/i))&&(t=s[0])&&(n="iphone"===t.toLowerCase());(s=e.match(/android/i))&&(t=s[0])&&(r="android"===t.toLowerCase());return{ipad:!!i,iphone:!!n,android:!!r}},n.d(i,"browser",function(){return D}),i._createRange=function(t,i,n,r){return new u.a.Range(t,i,n,r)},i._getColor=function(t,i){if(t&&i){var n=t._currentTheme;if(n)return n.getColor(i)}return i};var r=n(3),e=n.n(r),s=n(1),u=n.n(s),o=u.a.GC$,h=e.a._isNumber,a="rowCount",c="colCount",f="number",l="serialNumber",v="serialString",g="monthString",A="day",d="week",w="date";function p(t){return"string"!=typeof t&&h(t)}function m(t){if(!t)return!1;return t="string"!=typeof t?t.toString():t,/^\d+\.(\d+\.)+\d+$/.test(t)}function b(t){return/^周[一,二,三,四,五,六,天,日]$/.test(t)}function C(t){return/^星期[一,二,三,四,五,六,天,日]$/.test(t)}function O(t){return-1!==["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"].indexOf(t)||-1!==["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"].indexOf(t)}function y(t){return/.*\d$/.test(t)}function R(t,i){return Object.prototype.hasOwnProperty.call(t,i)}function F(t){}var D=function(){var t=navigator.userAgent,i=function(t){t=t.toLowerCase();var i=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:i[1]||"",version:i[2]||"0"}}(t),n={};i.browser&&(n[i.browser]=!0,n.version=i.version),n.chrome?n.webkit=!0:n.webkit&&(n.safari=!0),t.indexOf("PhantomJS")>=0&&(n.safari=!1,n.chrome=!0);var r=t.toLowerCase();r.indexOf("compatible")<0&&null!==/(trident)(?:.*? rv ([\w.]+)|)/.exec(r)&&(n.mozilla=void 0,n.msie=!0);var e=/Edge\/\d+/.exec(t);return null!==e&&e.length>0&&(n.webkit=void 0,n.chrome=void 0,n.msie=!0,n.edge=!0,n.version=e[0].substr(e[0].indexOf("/")+1)),n.msie&&function(){var t=null,i=!1;try{new ActiveXObject("htmlfile")}catch(i){t=i.name}try{i=!!new ActiveXObject("htmlfile")}catch(t){i=!1}return!(i="ReferenceError"===t||!1!==i)}()&&(n.metroMode=!0),t.indexOf("QQBrowser")>-1&&(n.QQBrowser=!0),n}()},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=i.Spread.Sheets},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=i.Spread.Common},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=i.Spread.Common._Types},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),n.d(i,"SR",function(){return o}),n.d(i,"sR",function(){return h});var r=n(2),e=n.n(r),s=n(15),u=n.n(s),o={};function h(){return e.a._getResource(o)()}o.en=u.a,i.default={SR:o}},function(t,i,n){"use strict";var r=n(0),e=n(3),s=n.n(e),u=n(2),o=n.n(u),h=o.a._growth,a=o.a._leastSquare,c=s.a._isNullOrUndefined,f=function(){function t(t){this._startIndex=t}return t.prototype.add=function(t,i){c(this._type)&&(this._type=Object(r.getValType)(i)),this._indexes.push(t),this._innerValues.push(i)},t.prototype._dataCount=function(){return this._innerValues&&this._innerValues.length},t.prototype._values=function(){return this._innerValues},t.prototype._insert=function(t,i,n){c(this._type)&&(this._type=Object(r.getValType)(n)),this._indexes.splice(t,0,i),this._innerValues.splice(t,0,n)},t.prototype._indexes2=function(){var t=this._indexes,i=t?t.length:0;if(i>0){var n=this._startIndex,r=[],e=void 0;for(-1===n&&(n=t[0]),e=0;e<i;e++)r[e]=t[e]-n+1;return r}return null},t.prototype.valueConverter=function(){var t=this._innerValues;return t&&t.length?t:null},t.prototype._toActualValue=function(t){return t},t.prototype.getTrendOrGrowthValue=function(t,i,n,e){e=e||this.valueConverter(),n=n||this._indexes2();var s,u=Object(r.toArray)(e),o=Object(r.toArray)(n),a=Object(r.toArray)([i]),c=(s=t?this.trend(u,o,a,!0,function(t){return t},null,null,null):h(u,o,a,!0,null,null,null))&&s[0][0];return typeof c===r.NUMBER_STRING&&c.toString().length>15?+c.toPrecision(16):c},t.prototype._getInnerIncrease=function(t,i,n,e){var s=Object(r.getValType)(t);if(!s)return null;var u=null;if(i===s){if(this.patternMatch&&!this.patternMatch(t))return null;u=n?e?n.colCount:n.rowCount:1}return u},t.prototype.patternMatch=function(t){return!0},t.prototype.trend=function(t,i,n,e,s,u,o,h){var c,f,l,v=[],g=this.resultConverter&&this.resultConverter.bind(this),A=i[r.ROW_COUNT],d=i[r.COLUMN_COUNT],w=t[r.ROW_COUNT],p=t[r.COLUMN_COUNT],m=n[r.ROW_COUNT],b=n[r.COLUMN_COUNT];if(w!==A||p!==d)return null;var C=a(i,t,A,d),O=C.mm,y=C.d;for(c=0;c<m;c++)for(v[c]=[],f=0;f<b;f++)l=O*n[c][f]+y,v[c][f]=(g?g(l):l)||"";return v},t.prototype.resultConverter=function(t){return t},t}();i.a=f},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=i.Spread.CalcEngine},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(4),e=n(0),s=n(16),u=c(n(1)),o=c(n(6)),h=c(n(2)),a=c(n(8));function c(t){return t&&t.__esModule?t:{default:t}}var f=e._createRange,l=u.default._supportsCalc,v=h.default._Types,g=Math.floor,A=v._isNullOrUndefined,d=h.default._ArrayHelper._getLength,w=h.default._DateTimeHelper,p=w._toOADate,m=w._fromOADate;function b(t){this.PM=t}function C(t,i){switch(!0){case(0,e.isDay)(t):case(0,e.isWeek)(t):return new s.DaySource;case(0,e.isMonth)(t):return new s.MonthSource;case t instanceof Date&&a.default.isDateFormatter(i):return new s.DateSource;case(0,e.isNumber)(t):case(0,e.isSerialNum)(t):return new s.NumberSource;case(0,e.isSerialString)(t):return new s.SerialStringSource}}function O(t){return f(t.row,t.col,t.rowCount,t.colCount)}b.prototype={_fillLinearOrGrowth:function(t,i,n,r,e){var s=t?1:2;A(r)&&A(e)?this._seriesFillRange(i,n,s):this._seriesFillRange(i,n,s,r,e,null)},_seriesFillRange:function(t,i,n,e,s,u){var o=this.PM,h=o._getActualRange(t),a=h.row,c=h.col,f=h.rowCount,l=h.colCount;if(o._getSpanModel().hasSpans(a,c,f,l))throw new Error((0,r.sR)().Exp_RangeContainsMergedCell);var v,g,A,w,p,m=arguments.length>3,b=0,C=1===i,O=C?l:f,y=C?a:c,R=C?a+f:c+l,F=m?1:O,D=this.PM.OK._fillStartRange,j=D.row===a&&D.rowCount===f&&D.col>c||D.col===c&&D.colCount===l&&D.row>a;for(v=y;v<R;v++){var S=j&&m?c+l-1:c,M=j&&m?a+f-1:a,T=C?this._getSeriesSource(v,S,1,F,i):this._getSeriesSource(M,v,F,1,i);if(T&&T._dataCount())for(w=T._indexes[0],m?(p=j?T._innerValues[d(T._innerValues)-1]:T._innerValues[0],g=this._calcSeriesData(j,p,O,n,e,s,u),j&&(b=O-d(g),w=T._indexes[d(T._indexes)-1])):g=this._calcSeriesTrendData(T,O,n),A=0;A<d(g);A++){var x=T._toActualValue(g[A]);C?this._copyCell(o,v,w,v,c+b+A,x,n,!1,void 0,void 0,!0):this._copyCell(o,w,v,a+b+A,v,x,n,!1,void 0,void 0,!0)}}},_getSeriesSource:function(t,i,n,r,u){for(var o,h=null,a=this.PM,c=1===u,f=c?i+r-1:t+n-1,l=c?i:t;f>=l;)o=c?a.getValue(t,f):a.getValue(f,i),(0,e.isNumber)(o)&&(h||(h=new s.NumberSource(l)),h._insert(0,f,o)),f--;return h},_calcSeriesData:function(t,i,n,r,e,s,u){var o,h=[],a=i,c=e>=0,f=A(s);for(o=0;o<n;o++){var l=a>=s,v=a<=s;t&&(f||c&&l||!c&&v)?(h.unshift(a),1===r?a-=e:2===r?a/=e:3!==r||A(u)||(a=this._getNextDateValue(!0,u,i,a,e,o+1))):!t&&(f||c&&v||!c&&l)&&(h.push(a),1===r?a+=e:2===r?a*=e:3!==r||A(u)||(a=this._getNextDateValue(!1,u,i,a,e,o+1)))}return h},_calcSeriesTrendData:function(t,i,n){var r,e=[],s=1===n;if(s||2===n){for(1===t._dataCount()&&t.add(t._indexes[0]+1,s?t._toActualValue(t._innerValues[0]+1):t._values()[0]),r=0;r<i;r++)e.push(t.getTrendOrGrowthValue(s,r+1));return e}return null},_fillAuto:function(t,i,n,e){var s=this.PM,u=s._getSpanModel(),o=s._getActualRange(t),h=o.row,a=o.col,c=o.rowCount,f=o.colCount,l=s._getActualRange(s.OK._fillStartRange),v=l.row,g=l.col;if(u.hasPartSpans(v,g,l.rowCount,l.colCount)||u.hasPartSpans(h,a,c,f))throw new Error((0,r.sR)().Exp_ChangeMergedCell);for(var A=c,d=h;d<h+c;d++)s._isRowFilterOut&&s._isRowFilterOut(d)&&A--;return this._autoFillRange(l,A,f,i,n,!(h<v||a<g),e)},_autoFillRange:function(t,i,n,e,s,u,o){var h,a,c,l,v=this.PM,A=u?1:-1,d=t.row,w=t.col,p=t.rowCount,m=t.colCount;if(!s){var b=function(){switch(!0){case 1===e&&u:return{row:t.row,col:t.col+t.colCount,rowCount:t.rowCount,colCount:n-t.colCount};case 1===e&&!u:return{row:t.row,col:t.col+t.colCount-n,rowCount:t.rowCount,colCount:n-t.colCount};case 1!==e&&u:return{row:t.row+t.rowCount,col:t.col,rowCount:i-t.rowCount,colCount:n};default:return{row:t.row+t.rowCount-i,col:t.col,rowCount:i-t.rowCount,colCount:n}}}(),C=v&&v._getCalcModel();if(C&&C._intersectWithArrayFormula(b.row,b.col,b.rowCount,b.colCount))return v&&v._raiseInvalidOperation(4,(0,r.sR)().Exp_ArrayFromulaPart,{message:(0,r.sR)().Exp_ArrayFromulaPart}),null}if(1===e){if(h=g(n/m),a=n%m,!s)for(l=1;l<h;l++)c=f(d,w+l*A*m,p,m),this._copyRange(t,c,e,4,s,void 0,void 0,void 0,void 0,o,0);if(s&&h>1&&0===a&&(h-=1,a=m),h>0&&a>0)return c=f(d,u?w+h*m:w-h*m+m-a,p,a),this._copyRange(t,c,e,4,s,u,null,u?0:m-a,void 0,o,0)}else{for(var O=0,y=d;y<d+p;y++)this.PM._isRowFilterOut&&this.PM._isRowFilterOut(y)&&O++;var R=p-O;h=g(i/R),a=i%R;var F=0;if(!s){var D=0,j=0,S=0;for(l=1;l<h;l++){var M=R;if(u){for(S=d+l*A*R+(u?O:0),S=Math.max(D,S);this.PM._isRowFilterOut&&this.PM._isRowFilterOut(S);)S++,F++;for(var T=S;T<S+M;T++)this.PM._isRowFilterOut&&this.PM._isRowFilterOut(T)&&(M++,F++);D=S+M*A}else{var x=d-1;for(1===l&&(j=d),x=Math.min(j-1,x);this.PM._isRowFilterOut&&this.PM._isRowFilterOut(x);)x--,F++;var _=0;for(S=x;_<R;)this.PM._isRowFilterOut&&!this.PM._isRowFilterOut(S)?_++:F++,_<R&&S--;M=x-S+1,j=S}c=f(S,w,M,m),this._copyRange(t,c,e,4,s,u,null,null,!0,o,O)}}if(s&&h>1&&0===a&&(h-=1,a=p),h>0&&a>0){for(var B=u?d+h*R+O+F:d-h*R+i%R-F;this.PM._isRowFilterOut&&this.PM._isRowFilterOut(B);)u?B++:B--;return c=f(B,w,a,m),this._copyRange(t,c,e,4,s,u,u?0:R-a,null,!0,o,O)}}},_copyRange:function(t,i,n,r,s,u,o,h,a,c,f){var l,v,g,A,d,w=this.PM,p=null,m=1===n,b=m?t.row:t.col,O=m?t.col:t.row,y=m?i.row:i.col,R=m?i.col:i.row,F=m?t.rowCount-f:t.colCount,D=m?t.colCount:t.rowCount-f,j=m?i.colCount:i.rowCount,S=w.getArrayExpressionCellsInRange(t);for(A=0;A<F;A++){for(var M=null,T=null,x=0,_=b+A,B=y+A,E=_,N=B,k=(m?h:o)||0,I=m?0:k,V=m?null:a;x<D;){var U=O+x,L=R+x-k,Q=null,P=U,Y=L;if(!m){for(_=[U,U=E][0];w._isRowFilterOut&&w._isRowFilterOut(_);)_++;for(B=[L,L=N][0];w._isRowFilterOut&&w._isRowFilterOut(B);)B++}g=w._getSpanModel().find(_,U),l=w.getFormula&&w.getFormula(_,U);var X=w.getArrayValueMark(_,U);l&&""!==l||X&&S[X]||(Q=w.getValue(_,U));var G=Q,H=w.getCellType&&w.getCellType(_,U);if(H&&"8"==H.typeName&&(G=""),4===r){var K=w.getFormatter(_,U)||w.getAutoFormatter(_,U);if(M=M||C(G,K),v=(0,e.getValType)(G),T||(T=v),M&&(p=M._getInnerIncrease(G,T,g,m))){M.add(P,G),x+=p;continue}}if(G&&M&&M._dataCount()){if(d=this._autoFillTrendValues(m,t,i,E,N,M,s,u,I,V,c,f),s&&(d||0===d))return d;M=null,T=null}else{if(!g||g&&(m?g.row:g.col)===E){for(var Z=Y===R+j-1;!m&&w._isRowFilterOut&&w._isRowFilterOut(Y);)Y++;if(s){if(g&&Z||!g&&(Z&&u||!u&&Y===R))return Q}else Y<R+j&&Y>=R&&(m||!m&&!(a&&w._isRowFilterOut&&w._isRowFilterOut(Y)))&&this._copyCell(w,_,U,B,L,Q,r,c,t,i,!1)}g?x+=m?g.colCount:g.rowCount:x++}}if(M&&M._dataCount()&&(d=this._autoFillTrendValues(m,t,i,E,N,M,s,u,I,V,c,f),s&&(d||0===d)))return d}return null},_copyCell:function(t,i,n,r,e,s,u,h,a,c,f){if(i!==r||!t._isRowFilterOut||!t._isRowFilterOut(i)){var v,g,A=t._getSpanModel();if(l&&(t.hasFormula(i,n)||t.hasFormula(r,e))){var d=t.getFormulaInformation(r,e);if(d&&d.isArrayFormula){var w=d.baseRange;r===w.row&&e===w.col&&t.setArrayFormula(w.row,w.col,w.rowCount,w.colCount,null)}else t.setFormula(r,e,null);if(0===u||4===u){v=t._getCalcModel();var p=t.getFormulaInformation(i,n);if(p.hasFormula)if(p&&p.isArrayFormula){var m=p.baseRange;if(a){var b=function(t,i,n,r,e,s){switch(function(t,i,n,r){if(i>t)return"Down";if(i<t)return"Up";if(r>n)return"Right";if(r<n)return"Left"}(n,r,e,s)){case"Down":return{row:t.row,col:t.col,rowCount:i.rowCount,colCount:t.colCount};case"Up":return{row:t.row+(t.rowCount-i.rowCount),col:t.col,rowCount:i.rowCount,colCount:t.colCount};case"Right":return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:i.colCount};case"Left":return{row:t.row,col:t.col+(t.colCount-i.colCount),rowCount:t.rowCount,colCount:i.colCount}}return t}(a,c,i,r,n,e),C=O(m).getIntersect(O(b));C.row===i&&C.col===n&&o.default.CalcOperatorAdjustor.copyFormula(v,i,n,v,r,e,C.rowCount,C.colCount)}else o.default.CalcOperatorAdjustor.copyFormula(v,i,n,v,r,e,1,1)}else o.default.CalcOperatorAdjustor.copyFormula(v,i,n,v,r,e,1,1)}}t.setValue(r,e,s);var y=16380;if(h&&(y|=128),t._copyToCore(i,n,r,e,1,1,y,void 0,void 0,void 0,{ignoreNumberText:!1,clearRichText:f}),!A.isEmpty()&&(t.removeSpan(r,e,3),(g=A.find(i,n))&&i===g.row&&n===g.col)){t._addSpanImp(r,e,g.rowCount,g.colCount,3);for(var R=r;R<r+g.rowCount;R++)for(var F=e;F<e+g.colCount;F++)R===r&&F===e||(t.setValue(R,F,null),t.getFormula(R,F)&&t.setFormula(R,F,null))}}},_autoFillTrendValues:function(t,i,n,r,e,s,u,o,h,a,c,f){var l,v,g,A,d=this.PM,w=t?n.col:n.row,p=t?i.col:i.row,m=t?n.colCount:n.rowCount,b=t?i.colCount:i.rowCount-f,C=o?1:-1;h=h||0,o&&!t&&(h+=f);var O=0;if(!t)for(var y=o?i.row+i.rowCount:n.row,R=o?n.row:i.row,F=y;F<R;F++)d._isRowFilterOut&&d._isRowFilterOut(F)&&O++;o&&!t?h+=O:h-=O;var D=s._dataCount(),j=(w-p-h)/b,S=this._isArithmeticProgression(s._indexes,s.valueConverter());if(S){for(g=[],v=0;v<D;v++)g[v]=v+1;l=D}else A=s._indexes[0],l=s._indexes[D-1]-A+1,1===D&&s.add(s._indexes[0]+1,s._toActualValue(s.increase(s._innerValues[0],1))),g=s._indexes2();for(v=0;v<l;v++){var M=s.getTrendOrGrowthValue(!0,l*j+v+1,g),T=w+m-1,x=S?s._indexes[v]:A+v,_=x+j*b;if(!t)for(_+=O*C,o&&(_+=f);d._isRowFilterOut&&d._isRowFilterOut(_);)_++;if(u){if(S&&(o&&_===T||!o&&_===w)||!S&&_+h===T)return s._toActualValue(M)}else _<w+m&&_>=w&&(t?this._copyCell(d,r,x,e,_,s._toActualValue(M),4,c,i,n,!0):a&&d._isRowFilterOut&&d._isRowFilterOut(_)||this._copyCell(d,x,r,_,e,s._toActualValue(M),4,c,i,n,!0))}return null},_isArithmeticProgression:function(t,i){var n=d(i);if(n<=1||d(t)!==n)return!1;var r,e=t[1]-t[0],s=i[1]-i[0];for(r=2;r<n;r++)if(t[r]-t[r-1]!==e||i[r]-i[r-1]!==s)return!1;return!0},_fillAutoByDirection:function(t,i){var n,r=this.PM,s=r.getSpans(),u=r._getActualRange(t),o=u.row,h=u.col,a=u.rowCount,c=u.colCount;n=0===i?f(o,h+c-1,a,1):1===i?f(o,h,a,1):f(2===i?o+a-1:o,h,1,c),(n=(0,e.cellRangeInflate)(s,n))&&this._directionFillRange(n,o,h,a,c,i)},_directionFillRange:function(t,i,n,e,s,u){var o,h,a,c,l,v,A,d,w=t.row,p=t.col,m=t.rowCount,b=t.colCount,C=this.PM._getSpanModel();if(0===u?(d=C.hasSpans(i,n,e,s-b),v=0,A=-1*b,a=s,c=b,l=1):1===u?(d=C.hasSpans(i,n+b,e,s-b),v=0,A=b,a=s,c=b,l=1):2===u?(d=C.hasSpans(i,n,e-m,s),v=-1*m,A=0,a=e,c=m,l=0):(d=C.hasSpans(i+m,n,e-m,s),v=m,A=0,a=e,c=m,l=0),d)throw new Error((0,r.sR)().Exp_TargetContainsMergedCells);if(a%c!=0)throw new Error((0,r.sR)().Exp_MergedCellsIdentical);for(o=g(a/c),h=1;h<o;h++)this._copyRange(t,f(w+h*v,p+h*A,m,b),l,0)},_getNextDateValue:function(t,i,n,r,e,s){var u=t?-1:1,o=g(s*e),h=Math.abs(e),a=m(i>1?n:r);if(0===i)a.setDate(a.getDate()+u*e);else if(1===i)for(;h>0;)a.setDate(a.getDate()+u*(e>0?1:-1)),6!==a.getDay()&&0!==a.getDay()&&h--;else 2===i?a.setMonth(a.getMonth()+u*o):a.setFullYear(a.getFullYear()+u*o);return p(a)}},i.default=b},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=i.Spread.Formatter},function(t,i,n){"use strict";var r;Object.defineProperty(i,"__esModule",{value:!0}),i.sheetEx=i.regiterCmds=i.FILL_FEATURE_NAME=void 0;var e=n(4),s=n(0),u=a(n(1)),o=a(n(2)),h=a(n(7));function a(t){return t&&t.__esModule?t:{default:t}}function c(t,i,n){return i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t}var f=u.default.Events,l=u.default.Exception,v=u.default.Commands,g=u.default._SheetModel,A=u.default._supportsCalc,d=u.default.GC$,w=l.triggerError,p=v._prepareCommands,m=o.default._Types._isNullOrUndefined,b=Math.max,C=Math.floor,O=v.ActionBase,y=v._ChangedCells,R=v._CopyMoveHelper,F=R._saveViewportInfo,D=R._raiseRangeDataChanged,j=v._CopyMoveCellsInfo,S="startRange",M="fillRange",T="autoFillType",x="fillDirection",_="srcRange",B=v._performUndo,E=v._saveColumnHeaderInfo,N=v._saveViewportInfoForDragDrop,k=v._saveTableInfo,I=v._saveRowHeaderInfo,V=i.FILL_FEATURE_NAME="fill";i.regiterCmds=p((c(r={},V,{canUndo:!0,execute:function(t,i,n){return v._executeCommand(t,X,i,n)}}),c(r,"dragDrop",{canUndo:!0,execute:function(t,i,n){return v._executeCommand(t,H,i,n)}}),r));function U(t){return t.rowCount}function L(t){return t.colCount}function Q(t,i){return t.G(i)}function P(t,i){return t.H(i)}var Y=function(t){function i(i,n){var r=n[x],e=0===r,u=e||1===r,o=n[M],h=n[S],a=h.row,c=h.col,f=U(h),l=L(h);t.call(this),this.PM=i,this._autoFillExtent=n,4===n[T]?this._clearValueUndoAction=new v._ClearValueUndoAction(i,[n[M]]):this._wholeFillRange=u?(0,s._createRange)(a,e?o.col:c,f,l+L(o)):(0,s._createRange)(2===r?o.row:a,c,f+U(o),l),this._fillSeries=u?1:0}d.inherit(i,t);var n={canExecute:function(){var t=this.PM,i=this._autoFillExtent,n=i[S],r=i[M];return!!t._canChange(r.row,r.col,U(r),L(r))&&(4===i[T]||!r.intersect(n.row,n.col,U(n),L(n)))},execute:function(){if(this.canExecute()){var t=this._autoFillExtent,i=t[M],n=this.PM;this._beforeAction(n);try{A&&n.suspendCalcService(),4===t[T]?this._executeDragFillClear(n):this._executeAutoFill(n)}catch(t){(0,s.printException)(t),w(t)}finally{this._afterAction(n),A&&n.resumeCalcService(!1),n._updateTableSlicer&&n._updateTableSlicer(i.row,i.col,U(i),L(i))}}},_executeDragFillClear:function(t){this._clearValueUndoAction.execute(t);var i,n=this._autoFillExtent,r=n[S],e=n[M],u=0===this._fillSeries,o=U(r),h=L(r),a=u?b(1,o-U(e)):o,c=u?h:b(1,h-L(e));r.equals(e)||(i=(0,s._createRange)(r.row,r.col,a,c),t._setActiveCellImp(b(t._getFirstVisualRow(),i.row),b(t._getFirstVisualColumn(),i.col),t._activeRowViewportIndex,t._activeColViewportIndex),t._clearSelectionImp(),t.TH(i.row,i.col,U(i),L(i)))},_executeAutoFill:function(t){var i,n,r=this.PM,e=this._autoFillExtent[S],s=this._autoFillExtent[M],u=this._autoFillExtent[T],o=this._wholeFillRange,h={fillType:4,series:this._fillSeries,withTag:!0};if(1===u){if(r.fillAuto(e,o,h),r._getSpanModel().hasSpans(e.row,e.col,e.rowCount,e.colCount))for(i=0;i<s.rowCount;i++)for(n=0;n<s.colCount;n++){var a=r._getStyleObject(e.row+C(i%e.rowCount),e.col+C(n%e.colCount));a&&a.clone&&(a=a.clone()),a&&delete a.ignoreNumberTextPrompt,r._setStyleObject(s.row+i,s.col+n,a)}}else if(0===u)this._copyCells(e,s,15867,{feature:"fillAuto"});else if(6===u)this._copyCells(e,s,15867);else if(2===u)this._copyCells(e,s,192);else if(3===u){if(!(1!==U(e)||1!==L(e)||-1===e.row&&-1!==e.col||-1===e.col&&-1!==e.row)){this._copyCells(e,s,187)}else{var c=r._getActualRange(o),f=c.row,l=c.col,v=U(c),A=L(c),d=new g(U(c),L(c),null);for(i=0;i<v;i++)for(n=0;n<A;n++)d.setStyle(i,n,r._getStyleObject(f+i,l+n));for(r.fillAuto(e,o,h),i=0;i<v;i++)for(n=0;n<A;n++)r._setStyleObject(f+i,l+n,d.K(i,n))}}r._setActiveCellImp(b(t._getFirstVisualRow(),o.row),b(t._getFirstVisualColumn(),o.col),t._activeRowViewportIndex,t._activeColViewportIndex),t._selectionModel&&t._clearSelectionImp(),r.TH(o.row,o.col,U(o),L(o))},_copyCells:function(t,i,n,r){var e,s,u,o,h,a=this.PM,c=a._getActualRange(t),f=a._getActualRange(i),l=c.row,v=c.col,g=U(c),A=L(c),d=f.row,w=f.col,p=U(f),m=L(f),b=this._autoFillExtent[x],O=3===b,y=1===b,R=C(p/g),F=p%g,D=C(m/A),j=m%A;if(0===this._fillSeries){for(e=0;e<R;e++)o=O?d+e*g:d+p-(e+1)*g,a._isRowFilterOut&&a._isRowFilterOut(o)||a._copyToCore(l,v,o,w,g,A,n,!0,void 0,void 0,r);0!==F&&(s=O?l:l+(R+1)*g-p,o=O?d+g*R:d+p-R*g-F,a._isRowFilterOut&&a._isRowFilterOut(o)||a._copyToCore(s,v,o,w,F,A,n,!0,void 0,void 0,r))}else{for(e=0;e<D;e++)h=y?w+e*A:w+m-(e+1)*A,a._copyToCore(l,v,d,h,g,A,n,!0,void 0,void 0,r);0!==j&&(u=y?v:v+(D+1)*A-m,h=y?w+A*D:w+m-D*A-j,a._copyToCore(l,u,d,h,g,j,n,!0,void 0,void 0,r))}},saveState:function(){var t=this._autoFillExtent;4===t[T]?this._clearValueUndoAction.saveState():this._savedStartViewportCells=this._saveRangeStates(t[S]),this.PM.isDirtySuspended()||(this._savedBeforeFillChangedCells=new y(this.PM,t[M],16383)),this._savedFilledViewportCells=this._saveRangeStates(t[M])},_saveRangeStates:function(t){var i=this.PM,n=i._getActualRange(t),r=new j(U(n),L(n));return F(i,r,n.row,n.col,16383),r},undo:function(){var t=this.PM,i=!1;if(this.canUndo()){this._beforeAction(t,!0);try{A&&t.suspendCalcService();var n=t.getSelections(),r=this._autoFillExtent,e=t._fillDialog,u=r[M];i=4===r[T]?this._undoDragClear(t):this._undoDragFill(t),!t._skipCloseDragFillSmartTag&&e&&e.close(),D(t,u.row,u.col,U(u),L(u),this._savedAfterFilledChangedCells?this._savedAfterFilledChangedCells._getChangedCells():[],1),t._raiseSelectionChanging(n,t.getSelections())&&t.ME(n)}catch(t){(0,s.printException)(t),w(t)}finally{this._afterAction(t,!0),A&&t.resumeCalcService(!1)}}return i},_undoDragClear:function(t){var i=this._autoFillExtent[S],n=i.row,r=i.col,e=this._clearValueUndoAction.undo(t);return t._setActiveCellImp(b(t._getFirstVisualRow(),n),b(t._getFirstVisualColumn(),r),t._activeRowViewportIndex,t._activeColViewportIndex),t._clearSelectionImp(),t.TH(n,r,U(i),L(i)),e},_undoDragFill:function(t){var i=this._autoFillExtent,n=i[S],r=n.row,e=n.col;A&&t.suspendCalcService();try{this._undoRangeStates(this._savedFilledViewportCells,i[M]),this._undoRangeStates(this._savedStartViewportCells,n),t._setActiveCellImp(b(t._getFirstVisualRow(),r),b(t._getFirstVisualColumn(),e),t._activeRowViewportIndex,t._activeColViewportIndex),t._clearSelectionImp(),t.TH(r,e,U(n),L(n))}catch(t){(0,s.printException)(t),w(t)}finally{A&&t.resumeCalcService(!1)}return t.invalidateLayout(),!0},_undoRangeStates:function(t,i){var n=this.PM,r=n._getActualRange(i);R.AR(n,t,r.row,r.col,3)}};return d.extend(i.prototype,n),i}(O),X=function(t){function i(i,n){t.call(this),this.PM=i,this._fillExtent=n,this._startRange=n[S],this._fillRange=n[M],this._autoFillType=n[T],this._fillDirection=n[x],this._srcRange=n[_]}d.inherit(i,t);var n={execute:function(){var t=!1;if(this.canExecute()){var i=this.PM,n=this._fillRange;this._beforeAction(i,!0);try{var r=i.OK,e={sheet:i,sheetName:i._name,cancel:!1};e[M]=n,e[T]=this._autoFillType,e[x]=this._fillDirection,this._srcRange&&(e[_]=this._srcRange),i.NC(f.DragFillBlock,e),e.cancel||(r._currentAutoFillType=e[T],r._isCancelFill=e.cancel,this._executeFillAction(e),delete e.cancel,i.NC(f.DragFillBlockCompleted,e),t=!0)}catch(t){(0,s.printException)(t),w(t)}finally{this._afterAction(i,!0)}}return t},_executeFillAction:function(t){var i=this.PM,n=i.OK,r=this._fillRange,e=this._autoFillType;if(n._currentAutoFillType=e,!n._isCancelFill){var s={};s[S]=this._startRange,s[M]=r,s[T]=5===t[T]?e:t[T],s[x]=this._fillDirection;var u=new Y(i,s);i.suspendEvent("executeFillAction");try{u.execute()}catch(t){throw t}finally{i.resumeEvent("executeFillAction")}this._fillExtent._fillUndoActionImp=u}},saveState:function(){this.PM.isDirtySuspended()||(this._savedBeforeFillChangedCells=new y(this.PM,this._fillRange,16383))},undo:function(){var t=!1;if(this.canUndo()){var i=this.PM,n=this._fillRange;this.saveState(),this._beforeAction(i);try{t=this._fillExtent._fillUndoActionImp.undo()}catch(t){(0,s.printException)(t),w(t)}finally{this._applyDataChanged(!1,i,n)}}return t},_applyDataChanged:function(t,i,n){this._afterAction(i,t);var r=[];i.isDirtySuspended()||(this._savedAfterFilledChangedCells=new y(i,n,16383),this._savedAfterFilledChangedCells._mergeCellsHasDiffData(this._savedBeforeFillChangedCells._getCellsData()),r=this._savedAfterFilledChangedCells._getChangedCells()),D(i,n.row,n.col,U(n),L(n),r,1)}};return d.extend(i.prototype,n),i}(O);function G(t,i,n,r,e){t._clearSelectionImp(),t.TH(i,n,r,e);var s=i>0?i:t._getFirstVisualRow(),u=n>0?n:t._getFirstVisualColumn();t._setActiveCellImp(s,u,t._activeRowViewportIndex,t._activeColViewportIndex)}function H(t,i){O.call(this),this.PM=t,this._command=i}d.inherit(H,O),d.extend(H.prototype,{canExecute:function(){var t=this.PM,i=this._command,n=i.fromRow,r=i.fromColumn,e=U(i),u=i.columnCount,o=i.toRow,h=i.toColumn;return!!(0,s.isValidRange)(n,r,e,u,Q(t),P(t))&&(!(!i.insert&&!(0,s.isValidRange)(o,h,e,u,Q(t),P(t)))&&(t._canChange(o,h,e,u,!!i.insert)&&t._canChange(n,r,e,u)))},execute:function(){var t=!1;if(this.canExecute()){var i,n,r,e=this.PM,u=this._command;this.saveState();var o=u.fromRow,h=u.fromColumn,a=u.toRow,c=u.toColumn,f=u.rowCount,l=u.columnCount,v=u.option,g=u.collectedCells;this._beforeAction(e,!0);try{if(u.insert){if(h>=0&&o<0){i=h,n=c,r=l;var A=c,d=e._beforeUpdateArrayExprCellsByAddCols&&e._beforeUpdateArrayExprCellsByAddCols(n,r);e.L(n,r,!0),u.copy?(e.copyTo(-1,n<=i?i+r:i,-1,n,-1,r,v),e._updateArrayExprCellsByRowColOps&&d&&e._updateArrayExprCellsByRowColOps(d)):(e.moveTo(-1,n<=i?i+r:i,-1,n,-1,r,v,void 0,g),e._updateArrayExprCellsByRowColOps&&d&&e._updateArrayExprCellsByRowColOps(d),e.M(n<=i?i+r:i,r,!0),i<n&&(A=n-r)),G(e,-1,A,Q(e),r)}else if(o>=0&&h<0){i=o,n=a,r=f;var w=a;d=e._beforeUpdateArrayExprCellsByAddRows&&e._beforeUpdateArrayExprCellsByAddRows(n,r);e.addRows(n,r,!0),u.copy?(e.copyTo(n<=i?i+r:i,-1,n,-1,r,-1,v),e._updateArrayExprCellsByRowColOps&&d&&e._updateArrayExprCellsByRowColOps(d)):(e.moveTo(n<=i?i+r:i,-1,n,-1,r,-1,v,void 0,g),e._updateArrayExprCellsByRowColOps&&d&&e._updateArrayExprCellsByRowColOps(d),e.deleteRows(n<=i?i+r:i,r,!0),i<n&&(w=n-r)),G(e,w,-1,r,P(e))}}else if(u.copy?e.copyTo(o,h,a,c,f,l,v):e.moveTo(o,h,a,c,f,l,v,{row:a,col:c,rowCount:f,colCount:l},g),e){G(e,a,c,f,l);var p=u._state;u.copy||e.isDirtySuspended()||(p._savedFromAfterPastedChangedCells=this._mergeCellsData(e,p._savedFromViewportCells.data,p._savedFromBeforePastedChangedCells,o,h,f,l)),e.isDirtySuspended()||(p._savedToAfterPastedChangedCells=this._mergeCellsData(e,p._savedToViewportCells.data,p._savedToBeforePastedChangedCells,a,c,f,l))}t=!0}catch(t){(0,s.printException)(t),G(e,o,h,f,l),e._raiseInvalidOperation(0,"string"==typeof t?t:t.message)}finally{e.OK._dragRect={},this._afterAction(e,!0)}}return t},_mergeCellsData:function(t,i,n,r,e,u,o){if(i&&i._isValueOrFormulaSaved()){var h=new y(t,(0,s._createRange)(r,e,u,o),this._command.option);return h._mergeCellsHasDiffData(n._getCellsData()),R._raiseRangeDataChanged(t,r,e,u,o,h._getChangedCells(),0),h}},saveState:function(){var t,i=this.PM,n=this._command,r=n._state={},e=n.fromRow,u=n.fromColumn,o=n.toRow,h=n.toColumn,a=n.option,c=e<0?0:e,f=u<0?0:u,l=o<0?0:o,v=h<0?0:h,g=e<0?Q(i):U(n),A=u<0?P(i):n.columnCount;if(n.insert){if(u<0&&e>=0){var d=i.tables;!n.copy&&d&&d._has(l,-1,1,-1)&&(t=I(i,c,g,a),r._savedFromRowHeaderCells=t.headerCells,r._savedFromRows=t.rows,r._savedFromViewportCells=N(i,c,f,g,A,a))}}else e<0&&(t=E(i,v,A,a),r._savedToColumnHeaderCells=t.headerCells,r._savedToColumns=t.columns,n.copy||(t=E(i,f,A,a),r._savedFromColumnHeaderCells=t.headerCells,r._savedFromColumns=t.columns)),u<0&&(t=I(i,l,g,a),r._savedToRowHeaderCells=t.headerCells,r._savedToRows=t.rows,n.copy||(t=I(i,c,g,a),r._savedFromRowHeaderCells=t.headerCells,r._savedFromRows=t.rows)),r._savedToTables=k(i,l,v,g,A),r._savedToViewportCells=N(i,l,v,g,A,a),n.copy||(r._savedFromTables=k(i,c,f,g,A),r._savedFromViewportCells=N(i,c,f,g,A,a),i.isDirtySuspended()||(r._savedFromBeforePastedChangedCells=new y(i,(0,s._createRange)(c,f,g,A),a))),i.isDirtySuspended()||(r._savedToBeforePastedChangedCells=new y(i,(0,s._createRange)(l,v,g,A),a));r._savedAcitveRowViewportIndex=i._activeRowViewportIndex,r._savedAcitveColumnViewportIndex=i._activeColViewportIndex,r._savedActiveRow=i._activeRowIndex,r._savedActiveColumn=i._activeColIndex},undo:function(){var t=0;if(this.canUndo()){var n,r,e,u=this.PM,o=this._command,h=o.fromRow,a=o.fromColumn,c=o.toRow,f=o.toColumn,l=U(o),v=o.columnCount;if(!(0,s.isValidRange)(h,a,l,v,Q(u),P(u)))return!1;if(!o.insert&&!(0,s.isValidRange)(c,f,l,v,Q(u),P(u)))return!1;var g=o._state;this._beforeAction(u,!0);try{if(o.insert){if(!(a>=0&&h>=0))if(a>=0){var A=a;n=v,o.copy?u.M(f,n):(r=f,e=a,a<f?r=f-n:e=a+n,u.L(e,n),u.copyTo(-1,e<=r?r+n:r,-1,e,-1,n,o.option),u.M(e<=r?r+n:r,n),r<e&&(A=e-n)),u&&G(u,-1,A,Q(u),n),t++}else if(h>=0){n=l;var d=h;o.copy?u.deleteRows(c,n):(r=c,e=h,h<c?r=c-n:e=h+n,u.addRows(e,n),t+=B(this,g._savedFromViewportCells),t+=B(this,g._savedFromRowHeaderCells),(t+=B(this,g._savedFromRows))||u.copyTo(e<=r?r+n:r,-1,e,-1,n,-1,o.option),u.deleteRows(e<=r?r+n:r,n),r<e&&(d=e-n)),u&&G(u,d,-1,n,P(u)),t++}}else{var p=h<0?0:h,m=a<0?0:a,b=c<0?0:c,C=f<0?0:f,O=h<0?Q(u):l,y=a<0?P(u):v;i._supportsCalc&&R._clearFormula(u,b,C,O,y);var F=null,D=null,j=g._savedFromViewportCells;!o.copy&&j&&j.data&&j.data._isValueOrFormulaSaved()&&(D=R._getValues(u,p,m,O,y));var S=g._savedToViewportCells;S&&S.data&&S.data._isValueOrFormulaSaved()&&(F=R._getValues(u,b,C,O,y)),t+=B(this,g._savedToTables),t+=B(this,g._savedToColumnHeaderCells),t+=B(this,g._savedToColumns),t+=B(this,S),t+=B(this,g._savedToRowHeaderCells),t+=B(this,g._savedToRows),t+=B(this,g._savedFromTables),t+=B(this,g._savedFromColumnHeaderCells),t+=B(this,g._savedFromColumns),t+=B(this,j),t+=B(this,g._savedFromRowHeaderCells),(t+=B(this,g._savedFromRows))&&u&&(G(u,h,a,l,v),F&&R._raiseRangeDataChanged(u,b,C,O,y,g._savedToAfterPastedChangedCells?g._savedToAfterPastedChangedCells._getChangedCells():[],0),D&&R._raiseRangeDataChanged(u,p,m,O,y,g._savedFromAfterPastedChangedCells?g._savedFromAfterPastedChangedCells._getChangedCells():[],0))}if(t&&u){if(-1!==g._savedActiveRow&&-1!==g._savedActiveColumn){var M=u.getSelections()[0];M.contains(g._savedActiveRow,g._savedActiveColumn)?u.MJ(g._savedActiveRow,g._savedActiveColumn):u.MJ(M.row,M.col)}-2!==g._savedAcitveRowViewportIndex&&-2!==g._savedAcitveColumnViewportIndex&&-1!==g._savedActiveRow&&-1!==g._savedActiveColumn&&u.showCell(g._savedActiveRow,g._savedActiveColumn,3,3)}}catch(t){(0,s.printException)(t),w(t)}finally{this._afterAction(u,!0)}}return t>0}});i.sheetEx={fillAuto:function(t,i,n){if(!i)throw new Error((0,e.sR)().Exp_RangeIsNull);var r=n.fillType,s=n.series,u=n.direction,a=n.step,c=n.stop,f=new h.default(this);(function(t,i,n,r){return!!(t&&i&&i.containsRange(t))&&(!m(n)&&(1===n&&t.row===i.row&&U(t)===U(i)||0===n&&t.col===i.col&&L(t)===L(i))||!(m(r)||(2!==r&&3!==r||t.col!==i.col||L(t)!==L(i))&&(0!==r&&1!==r||t.row!==i.row||U(t)!==U(i))))})(t,i,u?null:s,u)&&(t&&(this.OK._fillStartRange=t),4===r?f._fillAuto(i,s,!1,n.withTag):0===r?f._fillAutoByDirection(i,u):1===r||2===r?f._fillLinearOrGrowth(1===r,i,s,a,c):3===r&&f._seriesFillRange(i,s,3,a,m(c)?null:o.default._DateTimeHelper._toOADate(c),n.unit),this.NR())}}},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r,e=n(4),s=n(1),u=n.n(s),o=n(0),h=this&&this.t||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),a=u.a.GC$,c=u.a._BaseDialog,f=o._getPreferredZIndex,l=o.device,v=a(document),g=" btn btn-default",A="sm-sheet-fill-type-item",d="sm-sheet-fill-menu-container",w="ui-icon ui-icon-check sm-sheet-check-image",p="sm-sheet-menu-item-input",m="ui-state-active sm-sheet-smart-tag-active",b="sm-sheet-tag-container",C="float",O="left",y="display",R="width",F="height",D="margin";function j(t,i,n,r,e,s){var u=t._isTouchMode,h=u?"160px":"150px",c=u?"25px":"20px",f=a(Object(o.createElement)("div")).css([y,R,F,"padding",D],["block",h,c,0,0]).addClass("sm-sheet-smartMenu-item-default "+n+" ui-state-default"+g),l=a(Object(o.createElement)("div")).addClass(p).appendTo(f),v=a(Object(o.createElement)("div")).addClass("sm-sheet-menu-item-text").appendTo(f),A=a(Object(o.createElement)("input")).attr({id:i,value:e,type:"radio",name:"fill-group",style:"display:none"}).appendTo(l);return a(Object(o.createElement)("span")).text(r).appendTo(v),s?(l.addClass(w),A.prop("checked","checked")):A.prop("checked",""),f}var S=function(t){function i(i,n){var r=t.call(this,i,f(n.parent._host))||this;r.PM=n,r._smartTagContainer=a("."+b);var s=r._menuContainer=r._getContainer();return s.addClass(d),j(n,"smartMenuCopyCells",A,Object(e.sR)().CopyCells,"0",!0).appendTo(s),j(n,"smartMenuFillSeries",A,Object(e.sR)().FillSeries,"1").appendTo(s),j(n,"smartMenuFillFormattingOnly",A,Object(e.sR)().FillFormattingOnly,"2").appendTo(s),j(n,"smartMenuFillWithoutFormatting",A,Object(e.sR)().FillWithoutFormatting,"3").appendTo(s),r}return h(i,t),i.prototype._attachEvent=function(){var t=this;a("."+A).bind("mouseover",function(t){a(t.elementItem).addClass("ui-state-hover sm-sheet-smartMenu-item-hover")}).bind("mouseout",function(t){a(t.elementItem).removeClass("ui-state-hover sm-sheet-smartMenu-item-hover")}).bind("click",function(i){var n=a(i.elementItem),r=t._smartTagContainer,e=n.find("input[type=radio]"),s=e[0];s.checked=!0,e.trigger("change"),r.trigger("click"),r.trigger("mouseout"),n.removeClass("ui-state-hover sm-sheet-smartMenu-item-hover");var u=parseInt(a(s).attr("value"));t._changeFill(u)}),this._menuContainer.find("input[type=radio]").bind("change",function(t){a("."+p).removeClass(w),a(t.elementItem).parent().addClass(w)})},i.prototype._dettachEvent=function(){a("."+A).unbind("mouseover").unbind("mouseout").unbind("click"),this._menuContainer.find("input[type=radio]").unbind("change")},i.prototype._changeFill=function(t){var i=this.PM,n=i.OK;this._fillType!==t&&(this._fillType=t,i._skipCloseDragFillSmartTag=!0,i._skipCloseDragFillSmartTag=!1,i._commandManager().execute({cmd:"fill",sheetName:i.name(),startRange:n._fillStartRange,fillRange:n._currentFillRange,autoFillType:t,fillDirection:n._currentFillDirection}),this._smartTagContainer.trigger("fillTypeChanged",t))},i.prototype._isOpen=function(){return!!a("."+d).length},i}(c);function M(t){return t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAASCAYAAACXScT7AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAGCSURBVHjafNFPKKRxHAbw5/v7GYdBYUQjLm5SkoNykCQHtcx431/KgdKumJvSrAO7Nwc3RQ5kd3OkHJC/hUJREluonVcToqRh3sRFPA6M1Mbhc3z6Pj1fkMRHQNJL0uPeul731lU37o1y49cqHr8GvvgWQRLBsmpM/P0j4XAXiooKcXl1CZDEzl4EJBEwAZBUwWAQsVgsFSRR11gmM8trimSa3WypzZ31l5v2/vfk/4oAcv9aSGyUSz4gg/AIAOET0YQswIQWaNrnH+2OeSaY0BJN2+wDTi/OpCrwkxX1vW8q63p5cnaaB+Z/09u7x0nFJTVMiEajPsNCQaC6Ryb8THKcw/Tikho6zj//0RGUNV6gMZ1H8fmpH5iTHDlwsiOhO7FrN5RdP6aBIUj/pvJ2bkFbkxAzBzELELNCQQqgrJ5ST1/jqmYOJcHa7dYYGV5TrQ3d+vfUU+b7IfrOIRCGBYD0o1VGmaHaB6DZkqvMD2hUfF1UAISkvE/+yqbCZ89+HgBtwgFOrBUzJgAAAABJRU5ErkJggg==":"data:image/png;base64,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"}var T=function(t){function i(i,n,r){var e=t.call(this,i,f(n.parent._host))||this;e.PM=n,e._fillInfo=r;var s=e._tagContainer=e._getContainer().addClass("sm-sheet-smart-tag-default "+b+" sm-sheet-no-select ui-widget-header"+g);return e._smartTag=a(Object(o.createElement)("img")).attr("src",M(0)).css(C,O).appendTo(s),e._smartTagDown=a(Object(o.createElement)("img")).attr("src",M(1)).css([C,y],[O,"none"]).appendTo(s),e}return h(i,t),i.prototype._doMouseEvent=function(t,i,n){var r=this.PM._isTouchMode,e=a(i),s=this._menuDialog,u=this._smartTagDown,o=r?"38px":"32px",h=r?"24px":"18px";s&&s._isOpen()||(t?e.addClass("ui-state-hover sm-sheet-smart-tag-hover"):e.removeClass("ui-state-hover sm-sheet-smart-tag-hover"),e.css([R,F],[t?o:h,h]),n||(t?u.show():u.hide()))},i.prototype._registerEvent=function(){var t=this,i=t._tagContainer,n=l(),r=o.browser.safari&&(n.ipad||n.iphone);i.bind("mouseover",function(i){t._doMouseEvent(!0,i.elementItem,r)}).bind("mouseout",function(i){t._doMouseEvent(!1,i.elementItem,r)}),i.bind("click",function(i){var n=a(i.elementItem),e=t._menuDialog,s=t._smartTagDown;if(e&&e._isOpen())r&&s.hide(),n.removeClass(m),t._closeMenu();else{r&&s.show(),n.addClass(m),t._openMenu();var u=t._menuContainer,o=u&&u.find("input[type=radio]")[t._fillInfo.fillType];o&&!o.checked&&(o.checked=!0,a(o).trigger("change"))}}),v.bind("keydown.ui-fill",function(i){27===i.keyCode&&(t._menuDialog&&t._menuDialog._isOpen()?t._closeMenu():t.close(),Object(o.cancelDefault)(i))})},i.prototype._open=function(){var t=this._tagContainer,i=this._fillInfo,n=this.PM._isTouchMode,r=n?"3px":"0px",e=n?"24px":"18px";t&&(t.css([O,"top"],[i.x,i.y])(this)._show(),this._registerEvent(),this._smartTag.css(D,r),this._smartTagDown.css(F,e),this._reset())},i.prototype._openMenu=function(){var t=this.PM;this._menuDialog||(this._menuDialog=new S(t.parent._getContainerDiv(),t),this._menuContainer=this._menuDialog._getContainer());var i=this._tagContainer,n=i.css(O),r=i.css("top"),e=parseFloat(r),s=this._menuDialog,u=this._fillInfo;s._fillType=u.fillType,isNaN(e)||(r=e+i.height()+2),this._menuContainer.css([O,"top"],[n,r]),s._show(),s._attachEvent(),s._smartTagContainer.unbind("fillTypeChanged").bind("fillTypeChanged",function(t,i){u.fillType=i})},i.prototype._closeMenu=function(){var t=this._menuDialog;t&&(t._dettachEvent(),t.close())},i.prototype._reset=function(){var t=this._menuDialog,i=this._tagContainer;t&&(t._isOpen()&&i.trigger("click"),i.trigger("mouseout"))},i.prototype.close=function(){var i=this.PM;this._reset(),v.unbind("keydown.ui-fill"),t.prototype.close.call(this),i&&i.MI()},i}(c);i.default=T},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),n.d(i,"state",function(){return e}),n.d(i,"STATES",function(){return s});var r=n(3),e=(0,n.n(r).a.makeState)(),s={dragFillIndicatorRect:"_dragFillIndicatorRect",dragOldRect:"_dragOldRect",insertDragRect:"_insertDragRect"}},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i._paintDragFillIndicator=function(t,i,n,r,e,h){var c=t.PM,f=c.LM(),l=c.parent,v=l&&l._themeVersion,g=function(t,i,n){var r=t.PM,e=i.x,s=i.y,u=i.width,h=i.height,a=r._getActiveSelectedRange(),c=r.LM(),f=4,l=-2.5;n>2007&&(f=5,l=-3);var v=new o(-4,-4,f,f);-1===a.col?(v.x=c._frozenX,v.y=s+h+l):-1===a.row?(v.x=e+u+l,v.y=c._frozenY):(v.x=e+u+l,v.y=s+h+l);return v}(t,e,v),A=g.x,d=g.y,w=g.width,p=g.height,m=f.MB(n,r);if((!h||g.intersectRect(h))&&g.intersectRect(m)){var b=-1.5;v>2007&&(b=-1);var C=new o(A+b,d+b,w+2,p+2);C.x=Math.max(C.x,m.x),C.y=Math.max(C.y,m.y),t.LD([a({rect:C})]),i.save(),h&&!h.containsRect(g)&&(i.rect(h.x,h.y,h.width,h.height),i.clip()),i.beginPath(),i.fillStyle=Object(u._getColor)(c,c.getSelectionBorderColor()),i.fillRect(A,d,w,p),Object(s.state)(s.STATES.dragFillIndicatorRect,new o(g.x,g.y,4,4)),i.beginPath(),i.restore()}},i._paintDragRectangle=function(t,i){var n=i.x,r=i.y,e=n+i.width,s=r+i.height;d(t,n,r,e,r),d(t,n,s,e,s),d(t,n,r,n,s),d(t,e,r,e,s)},i._paintDragInsertLine=l,i._paintDragDropRectangle=v,i._paintDragDropIndicator=A,i._refreshDragDropIndicator=function(t){var i=t.PM,n=i._currentTarget;if(!n||!n.dragInfo)return;var r=t._getCtx(),e=i.LM(),u=i.OK._actualDragRange,h=i.OK._dragRect;-1===h.row&&(h.col=u.col);-1===h.col&&(h.row=u.row);var a=i._getRangeWholeRect(u),c=i.frozenTrailingColumnCount(),f=i.frozenTrailingRowCount(),l=i.H()-c,v=i.G()-f,g=e.MB(1,1);c>0&&u.col+u.colCount<=l&&a.x+a.width>g.x+g.width&&a.intersectRect(g)&&(a=a.getIntersectRect(g));f>0&&u.row+u.rowCount<=v&&a.y+a.height>g.y+g.height&&a.intersectRect(g)&&(a=a.getIntersectRect(g));var d=new o(e._frozenX,e._frozenY,e._frozenTrailingX+e._frozenTrailingWidth,e._frozenTrailingY+e._frozenTrailingHeight);a.width>0&&a.height>0?(h.x=a.x,h.y=a.y,h.width=a.width-1,h.height=a.height-1,A(t,r,d)):0!==a.width&&0!==a.height||(h.x=a.x,h.y=a.y,h.width=a.width,h.height=a.height,A(t,r,d));!0===i.OK._isDragInsert?Object(s.state)(s.STATES.dragOldRect,Object(s.state)(s.STATES.insertDragRect)):Object(s.state)(s.STATES.dragOldRect,new o(h.x,h.y,h.width,h.height))};var r=n(1),e=n.n(r),s=n(11),u=n(0),o=e.a.Rect,h=e.a._createLine,a=e.a._Directive_CopyBuffer,c=e.a._Directive_RepaintSelection,f="#71a1e6";function l(t,i){t.save(),t.strokeStyle=f,t.beginPath();var n=0===i.height?.1:i.height,r=0===i.width?.1:i.width;t.rect(i.x,i.y,r,n),t.closePath(),t.lineWidth=2,t.lineJoin="miter",t.stroke(),t.restore()}function v(t,i){t.save(),t.strokeStyle=f,t.beginPath(),t.rect(i.x,i.y,i.width,i.height),t.closePath(),t.lineWidth=2,t.lineJoin="miter",t.setLineDash([4,4]),t.stroke(),t.restore()}function g(t,i,n){var r=t.PM;t.LD([a({rect:i,clipRect:n}),c({range:r._getActiveSelectedRange(),clipRect:n})])}function A(t,i,n){var r=t.PM,e=r.OK._dragRect,u=e.hitTarget;if(e&&u){var h=e.hitCol,a=e.hitRow,c=r.OK._isDragInsert,f=Object(s.state)(s.STATES.dragOldRect);if(i.save(),!0!==c||-1!==e.row&&-1!==e.col)f&&g(t,new o(f.x-2,f.y-2,f.width+4,f.height+4),n),v(i,e);else if(-1===e.row&&-1!==e.col){var A=r.NE(0).findCol(h);if(A||(A=r.NE(1).findCol(h)),A||(A=r.NE(2).findCol(h)),A){var d=A.x,w=A.width;e.col=h,u.x>d+w/2&&(e.col<r._getLastFullyVisibleColumn()||e.col===r._getLastVisualColumn())&&(d=A.x+A.width,e.col++),f&&0===f.width||(f=r.OK._dragRect),f&&g(t,new o(f.x-2,f.y-2,f.width+4,f.height+4),n);var p=new o(d,e.y,0,e.height);Object(s.state)(s.STATES.insertDragRect,p),l(i,p)}}else if(-1!==e.row&&-1===e.col){var m=r._getRowLayout(0).findRow(a);if(m||(m=r._getRowLayout(1).findRow(a)),m||(m=r._getRowLayout(2).findRow(a)),m){var b=m.y,C=m.height;e.row=a,u.y>b+C/2&&(e.row<r._getLastFullyVisibleRow()||e.row===r._getLastVisualRow())&&(b=m.y+m.height,e.row++),f&&0===f.height||(f=r.OK._dragRect),f&&g(t,new o(f.x-2,f.y-2,f.width+4,f.height+4),n);p=new o(e.x,b,e.width,0);Object(s.state)(s.STATES.insertDragRect,p),l(i,p)}}i.beginPath(),i.restore()}}function d(t,i,n,r,e){var s;t.globalCompositeOperation="source-over",t.strokeStyle=f,t.save(),i===r?(t.rect(i-2,n,7,Math.abs(e-n)),t.clip(),t.beginPath(),n<e?(n-=3,e+=3):(n+=3,e-=3),s=h(i,n,r,e,"black",2)):n===e&&(t.rect(i,n-2,Math.abs(r-i),7),t.clip(),t.beginPath(),i<r?(i-=3,r+=3):(i+=3,r-=3),s=h(i,n,r,e,"black",1)),s.LY(t),t.stroke(),t.beginPath(),t.restore()}},function(t,i,n){"use strict";n.d(i,"a",function(){return r}),n.d(i,"d",function(){return e}),n.d(i,"e",function(){return s}),n.d(i,"f",function(){return u}),n.d(i,"c",function(){return o}),n.d(i,"b",function(){return h});var r={copyCells:0,fillSeries:1,fillFormattingOnly:2,fillWithoutFormatting:3,clearValues:4,auto:5},e={left:0,right:1,up:2,down:3},s={column:0,row:1},u={direction:0,linear:1,growth:2,date:3,auto:4},o={day:0,weekday:1,month:2,year:3},h={FILL:"fill",DRAG_DROP:"dragDrop"}},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.install=function(t){Object(r._CopyProperty)(t.Worksheet.prototype,e.sheetEx),Object(r._CopyProperty)(t.Worksheet.prototype,s.sheetEx),Object(r._CopyProperty)(t._SheetEventHandler.prototype,s.sheetEventHandlerExt),Object(f.a)(),Object(c.a)(),A("Fill")},i.initSpread=function(t){var i=t.B();i&&Object(e.regiterCmds)(i._commandManager())},n.d(i,"SR",function(){return d}),n.d(i,"_FillDialog",function(){return w}),n.d(i,"_FillImp",function(){return p});var r=n(0),e=n(9),s=(n.n(e),n(22)),u=(n.n(s),n(4)),o=n(10),h=n(7),a=n.n(h),c=n(23),f=n(24),l=n(1),v=n.n(l),g=n(13);n.d(i,"AutoFillType",function(){return g.a}),n.d(i,"FillDirection",function(){return g.d}),n.d(i,"FillSeries",function(){return g.e}),n.d(i,"FillType",function(){return g.f}),n.d(i,"FillDateUnit",function(){return g.c}),n.d(i,"COMMANDS",function(){return g.b});var A=v.a.activateFeatures;var d=u.SR,w=o.default,p=a.a},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default={CopyCells:"Copy Cells",FillSeries:"Fill Series",FillFormattingOnly:"Fill Formatting Only",FillWithoutFormatting:"Fill Without Formatting",Exp_NumberOnly:"Only works for Numbers",Exp_RangeContainsMergedCell:"Range should not have merged cells.",Exp_TargetContainsMergedCells:"Target range should not have merged cells.",Exp_MergedCellsIdentical:"This operation requires the merged cells to be identically sized.",Exp_FillRangeContainsMergedCell:"Cannot fill range that contains a merged cell.",Exp_FillCellsReadOnly:"The cells you are trying to fill are protected and therefore read-only.",Exp_ChangeMergedCell:"Cannot change part of merged cell.",Exp_ColumnReadOnly:"The column you are trying to change is protected and therefore read-only.",Exp_RowReadOnly:"The row you are trying to change is protected and therefore read-only.",Exp_CellReadOnly:"The cell you are trying to change is protected and therefore read-only.",Exp_RangeIsNull:"range is null",Exp_ChangePartOfArray:"Cannot change part of an array."}},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(17),e=n(18),s=n(19),u=n(20),o=n(21);n.d(i,"NumberSource",function(){return r.a}),n.d(i,"DaySource",function(){return e.a}),n.d(i,"MonthSource",function(){return s.a}),n.d(i,"SerialStringSource",function(){return u.a}),n.d(i,"DateSource",function(){return o.a})},function(t,i,n){"use strict";var r,e=n(5),s=n(0),u=n(3),o=n.n(u),h=n(2),a=n.n(h),c=n(4),f=n(6),l=n.n(f),v=this&&this.t||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),g=o.a._isNullOrUndefined,A=o.a._toDouble,d=a.a._trendSerial,w=a.a._trend,p=l.a.Convert,m=function(t){function i(i){var n=t.call(this,i)||this;return n._indexes=[],n._innerValues=[],n._type=null,n._startIndex=g(i)?-1:i,n}return v(i,t),i.prototype.increase=function(t,i){var n=Object(s.getValType)(t);if(this._isSerialNumber(n)){var r=t.split(".");return r[r.length-1]=String(+r[r.length-1]+i),r.join(".")}return t+i},i.prototype.trend=function(t,i,n,r,e,s,u,o){var h=[t,i,n,r,e,s,u,o];return this._isSerialNumber()?d.apply(null,h):w.apply(null,h)},i.prototype._values=function(){var t,i,n=[],r=this._innerValues,e=r?r.length:0;for(t=0;t<e;t++)i=r[t],n.push("object"===this._type?this._toDateTime(i):i);return n},i.prototype._insert=function(t,i,n){var r=n;if(!Object(s.isNumber)(r))throw new Error(Object(c.sR)().Exp_NumberOnly);g(this._type)&&(this._type=Object(s.getValType)(r)),this._isSerialNumber()||(r=A(r)),this._indexes.splice(t,0,i),this._innerValues.splice(t,0,r)},i.prototype.add=function(t,i){var n=i;g(this._type)&&(this._type=Object(s.getValType)(n)),this._isSerialNumber()||(n=A(n)),this._indexes.push(t),this._innerValues.push(n)},i.prototype._toActualValue=function(t){return this._type===s.DATE_STRING?this._toDateTime(t):t},i.prototype._toDateTime=function(t){var i=null;if(t instanceof Date)i=t;else if(p)try{i=p._toDateTime(t)}catch(n){Object(s.printException)(n),i=t}return i},i.prototype._isSerialNumber=function(t){return-1!==(t=t||this._type).indexOf(s.SER_NUMBER_STRING)},i}(e.a);i.a=m},function(t,i,n){"use strict";var r,e=n(5),s=n(0),u=n(3),o=n.n(u),h=n(2),a=n.n(h),c=this&&this.t||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),f=a.a._DayList,l=a.a._DayListAlias,v=a.a._DayLen,g=a.a._getDayByIndex,A=o.a._isNullOrUndefined,d=function(t){function i(i){var n=t.call(this,i)||this;return n._indexes=[],n._innerValues=[],n._type=null,n._useSundayAlias=!1,n._startIndex=A(i)?-1:i,n._days=f,n._dayAlias=l,n._dayLength=v,n._SundayAlias="天",n}return c(i,t),i.prototype.valueConverter=function(){var t,i,n=this,r=this._innerValues;return r&&r.length?r.map(function(r,e){if(r=n._getDayNumber(String(r)),i=n._useSundayAlias?n._dayAlias.indexOf(String(r)):n._days.indexOf(String(r)),t=0===e?i:t,e>0)for(;i<t;)i+=n._dayLength;return i}):null},i.prototype.getTrendOrGrowthValue=function(i,n,r,e){if(e=e||this.valueConverter(),r=r||this._indexes2(),i&&e&&r){var s=e.length%this._dayLength||this._dayLength;e=e.slice(0-s),r=r.slice(0-s)}return t.prototype.getTrendOrGrowthValue.call(this,i,n,r,e)},i.prototype.increase=function(t,i){var n=this._getDayNumber(t),r=n===this._SundayAlias?6:this._days.indexOf(n);return r+=i,(this._type===s.DATE_STRING?t.slice(0,2):t[0])+g(r)},i.prototype.add=function(i,n){this._useSundayAlias||this._getDayNumber(n)!==this._SundayAlias||(this._useSundayAlias=!0),t.prototype.add.call(this,i,n)},i.prototype.resultConverter=function(t){var i=g(t,this._useSundayAlias);return i?i=this._type===s.DAY_STRING?"星期"+i:"周"+i:null},i.prototype._getDayNumber=function(t){return t[t.length-1]},i}(e.a);i.a=d},function(t,i,n){"use strict";var r,e=n(5),s=n(3),u=n.n(s),o=n(2),h=n.n(o),a=this&&this.t||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),c=h.a._getMonthByIndex,f=h.a._MonthListAlias,l=h.a._MonthList,v=u.a._isNullOrUndefined,g=function(t){function i(i){var n=t.call(this,i)||this;return n._monthInNumber=!1,n._MonthLen=12,n._indexes=[],n._innerValues=[],n._type=null,n._startIndex=v(i)?-1:i,n}return a(i,t),i.prototype.increase=function(t,i){t=this._getMonthNumber(t);var n=this._isMonthInNumber(t),r=n?f.indexOf(t):l.indexOf(t);return c(r+i,n)+"月"},i.prototype.add=function(i,n){!this._monthInNumber&&this._isMonthInNumber(n)&&(this._monthInNumber=!0),t.prototype.add.call(this,i,n)},i.prototype.valueConverter=function(){var t,i,n=this,r=this._innerValues;return r&&r.length?r.map(function(r,e){if(r=String(r).replace("月",""),i=n._isMonthInNumber(r)?f.indexOf(r):l.indexOf(r),t=0===e?i:t,e>0)for(;i<t;)i+=n._MonthLen;return i}):null},i.prototype.getTrendOrGrowthValue=function(i,n,r,e){if(e=e||this.valueConverter(),r=r||this._indexes2(),i&&e&&r){var s=e.length%this._MonthLen||this._MonthLen;e=e.slice(0-s),r=r.slice(0-s)}return t.prototype.getTrendOrGrowthValue.call(this,i,n,r,e)},i.prototype.resultConverter=function(t){var i;return(i=c(t,this._monthInNumber))?i+"月":null},i.prototype._isMonthInNumber=function(t){return/^\d/.test(t.replace("月",""))},i.prototype._getMonthNumber=function(t){return t.replace("月","")},i}(e.a);i.a=g},function(t,i,n){"use strict";var r,e=n(5),s=n(3),u=n.n(s),o=this&&this.t||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),h=u.a._isNullOrUndefined,a=function(t){function i(i){var n=t.call(this,i)||this;return n._indexes=[],n._innerValues=[],n._type=null,n._prefixReg=/\d+$/,n._startIndex=h(i)?-1:i,n}return o(i,t),i.prototype.valueConverter=function(){var t=this,i=this._innerValues;if(i&&i.length){var n=[];return i.forEach(function(i){var r=t.getPrefixRegMatch(String(i));r&&r[0]&&n.push(Number(r[0]))}),n}return null},i.prototype.increase=function(t,i){var n=this.getPrefixRegMatch(t);return n?t.slice(0,n.index)+(Number(n[0])+i):null},i.prototype.patternMatch=function(t){if(!this._dataCount())return!0;var i=this.getInvalidZeroCnt(String(this._innerValues[0])),n=this.getInvalidZeroCnt(t),r=i!==n&&0!==i&&0!==n;return this.getPrefix(String(this._innerValues[0]))===this.getPrefix(t)&&!r},i.prototype.resultConverter=function(t){t=Math.abs(Number(t)).toString();for(var i=this.getPrefix(String(this._innerValues[0])),n=String(this._innerValues[0]).replace(i,"");t.length<n.length;)t="0"+t;return i+t},i.prototype.getPrefix=function(t){var i=this.getPrefixRegMatch(t);return i?t.slice(0,i.index):""},i.prototype.getInvalidZeroCnt=function(t){for(var i=this.getPrefixRegMatch(t),n=0,r=i&&i[0];r&&"0"===r[n];)n++;return n},i.prototype.getPrefixRegMatch=function(t){return t.match(this._prefixReg)},i}(e.a);i.a=a},function(t,i,n){"use strict";var r,e=n(5),s=n(0),u=n(3),o=n.n(u),h=n(2),a=n.n(h),c=n(4),f=n(6),l=n.n(f),v=this&&this.t||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),g=o.a._isNullOrUndefined,A=o.a._toDouble,d=a.a._trend,w=a.a._DateTimeHelper,p=l.a.Convert,m=function(t){function i(i){var n=t.call(this,i)||this;return n._indexes=[],n._innerValues=[],n._type=s.DATE_STRING,n._startIndex=g(i)?-1:i,n}return v(i,t),i.prototype.increase=function(t,i){return t+i},i.prototype.trend=function(t,i,n,r,e,u,o,h){for(var a,c=[],f=[],l=[],v=[],g=0,A=t[0].length;g<A;g++)t[0][g]=Math.floor(t[0][g]),a=this._toDateTime(t[0][g]),c.push(a.getFullYear()),f.push(a.getMonth()+1),v.push(12*a.getFullYear()+a.getMonth()+1),l.push(a.getDate());var p=Object(s.isAllSame)(c),m=Object(s.isAllSame)(f);if(!(!Object(s.isAllSame)(l)||p&&m)){var b=[],C=l[0],O=i[0].length,y=i[0][O-1],R=(y-i[0][0])/(O-1);if(p&&!m)if(Object(s.isSameStep)(f))for(var F=c[0],D=f[1]-f[0],j=0,S=n[0];j<S.length;j++){(V=((I=S[j])-y)/R*D+f[f.length-1])>12&&(F+=Math.floor(V/12),V%=12),b.push([w._toOADate(new Date(F,V-1,C))])}else b=this._copyFromKnowY(t,i,n);else if(!p&&m)if(Object(s.isSameStep)(c))for(var M=c[1]-c[0],T=0,x=n[0];T<x.length;T++){var _=((I=x[T])-y)/R*M+c[c.length-1];b.push([w._toOADate(new Date(_,f[0]-1,C))])}else b=this._copyFromKnowY(t,i,n);else if(Object(s.isSameStep)(v)){F=c[c.length-1],D=v[1]-v[0];for(var B=0,E=n[0];B<E.length;B++){(V=((I=E[B])-y)/R*D+f[f.length-1])>12&&(F+=Math.floor(V/12),V%=12),b.push([w._toOADate(new Date(F,V-1,C))])}}else if(Object(s.isSameStep)(c)&&Object(s.isSameStep)(f)){D=f[1]-f[0],M=c[1]-c[0];for(var N=0,k=n[0];N<k.length;N++){var I,V;_=((I=k[N])-y)/R*M+c[c.length-1];(V=(I-y)/R*D+f[f.length-1])>12&&(_+=Math.floor(V/12),V%=12),b.push([w._toOADate(new Date(_,V-1,C))])}}else b=this._copyFromKnowY(t,i,n);return b}if(!Object(s.isSameStep)(t[0]))return this._copyFromKnowY(t,i,n);var U=[t,i,n,r,e,u,o,h];return d.apply(null,U)},i.prototype._copyFromKnowY=function(t,i,n){for(var r=[],e=0,s=n[0].length;e<s;e++)r.push([t[0][(n[0][e]-i[0][0])%i[0].length]]);return r},i.prototype._values=function(){for(var t=[],i=this._innerValues,n=i?i.length:0,r=0;r<n;r++)t.push(i[r]);return t},i.prototype._insert=function(t,i,n){var r=n;if(!Object(s.isNumber)(r))throw new Error(Object(c.sR)().Exp_NumberOnly);g(this._type)&&(this._type=Object(s.getValType)(r)),this._indexes.splice(t,0,i),this._innerValues.splice(t,0,A(r))},i.prototype.add=function(t,i){var n=i;g(this._type)&&(this._type=Object(s.getValType)(n)),this._indexes.push(t),this._innerValues.push(A(n))},i.prototype._toActualValue=function(t){return this._toDateTime(t)},i.prototype._toDateTime=function(t){var i=null;if(t instanceof Date)i=t;else if(p)try{i=p._toDateTime(t)}catch(n){Object(s.printException)(n),i=t}return i},i}(e.a);i.a=m},function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.sheetEx=i.sheetEventHandlerExt=void 0;var r=n(4),e=v(n(10)),s=n(11),u=n(12),o=v(n(1)),h=v(n(6)),a=v(n(2)),c=v(n(7)),f=v(n(8)),l=n(0);function v(t){return t&&t.__esModule?t:{default:t}}var g=o.default._Directive_CopyBuffer,A=o.default._Directive_RepaintSelection,d=o.default.GC$,w=l._createRange,p=o.default._supportsCalc,m=o.default.Events,b=a.default._Types._isNullOrUndefined,C=o.default._getFeatureManager,O=o.default.HookNames,y=C("Worksheet"),R=Math.min,F=Math.abs,D=Math.max,j="drag";function S(t){return t.rowViewportIndex}function M(t){return t.colViewportIndex}function T(t){return t.hitTestType}function x(t,i){return t.G(i)}function _(t,i){return t.H(i)}function B(t){return t.colCount}function E(t){return t.rowCount}function N(t,i,n,r,e,s,u,o,h,a,c,f){var l=i?m.DragDropBlock:m.DragDropBlockCompleted,v={sheet:t,sheetName:t._name,fromRow:n,fromCol:r,toRow:e,toCol:s,rowCount:u,colCount:o,copy:h,insert:a,copyOption:c,collectedCells:f},g=i?"dragDropBlock":"dragDropBlockCompleted";return i&&(v.cancel=!1),y.SY(O.Worksheet[g],this,v),t.NC(l,v),v.cancel}function k(t){var i=t.sheet,n=t.fromRow,e=t.fromCol,s=t.rowCount,u=t.colCount,o=t.toRow,h=t.toCol,a=t.isDragInsert,c=t.isDragCopy,f=i.options.dragDropCopyToOptions||16383,l={},v="",g=3,A=!1,d=!1,b=!1;if(i.NC(m.BeforeDragDrop,t),!(v=t.invalidMessage)||0===v.length){var C=i._getActualRange(w(n,e,s,u)),O=i._getActualRange(w(o,h,s,u)),y=!i.isRangeEditable(C),R=!i.isRangeEditable(O);(y||R)&&(A=!0,i.parent.options.showPermissionError&&i.parent.options.showPermissionError({ranges:y?[C]:[O]})),!a||-1!==n&&-1!==e?o===n&&h===e||((i._hasPartSpans(n,e,s,u)||i._hasPartSpans(o,h,s,u))&&(A=!0,v=(0,r.sR)().Exp_ChangeMergedCell),A||p&&(i._hasPartArrayFormulas(n,e,s,u)||i._hasPartArrayFormulas(o,h,s,u))&&(A=!0,g=4,v=(0,r.sR)().Exp_ChangePartOfArray),A||(c||i.isRangeReadable(C)?c||i.isRangeEditable(O)||(i.parent.options.showPermissionError&&i.parent.options.showPermissionError({ranges:[O]}),d=!0):(i.parent.options.forbidCopyCallback&&i.parent.options.forbidCopyCallback(),d=!0)),A||(d||(d=N(i,!0,n,e,o,h,s,u,c,!1,f,l)),d||(b=i._commandManager().execute({cmd:"dragDrop",sheetName:i.name(),fromRow:n,fromColumn:e,toRow:o,toColumn:h,rowCount:s,columnCount:u,copy:c,insert:!1,option:f,collectedCells:l}))&&N(i,!1,n,e,o,h,s,u,c,!1,f,l))):e>=0&&n<0?(c&&(h<=e||h>=e+u)||!c&&(h<e||h>e+u))&&((i._hasPartSpans(-1,e,-1,u)||i._hasPartSpans(-1,h,-1,0))&&(A=!0,v=(0,r.sR)().Exp_ChangeMergedCell),A||(d=N(i,!0,-1,e,-1,h,-1,u,c,!0,f,l))||(b=i._commandManager().execute({cmd:"dragDrop",sheetName:i.name(),fromRow:-1,fromColumn:e,toRow:-1,toColumn:h,rowCount:-1,columnCount:u,copy:c,insert:!0,option:f,collectedCells:l}))&&N(i,!1,-1,e,-1,h,-1,u,c,!0,f,l)):n>=0&&e<0&&(c&&(o<=n||o>=n+s)||!c&&(o<n||o>n+s))&&((i._hasPartSpans(n,-1,s,-1)||i._hasPartSpans(o,-1,0,-1))&&(A=!0,v=(0,r.sR)().Exp_ChangeMergedCell),A||(d=N(i,!0,n,-1,o,-1,s,-1,c,!0,f,l))||(b=i._commandManager().execute({cmd:"dragDrop",sheetName:i.name(),fromRow:n,fromColumn:-1,toRow:o,toColumn:-1,rowCount:s,columnCount:-1,copy:self._isDragCopy,insert:!0,option:f,collectedCells:l}))&&N(i,!1,n,-1,o,-1,s,-1,c,!0,f,l))}b||(self._dragRect={},i.ST()),A&&v&&i._raiseInvalidOperation(g,v)}i.sheetEventHandlerExt={_startDragDropping:function(t){if(!this._isDragDropping){var i=this.PM,n=i._getCanvas();n&&(n.style.cursor="-webkit-grabbing");var r=null;if(1===i._selectionModel.length?r=i._selectionModel.data[0]:i._selectionModel.length<1&&(r=i._getSpanModel().get(i._activeRowIndex,i._activeColIndex)),r){this._isDragDropping=!0;var e,s=i._getActiveSelectedRange(),u=-1===s.row||-1===s.col;this._isDragInsert=u&&!this.shift,this._isWorking=!0,this._dragDropFromRange=r,e=-1===t.rowViewportIndex||-1===t.rowViewportIndex?i.getRangeRect(1,1,r):i.getRangeRect(S(t),M(t),r);var o=this._dragRect;o.x=e.x,o.y=e.y,o.width=e.width-1,o.height=e.height-1,o.row=r.row,o.col=r.col,o.rowCount=E(r),o.colCount=B(r);var h=i._getActualRange(r),a=t.row,c=t.col;a<h.row&&(a=h.row),a>=h.row+E(h)&&(a=h.row+E(h)-1),c<h.col&&(c=h.col),c>=h.col+B(h)&&(c=h.col+B(h)-1),o.hitRow=a,o.hitCol=c,o.rowOffset=a-h.row,o.colOffset=c-h.col,this._startHitInfo={_scrollRowViewportIndex:S(t),_scrollColViewportIndex:M(t),_hitTestType:T(t)},this._startScroll()}}},_continueDragDropping:function(){if(this._startHitInfo&&this._isWorking&&this._isDragDropping&&this._dragDropFromRange){var t=this._mousePosition,i=this._dragRect,n=i.width/2,r=i.x+n,e=i.height/2,s=i.y+e;i.hitTarget={x:t.x,y:t.y};var u=this._getHitRowIndex(),o=this._getHitColumnIndex(),h=!1;(F(r-t.x)>n+5||F(s-t.y)>e+5)&&(h=!0),u>=0&&o>=0&&h&&this._updateDragDropRect(u,o),this._continueScroll()}},_updateDragDropRect:function(t,i){if(this._isDragDropping&&this._dragDropFromRange){var n=this.PM,r=this._dragRect,e=n._getActiveSelectedRange();-1===e.row&&-1!==e.col?(r.row=-1,r.col=D(0,R(_(n)-B(r),i-r.colOffset))):-1!==e.row&&-1===e.col?(r.row=D(0,R(x(n)-E(r),t-r.rowOffset)),r.col=-1):(r.row=r.row<0?-1:D(0,R(x(n)-E(r),t-r.rowOffset)),r.col=r.col<0?-1:D(0,R(_(n)-B(r),i-r.colOffset))),r.hitRow=t,r.hitCol=i;var s=n._getActualRange(r),o=this._oldDragRange;if(!(o&&s.row===o.row&&s.col===o.col&&E(s)===E(o)&&B(s)===B(o)&&s.row>n._getFirstVisualRow()&&s.col>n._getFirstVisualColumn()&&s.row+E(s)-1<n._getLastVisualRow()&&s.col+B(s)-1<n._getLastVisualColumn())){this._actualDragRange=s,(0,u._refreshDragDropIndicator)(n._render),this._oldDragRange=s;var h=n.parent;if(h&&h.options.showDragDropTip){var a=r.x+r.width+5,c=r.y+r.height+5;h._showTooltip(this._getDragDropRectString(s),a,c)}}}},_getDragDropRectString:function(t){if(t&&p){var i,n,r,e,s,u=this.PM,o=u._getActiveSelectedRange(),a=u.getActiveRowIndex(),c=u.getActiveColumnIndex();if(a=a<0?0:a,c=c<0?0:c,1===E(o)&&1===B(o))i=h.default._createCellExpression(null,null,t.row-a,t.col-c,!0,!0);else-1===o.row&&o.col>=0?(n=e=h.default.BAND_INDEX_CONST,r=t.col-c,s=t.col-c+B(o)-1):-1===o.col&&o.row>=0?(r=s=h.default.BAND_INDEX_CONST,n=t.row-a,e=t.row-a+E(o)-1):o.row>=0&&o.col>=0&&(n=t.row-a,e=t.row-a+E(o)-1,r=t.col-c,s=t.col-c+B(o)-1),i=h.default._createRangeExpression(null,null,n,r,e,s,!0,!0,!0,!0);return u._getCalcServiceInternal().unparse(u._getSheetSource(),i,a,c)}},_stopDragDrop:function(){var t=this.PM,i=t._getCanvas();i&&(i.style.cursor="-webkit-grab");var n=null;this._startHitInfo=null,this._stopScroll();var r=t._getActiveSelectedRange();(n=r&&(E(r)>0||B(r)>0)?{r:r.row,c:r.col,rc:E(r),cc:B(r)}:{r:t._activeRowIndex,c:t._activeColIndex,rc:1,cc:1},!0===this._isDragDropping&&!0===this._isWorking)&&k({sheet:t,fromRow:n.r,fromCol:n.c,rowCount:n.rc,colCount:n.cc,toRow:this._dragRect.row,toCol:this._dragRect.col,isDragInsert:this._isDragInsert,isDragCopy:this._isDragCopy});this._isWorking=!1,this._isDragDropping=!1,this._dragDropFromRange=null,this._isDragInsert=!1,this._isDragCopy=!1,this._oldDragRange=null,this._removeTooltip()},_startDragFill:function(t){!0!==this._isDraggingFill&&!0!==this._isWorking&&(this._updateDragFillStartRange(),this._fillStartRange&&(this._currentFillRange=void 0,this._isWorking=!0,this._isDraggingFill=!0,this._isDragAroundIndicator=!0,this._dragStartRowViewport=t,this._dragStartColumnViewport=M(t),this._dragToRowViewport=S(t),this._dragToColumnViewport=M(t),this._updateDragStartRangeViewports(),this._startHitInfo={_scrollRowViewportIndex:S(t),_scrollColViewportIndex:M(t),_hitTestType:T(t)},this._startScroll()))},_updateDragStartRangeViewports:function(){var t=this.PM.frozenRowCount(),i=function(t){return t.frozenColumnCount()}(this.PM),n=this._dragFillStartTopRow();n>=0&&n<t?this._dragFillStartTopRowViewport=0:n>=t&&n<=x(this.PM)&&(this._dragFillStartTopRowViewport=1),this._isDragFillWholeColumns()?this._dragFillStartBottomRowViewport=1:this._dragFillStartBottomRowViewport=this._dragStartRowViewport;var r=this._dragFillStartLeftColumn();r>=0&&r<i?this._dragFillStartLeftColumnViewport=0:r>=i&&r<=_(this.PM)&&(this._dragFillStartLeftColumnViewport=1),this._isDragFillWholeRows()?this._dragFillStartRightColumnViewport=1:this._dragFillStartRightColumnViewport=this._dragStartColumnViewport},_continueDragFill:function(){if(this._startHitInfo&&this._isDraggingFill&&this._isWorking&&this._fillStartRange){if(this._dragToRowViewport=this._getHitRowViewportIndex(),this._dragToColumnViewport=this._getHitColumnViewportIndex(),this._dragToRow=this._getHitRowIndex(),this._dragToColumn=this._getHitColumnIndex(),this._dragToRow>=0&&this._dragToColumn>=0){this._updateCurrentFillSettings(),this._updateCurrentFillRange();var t=this.PM.parent,i=!1;this._getDragFillFrameRange()&&(i=this._validateFillRange(this._fillStartRange,this._currentFillRange,!0)),t&&t.options.showDragFillTip&&i&&this._showDragFillTooltip(),this._refreshDragFill()}this._continueScroll()}},_getDragFillTooltipContent:function(){var t,i=this.PM,n=this._fillStartRange,r=this._currentFillRange,e=i.parent.options.defaultDragFillType,s=this._getAutoFillType(3===e?5:e),u=this._getCurrentFillDirection(),o=this._getDragFillFrameRange();if(1===s){t=0===u||1===u?1:0;var h=new c.default(i)._fillAuto(o,t,!0),l=this._getAvailableRange(u,r,n);if(!i.isRangeReadable(l))return"";var v=i.getActualStyle(l.row,l.col),g=v.cellType||i._getDefaultCellType(),A=v.formatter||v._autoFormatter,d=f.default&&f.default.GeneralFormatter;if(h instanceof Date&&d){var w=v.formatter||v._autoFormatter;w||(w=a.default.CultureManager._getCultureInfo().DateTimeFormat.shortDatePattern+" hh:mm:ss"),A=new d(w,0)}var p=this._startHitInfo,m=3;p&&(m=p._hitTestType);var b={sheet:i,row:l.row,col:l.col,sheetArea:m,quotePrefix:v.quotePrefix};return g.format(h,A,{},b)}return 0===s?(l=this._getAvailableRange(u,r,n),i.isRangeReadable(l)?i.getFormula(l.row,l.col)?null:i.getText(l.row,l.col):""):null},_getAvailableRange:function(t,i,n){var r=n.row,e=n.col,s=E(n),u=B(n),o=w(r,e,1,1);if(3===t){var h=E(i)%s;h=0===h?r+s-1:r+h-1,o.row=h,o.col=e}else 1===t?(h=0===(h=B(i)%u)?e+u-1:e+h-1,o.row=r,o.col=h):0===t?(h=0===(h=B(i)%u)?e:e+u-h,o.row=r,o.col=h):2===t&&(h=0===(h=E(i)%s)?r:r+s-h,o.row=h,o.col=e);return o},_showDragFillTooltip:function(){var t,i,n,r=this.PM;if(4===this._getAutoFillType()||this._isDragFillWholeRows()||this._isDragFillWholeColumns())return this._removeTooltip(),null;var e=this._getCurrentFillDirection(),s=this._getDragFillFrameRange(),u=r._getRangeWholeRect(s);n=this._getDragFillTooltipContent(),3===e?(t=u.x+u.width+3,i=u.y+u.height+3):1===e?(t=u.x+u.width+3,i=u.y+u.height+3):0===e?(t=u.x+3,i=u.y+u.height+3):2===e&&(t=u.x+u.width+3,i=u.y+3),this._showTooltip(n,t,i)},_refreshDragFill:function(){this._clearDragFill(),this._refreshSelectionBorder(),this._paintDragFill(),this._oldDragFillFrameRange=this._getDragFillFrameRange()},_clearDragFill:function(){var t=this.PM;if(this._oldDragFillFrameRange){var i=t._getRangeWholeRect(this._oldDragFillFrameRange);i.x-=2,i.y-=2,i.width+=4,i.height+=4,t.LD([g({rect:i})])}},_refreshSelectionBorder:function(){this.PM.LD([A({range:this._fillStartRange})])},_paintDragFill:function(){var t=this.PM,i=t._render,n=this._getDragFillFrameRange();if(n){var r=i._getCtx(),e=t._getRangeWholeRect(n);r.save(),r.beginPath(),(0,u._paintDragRectangle)(r,e),r.restore()}},_updateCurrentFillRange:function(){this._currentFillRange=this._getCurrentFillRange()},_isDragFillWholeRows:function(){return-1===this._fillStartRange.col&&-1!==this._fillStartRange.row},_isDragFillWholeColumns:function(){return-1===this._fillStartRange.row&&-1!==this._fillStartRange.col},_isDragClear:function(){return 4===this._currentFillDirection||5===this._currentFillDirection},_getCurrentFillRange:function(){var t=-1,i=-1,n=-1,r=-1;switch(this._currentFillDirection){case 0:this._isDragFillWholeColumns()?(t=-1,n=-1):(t=this._dragFillStartTopRow(),n=E(this._fillStartRange)),i=this._dragToColumn,r=this._dragFillStartLeftColumn()-i;break;case 1:this._isDragFillWholeColumns()?(t=-1,n=-1):(t=this._dragFillStartTopRow(),n=E(this._fillStartRange)),i=this._dragFillStartRightColumn()+1,r=this._dragToColumn-i+1;break;case 2:t=this._dragToRow,n=this._dragFillStartTopRow()-t,this._isDragFillWholeRows()?(i=-1,r=-1):(i=this._dragFillStartLeftColumn(),r=B(this._fillStartRange));break;case 3:t=this._dragFillStartBottomRow()+1,n=this._dragToRow-t+1,this._isDragFillWholeRows()?(i=-1,r=-1):(i=this._dragFillStartLeftColumn(),r=B(this._fillStartRange));break;case 5:t=this._dragToRow,n=this._dragFillStartBottomRow()-t+1,this._isDragFillWholeRows()?(i=-1,r=-1):(i=this._dragFillStartLeftColumn(),r=B(this._fillStartRange));break;case 4:this._isDragFillWholeColumns()?(t=-1,n=-1):(t=this._fillStartRange.row,n=E(this._fillStartRange)),i=this._dragToColumn,r=this._dragFillStartRightColumn()-i+1}return w(t,i,D(n,1),D(r,1))},_dragFillStartBottomRowLayout:function(){var t=this._dragFillStartBottomRow();return-1!==t?this.PM._getRowLayout(this._dragFillStartBottomRowViewport).findRow(t):null},_dragFillToViewportBottomRowLayout:function(){return this.PM._getRowLayout(this._dragToRowViewport).findRow(this._dragFillToViewportBottomRow())},_dragFillToViewportBottomRow:function(){return this.PM.getViewportBottomRow(this._dragToRowViewport)},_dragFillStartRightColumnLayout:function(){var t=this._dragFillStartRightColumn();return-1!==t?this.PM.NE(this._dragFillStartRightColumnViewport).findCol(t):null},_dragFillToViewportRightColumnLayout:function(){return this.PM.NE(this._dragToColumnViewport).findCol(this._dragFillToViewportRightColumn())},_dragFillToViewportRightColumn:function(){return this.PM.SW(this._dragToColumnViewport)},_updateCurrentFillSettings:function(){var t,i,n=this._isDragFillWholeRows(),r=this._isDragFillWholeColumns(),e=d(this.PM._getCanvas()).offset(),u=this._mousePosition.e,o=this._mousePosition.x,h=this._mousePosition.y,a=u.pageX-e.left,c=u.pageY-e.top,f=!1;if(n||r)r?this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn()?this._currentFillDirection=4:this._dragToColumn<this._dragFillStartLeftColumn()?this._currentFillDirection=0:this._dragToColumn>this._dragFillStartRightColumn()&&(this._currentFillDirection=1):n&&(this._dragToRow>=this._dragFillStartTopRow()&&this._dragToRow<=this._dragFillStartBottomRow()?this._currentFillDirection=5:this._dragToRow<this._dragFillStartTopRow()?this._currentFillDirection=2:this._dragToRow>this._dragFillStartBottomRow()&&(this._currentFillDirection=3));else if(this._dragToRow>=this._dragFillStartTopRow()&&this._dragToRow<=this._dragFillStartBottomRow())if(this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn())if(t=F(this._dragToColumn-this._dragFillStartRightColumn()),(i=F(this._dragToRow-this._dragFillStartBottomRow()))>t)this._currentFillDirection=5;else if(i<t)this._currentFillDirection=4;else{var l=this._dragFillStartBottomRowLayout();if(l||(l=this._dragFillToViewportBottomRowLayout()),h>l.y+l.height)this._currentFillDirection=3;else{var v=this._dragFillStartRightColumnLayout();v||(v=this._dragFillToViewportRightColumnLayout());var g=v.x+v.width-o,A=l.y+l.height-h;a>=v.x&&a<=v.x+v.width&&c>=l.y&&c<=l.y+l.height?this._currentFillDirection=g>=A?4:5:f=!0}}else this._dragToColumn<this._dragFillStartLeftColumn()?this._currentFillDirection=0:this._dragToColumn>this._dragFillStartRightColumn()&&(this._currentFillDirection=1);else this._dragToRow<this._dragFillStartTopRow()?this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn()?this._currentFillDirection=2:this._dragToColumn<this._dragFillStartLeftColumn()?(t=F(this._dragToColumn-this._dragFillStartLeftColumn()),i=F(this._dragToRow-this._dragFillStartTopRow()),this._currentFillDirection=i>=t?2:0):this._dragToColumn>this._dragFillStartRightColumn()&&(t=F(this._dragToColumn-this._dragFillStartRightColumn()),i=F(this._dragToRow-this._dragFillStartTopRow()),this._currentFillDirection=i>=t?2:1):this._dragToRow>this._dragFillStartBottomRow()&&(this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn()?this._currentFillDirection=3:this._dragToColumn<this._dragFillStartLeftColumn()?(t=F(this._dragToColumn-this._dragFillStartLeftColumn()),i=F(this._dragToRow-this._dragFillStartBottomRow()),this._currentFillDirection=i>=t?3:0):this._dragToColumn>this._dragFillStartRightColumn()&&(t=F(this._dragToColumn-this._dragFillStartRightColumn()),i=F(this._dragToRow-this._dragFillStartBottomRow()),this._currentFillDirection=i>=t?3:1));var w=(0,s.state)(s.STATES.dragFillIndicatorRect);if(w){var p=this._dragFillStartBottomRow(),m=this._dragFillStartRightColumn(),b=p+1,C=m+1,O=this.PM.getRowHeight(p,3),y=this.PM.SS(m,3),D=this.PM.getRowHeight(b,3),j=this.PM.SS(C,3),S=w.x+w.width/2-R(10,y/2),M=w.x+w.width/2+R(10,j/2),T=w.y+w.height/2-R(10,O/2),x=w.y+w.height/2+R(10,D/2),_=!1;n||r?r?_=S<=a&&a<=M:n&&(_=T<=c&&c<=x):_=S<=a&&a<=M&&T<=c&&c<=x,_||f?(this._isDragAroundIndicator=!0,this._currentFillDirection=4):this._isDragAroundIndicator=!1}},_dragFillStartTopRow:function(){return this._fillStartRange?-1===this._fillStartRange.row?0:this._fillStartRange.row:-1},_dragFillStartBottomRow:function(){return this._fillStartRange?-1===this._fillStartRange.row?x(this.PM)-1:this._fillStartRange.row+E(this._fillStartRange)-1:-1},_dragFillStartLeftColumn:function(){return this._fillStartRange?-1===this._fillStartRange.col?0:this._fillStartRange.col:-1},_dragFillStartRightColumn:function(){return this._fillStartRange?-1===this._fillStartRange.col?_(this.PM)-1:this._fillStartRange.col+B(this._fillStartRange)-1:-1},_endDragFill:function(){var t=this.PM;if(this._startHitInfo=null,this._stopScroll(),this._removeTooltip(),this._isDraggingFill&&this._isWorking){this._isDraggingFill=!1,this._isWorking=!1;var i=this._getDragFillFrameRange();if(i&&this._fillStartRange&&this._currentFillRange){var n=!0;if(t.isRangeReadable(this._fillStartRange)||(t.parent.options.forbidCopyCallback&&t.parent.options.forbidCopyCallback(),n=!1),t.isRangeEditable(this._currentFillRange)||(t.parent.options.showPermissionError&&t.parent.options.showPermissionError({ranges:[this._currentFillRange]}),n=!1),!(n=n&&this._currentFillRange&&this._validateFillRange(this._fillStartRange,this._currentFillRange))||this._isDragAroundIndicator)this._resetDragFill(),this._refreshSelection(i);else{var r=this._getAutoFillType();t._commandManager().execute({cmd:"fill",sheetName:t.name(),startRange:t.OK._fillStartRange,fillRange:this._currentFillRange,autoFillType:r,fillDirection:t.OK._getCurrentFillDirection()}),!this._isCancelDragFill&&this._isDragFill()&&t.parent.options.showDragFillSmartTag&&4!==this._currentDragFillType?this._showDragFillSmartTag(this._currentDragFillType):this._refreshSelection(i),this._resetDragFill()}}}else this._resetDragFill()},_showDragFillSmartTag:function(t){var i=this.PM,n=(0,s.state)(s.STATES.dragFillIndicatorRect),r={x:n.x+n.width,y:n.y+n.height,fillType:t};i._fillDialog=new e.default(i.parent._getContainerDiv(),i,r),i._fillDialog._open()},_updateDragFillStartRange:function(){var t=this.PM;1===t._selectionModel.length?this._fillStartRange=t._selectionModel.data[0]:t._activeRowIndex>=0&&t._activeColIndex>=0&&(this._fillStartRange=w(t._activeRowIndex,t._activeColIndex,1,1))},_resetDragFill:function(){this._isWorking=!1,this._isDraggingFill=!1},_refreshSelection:function(t){this.PM._render._repaintSelection(t)},_getAutoFillType:function(t){var i=this.PM;void 0!==t||i.parent.options.defaultDragFillType;if(this._isDragClear())return 4;if(1===E(this._fillStartRange)&&1===B(this._fillStartRange)&&!this._isDragFillWholeColumns()&&!this._isDragFillWholeRows()){var n=this._fillStartRange.row,r=this._fillStartRange.col,e=!!i.getFormula(n,r);return this._isControlPressed||!e&&f.default.isDateFormatter(i.getFormatter(n,r)||i.getAutoFormatter(n,r))?1:0}return this._isControlPressed?0:1},_getDragFillFrameRange:function(){if(!this._fillStartRange)return null;if(this._isDragClear())return this._fillStartRange;if(!this._currentFillRange)return null;var t=0,i=0,n=0,r=0;return this._isVerticalDragFill()?(t=2===this._currentFillDirection?this._currentFillRange.row:this._fillStartRange.row,i=E(this._fillStartRange)+E(this._currentFillRange),n=this._fillStartRange.col,r=B(this._fillStartRange)):(t=this._fillStartRange.row,i=E(this._fillStartRange),n=0===this._currentFillDirection?this._currentFillRange.col:this._fillStartRange.col,r=B(this._fillStartRange)+B(this._currentFillRange)),w(t,n,i,r)},_validateFillRange:function(t,i,n){function e(t,i,n,r,e){for(var s=0;s<n.rowCount;s++){for(var u=0;u<n.colCount;u++){var o=t.getSpan(n.row+s,n.col+u);if(!o||o.rowCount!==i.rowCount||o.colCount!==i.colCount)return!1;r&&(u+=i.colCount)}e&&(s+=i.rowCount)}return!0}var s=this.PM,u=!0,o="";return s._getSpanModel().hasSpans(i.row,i.col,E(i),B(i))&&!function(t,i,n){var r=i.row,s=i.rowCount,u=i.col,o=i.colCount,h=n.row,a=n.rowCount,c=n.col,f=n.colCount,l=r===h&&s===a,v=u===c&&o===f;if(!l&&!v)return!1;var g=t.getSpan(r,u);return!(!g||!e(t,g,i,l,v))&&!t._getSpanModel().hasPartSpans(h,c,a,f)&&e(t,g,n,l,v)}(s,t,i)&&(u=!1,o=(0,r.sR)().Exp_FillRangeContainsMergedCell),u&&(s.isRangeEditable(i)||(u=!1,o=(0,r.sR)().Exp_FillCellsReadOnly)),u||n||s._raiseInvalidOperation(2,o),u},_isDragFill:function(){return this._isIncreaseFill()||this._isDecreaseFill()},_isIncreaseFill:function(){return 3===this._currentFillDirection||1===this._currentFillDirection},_isDecreaseFill:function(){return 0===this._currentFillDirection||2===this._currentFillDirection},_isVerticalDragFill:function(){return 2===this._currentFillDirection||3===this._currentFillDirection||5===this._currentFillDirection},_getCurrentFillDirection:function(){var t=this._currentFillDirection;return t>=0&&t<=3?t:4===t?0:5===t?2:3},_getDragInfo:function(t,i,n){var r=null,e=S(t),u=M(t);if(b(e)||b(u))return r;var o=this.PM,h=o.parent,a=o._getActiveSelectedRange();if(-1===a.row&&-1===a.col)return r;if(-1===e&&-1!==u)return 1===o._selectionModel.length&&-1===a.row&&-1!==a.col&&a.col<=t.col&&a.col+a.colCount-1>=t.col?{action:j,side:"header"}:r;if(-1!==e&&-1===u)return 1===o._selectionModel.length&&-1!==a.row&&-1===a.col&&a.row<=t.row&&a.row+a.rowCount-1>=t.row?{action:j,side:"header"}:r;if(e>=0&&u>=0&&1===o._selectionModel.length){if(this._inGrayArea(e,u,i,n))return r;var c=o.getRangeRect(e,u,a);if(c.x-4<i&&i<c.x+4&&c.y<=n&&n<c.y+c.height&&(r={action:j,side:"left"}),!r){var f=(0,s.state)(s.STATES.dragFillIndicatorRect);f&&f.x<=i&&i<=f.x+f.width&&f.y<=n&&n<=f.y+f.height&&(r={action:j,side:"corner"})}r||c.x+c.width-4<i&&i<c.x+c.width+4&&c.y<=n&&n<c.y+c.height&&(r={action:j,side:"right"}),r||c.y-4<n&&n<c.y+4&&c.x<=i&&i<c.x+c.width&&(r={action:j,side:"top"}),r||c.y+c.height-4<n&&n<c.y+c.height+4&&c.x<=i&&i<c.x+c.width&&(r={action:j,side:"bottom"}),r&&(i<c.x||i>c.x+c.width||n<c.y||n>c.y+c.height)&&(r.outside=!0)}return h&&h.options.allowUserDragDrop||r&&"corner"!==r.side&&(r.side=null),h&&h.options.allowUserDragFill||r&&"corner"===r.side&&(r.side=null),r}},i.sheetEx={dragDrop:k}},function(t,i,n){"use strict";i.a=function(){a.register(f,{priority:1e3,exclusive:!0},{DBClick:{handler:function(){return l.doDoubleClickFill()},canHandle:function(t,i){return l.canTriggerDbClickFill(t,i)}}})};var r=n(0),e=n(1),s=n.n(e),u=n(13),o=n(8),h=n.n(o),a=s.a._SheetEventHandler.eventManager,c=r._createRange,f="DoubleClickAutoFill",l={_fillStartRange:null,_currentFillRange:null,PM:null,doDoubleClickFill:function(){var t=this.PM;if(this._fillStartRange=t._selectionModel.data[0],!this.isFillStartRangeEmpty(this._fillStartRange)){var i=this.getDoubleClickFillFrameRange();if(i){var n=this._fillStartRange.row+this._fillStartRange.rowCount,r=i.rowCount-this._fillStartRange.rowCount;if(this._currentFillRange=c(n,i.col,r,i.colCount),t.isRangeReadable(this._fillStartRange)){var e=this._fillStartRange,s=e.rowCount,o=e.colCount,a=e.row,f=e.col,l=!1;if(1===s&&1===o){var v=t.getFormatter(a,f)||t.getAutoFormatter(a,f);l=!h.a.isDateFormatter(v)||t.getFormula(a,f)}t._commandManager().execute({cmd:"fill",sheetName:t.name(),startRange:this._fillStartRange,fillRange:this._currentFillRange,autoFillType:l?u.a.copyCells:u.a.fillSeries,fillDirection:u.d.down})}else t.parent.options.forbidCopyCallback&&t.parent.options.forbidCopyCallback(void 0,[this._fillStartRange])}}},canTriggerDbClickFill:function(t,i){this.PM=i;var n=i.NK(),r=i.hitTest(t.pageX-n.left,t.pageY-n.top).dragInfo;return!!r&&"corner"===r.side},isRowFilteredOut:function(t){var i=this.PM;return(i._rowFilter?i._rowFilter._getFilterArgs().filteredOutRows:[]).includes(t)},getFillReferenceAreaRowCount:function(t,i){for(var n=this.PM.G(),r=0,e=t;e<n;e++){if(!this.isNotEmptyCell(e,i,"referenceArea")&&!this.isRowFilteredOut(e)){for(;this.isRowFilteredOut(e-1);)e--,r--;break}r++}return r},getWholeRangeRowCount:function(t,i,n,r){for(var e=this.PM,s=e.G(),u=t+n;u<s;u++)for(var o=i;o<i+r;o++)if((this.isNotEmptyCell(u,o,"toBeFilled")||this.isCellMerged(u,o,e)||this.isCellLocked(u,o,e))&&!this.isRowFilteredOut(u))return u-t;return s-t},isValidCellValue:function(t){return!!t||0===t||!1===t},isCellLocked:function(t,i,n){var r=n.getSpan(t,i),e=r?r.row:t,s=r?r.col:i;return!n.isRangeEditable(e,s,1,1)},isNotEmptyCell:function(t,i,n){var r=this.PM.getValue(t,i),e=this.PM.K(t,i);return"toBeFilled"===n?!!(this.isValidCellValue(r)||e&&e.backgroundImage):"fillStart"===n?!!(this.isValidCellValue(r)||e&&(e.backgroundImage||e.backColor)):this.isValidCellValue(r)},isCellMerged:function(t,i,n){var r=n.getSpan(t,i);return!!r&&(r.colCount>1||r.rowCount>1)},isFillStartRangeEmpty:function(t){for(var i=t.row,n=t.rowCount,r=t.col,e=t.colCount,s=i;s<i+n;s++)for(var u=r;u<r+e;u++)if(this.isNotEmptyCell(s,u,"fillStart"))return!1;return!0},getDoubleClickFillFrameRange:function(){var t=this.PM;if(1===t._selectionModel.data.length){var i=t._selectionModel.data[0],n=i.row,r=i.col,e=i.rowCount,s=i.colCount,u=this.getFillReferenceAreaRowCount(n,r-1),o=this.getFillReferenceAreaRowCount(n,r+s),h=this.getWholeRangeRowCount(n,r,e,s);if(u>e)return c(n,r,Math.min(u,h),s);if(o>e)return c(n,r,Math.min(o,h),s)}return null}}},function(t,i,n){"use strict";i.a=function(){a("Worksheet").register("fill",c)};var r,e=n(12),s=n(1),u=n.n(s),o=n(9),h=(n.n(o),u.a.HookNames),a=u.a._getFeatureManager,c=((r={name:"fill"})[h.Worksheet.setHost]=function(t){t&&Object(o.regiterCmds)(this._commandManager())},r[h.Worksheet.dispose]=function(){var t=this._fillDialog;t&&t.close()},r._setMetaKeyStateOnEvent=function(t){var i=t.e,n=this.PM;if(!0===this._isDragDropping){var r=n._getActiveSelectedRange(),s=this._isDragInsert,u=this._isDragCopy;-1===r.row||-1===r.col?this._isDragInsert=!i.shiftKey:this._isDragInsert=!1,this._isDragCopy=i.ctrlKey,s===this._isDragInsert&&u===this._isDragCopy||Object(e._refreshDragDropIndicator)(n._render)}},r._onPaintSelectionBorder=function(t){var i=t.ctx,n=t.rowViewportIndex,r=t.colViewportIndex,s=t.selectRect,u=t.clipRect;Object(e._paintDragFillIndicator)(this,i,n,r,s,u)},r)}])}},2211:function(t,i,n){"use strict";i.a=function(t,i){!function(t,i,n){var r=[],e={};i.forEach(function(t){var i=t[0];!e[i]&&n(t)&&(e[i]=!0,r.push(i))}),s.sheets.cellCommand.autofitRows(t,r)}(t,i,function(i){var n=i[0],r=i[2],s=i[3],u=s.attrs,c=s.value,f=r.attrs,l=r.value;if(!(u.backgroundImageSize===f.backgroundImageSize||e()(u.backgroundImageSize)&&e()(f.backgroundImageSize)))return!0;if(!e()(c)||u.formula){var v=u.wrap,g=u.format,A=f.wrap,d=f.format;if(t._getActualRowHeight(n)<a)return!0;if(v&&"text-no-wrap"!==v||A&&"text-no-wrap"!==A){if(v!==A)return!0;if("text-wrap"===v&&(g!==d&&(g||d)||c!==l))return!0;if("text-linebreak-overflow"===v){var w="string"==typeof l&&l.indexOf("\n")>-1,p="string"==typeof c&&c.indexOf("\n")>-1;return(w||p)&&c!==l}}var m=o(u["font-size"],u.richText),b=o(f["font-size"],f.richText);if((m!==b||e()(l))&&(m&&9!==m||b&&9!==b))return!0;if(u["font-family"]!==f["font-family"]&&(h(u["font-family"])||h(f["font-family"])))return!0}else{if(!e()(l)||f.formula)return t._getActualAutoFitRowHeight(n)>t._getActualRowHeight(n);if(u.link){var m=o(u["font-size"],u.richText),b=o(f["font-size"],f.richText);return m!==b&&!!(m&&9!==m||b&&9!==b)}}return!1})};var r=n(19),e=n.n(r),s=n(3),u=s.sheets.cell,o=u.getCellMaxFontSize,h=u.isSupportedFont;var a=22}});