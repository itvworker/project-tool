webpackJsonpSm_name_([0],{1853:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e,i=n(1),o=n.n(i),u=(n(2395),n(3)),c=n(2049),a=n(2534),f=n(12),s=n.n(f),l=n(2535),d=n(0),v=n.n(d),h=this&&this.t||(e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(t,r)},function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),m=this&&this.r||function(t,r,n,e){return new(n||(n=Promise))(function(i,o){function u(t){try{a(e.next(t))}catch(t){o(t)}}function c(t){try{a(e.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new n(function(r){r(t.value)}).then(u,c)}a((e=e.apply(t,r||[])).next())})},b=this&&this.i||function(t,r){var n,e,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,e&&(i=2&o[0]?e.return:o[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,o[1])).done)return i;switch(e=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,e=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=r.call(t,u)}catch(t){o=[6,t],e=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},p=u.sheets,y=(p.root,p.path),w=p.Plugin,g=(y.setByPath,u.Editor,"Form"),O=function(t){function r(n){var e=n.A,i=n.guid,o=n.apiBaseUrl,u=void 0===o?window.location.origin+"/api":o,f=n.pageBaseUrl,s=void 0===f?window.location.origin+"/form":f,l=n.P,d=t.call(this,{name:g,Constructor:r,config:arguments[0]})||this;return d.getMenuConfig=function(){return Object(a.a)({formController:d.formController,A:d.A})},d.A=e,d.formController=Object(c.b)({A:e,apiBaseUrl:u,pageBaseUrl:s,user:l}),d.formController.setSpreadGuid(i),d.containerId="form-container-"+Math.floor(1e3*Math.random()),d.setupUi(),d.install(),d}return h(r,t),r.prototype.setLocale=function(t){o.a.setLocaleSync(t)},r.prototype.init=function(){},r.prototype.updateConfig=function(t){t.hasOwnProperty("guid")&&this.formController.setSpreadGuid(t.guid)},r.prototype.confirmUnlinkForm=function(){this.formController.ui.confirmUnlinkForm()},r.prototype.unlinkStaleForm=function(){return m(this,void 0,Promise,function(){return b(this,function(t){switch(t.label){case 0:return[4,this.formController.unlinkStaleForms()];case 1:return t.sent(),[2]}})})},r.prototype.destroy=function(){var t=document.getElementById(this.containerId);t&&t.parentElement.removeChild(t)},r.prototype.setupUi=function(){var t=document.body.appendChild(document.createElement("DIV"));t.id=this.containerId,s.a.render(v.a.createElement(l.a,{A:this.A,formController:this.formController}),t)},r}(w);r.default=O},1968:function(t,r,n){var e=n(1988),i=n(1975),o=n(2063),u=n(1982).f;t.exports=function(t){var r=e.Symbol||(e.Symbol={});i(r,t)||u(r,t,{value:o.f(t)})}},1970:function(t,r,n){var e=n(1971),i=n(2053),o=n(1975),u=n(2054),c=n(2060),a=n(2113),f=i("wks"),s=e.Symbol,l=a?s:s&&s.withoutSetter||u;t.exports=function(t){return o(f,t)||(c&&o(s,t)?f[t]=s[t]:f[t]=l("Symbol."+t)),f[t]}},1971:function(t,r,n){(function(r){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof r&&r)||Function("return this")()}).call(r,n(85))},1972:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(2028);r.assert=function(t,r){if(!t)throw new Error(r)},r.assertNever=function(t){throw new TypeError("Unexpected type: "+JSON.stringify(t))},r.softAssertNever=function(t){e.isDebugging}},1974:function(t,r,n){var e=n(1971),i=n(2e3).f,o=n(1984),u=n(2022),c=n(2052),a=n(2109),f=n(2421);t.exports=function(t,r){var n,s,l,d,v,h=t.target,m=t.global,b=t.stat;if(n=m?e:b?e[h]||c(h,{}):(e[h]||{}).prototype)for(s in r){if(d=r[s],l=t.noTargetGet?(v=i(n,s))&&v.value:n[s],!f(m?s:h+(b?".":"#")+s,t.forced)&&void 0!==l){if(typeof d==typeof l)continue;a(d,l)}(t.sham||l&&l.sham)&&o(d,"sham",!0),u(n,s,d,t)}}},1975:function(t,r){var n={}.hasOwnProperty;t.exports=function(t,r){return n.call(t,r)}},1978:function(t,r){t.exports=function(t){try{return!!t()}catch(t){return!0}}},1979:function(t,r,n){var e=n(1978);t.exports=!e(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})},1980:function(t,r){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},1982:function(t,r,n){var e=n(1979),i=n(2105),o=n(1987),u=n(2021),c=Object.defineProperty;r.f=e?c:function(t,r,n){if(o(t),r=u(r,!0),o(n),i)try{return c(t,r,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[r]=n.value),t}},1984:function(t,r,n){var e=n(1979),i=n(1982),o=n(2001);t.exports=e?function(t,r,n){return i.f(t,r,o(1,n))}:function(t,r,n){return t[r]=n,t}},1986:function(t,r,n){var e=n(2051),i=n(1989);t.exports=function(t){return e(i(t))}},1987:function(t,r,n){var e=n(1980);t.exports=function(t){if(!e(t))throw TypeError(String(t)+" is not an object");return t}},1988:function(t,r,n){var e=n(1971);t.exports=e},1989:function(t,r){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on "+t);return t}},1990:function(t,r){t.exports=!1},1991:function(t,r,n){var e=n(2056),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},1992:function(t,r,n){var e=n(1989);t.exports=function(t){return Object(e(t))}},2000:function(t,r,n){var e=n(1979),i=n(2019),o=n(2001),u=n(1986),c=n(2021),a=n(1975),f=n(2105),s=Object.getOwnPropertyDescriptor;r.f=e?s:function(t,r){if(t=u(t),r=c(r,!0),f)try{return s(t,r)}catch(t){}if(a(t,r))return o(!i.f.call(t,r),t[r])}},2001:function(t,r){t.exports=function(t,r){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:r}}},2002:function(t,r,n){var e=n(1982).f,i=n(1975),o=n(1970)("toStringTag");t.exports=function(t,r,n){t&&!i(t=n?t:t.prototype,o)&&e(t,o,{configurable:!0,value:r})}},2003:function(t,r){t.exports={}},2004:function(t,r,n){var e=n(1971),i=n(2065),o=Function.call;t.exports=function(t,r,n){return i(o,e[t].prototype[r],n)}},2005:function(t,r,n){"use strict";var e=this&&this.o||function(){return(e=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)},i=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},o=this&&this.c||function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(i(arguments[r]));return t},u=this&&this.s||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r};Object.defineProperty(r,"__esModule",{value:!0});var c=n(1972),a=u(n(150)),f=u(n(64)),s=n(2006),l=n(2007),d=n(2029),v=n(2069);r.FORM_VERSION=2,r.CREATE_AT="CREATE_AT",r.CREATE_BY="CREATE_BY",r.CHANNEL="CHANNEL",r.DEFAULT_FORM_SHEET_ID="MODOC",r.DEFAULT_COLUMN_COUNT=18,r.DEFAULT_ROW_COUNT=200,r.getModocOperators=function(t){for(var r=[],n=t.getIter();n.hasNext();)r.push(n.next());return r},r.getOperatorSize=function(t){return t.reduce(function(t,r){return t+("number"==typeof r.data?r.data:1)},0)},r.getCellContent=function(t){if(t){var r=t.data,n=t.attributes;if(n&&null!=n.cellValue)return n.cellValue;if(Array.isArray(r&&r.delta)){var e=i(r&&r.delta,1)[0];return e?e.value:void 0}}},r.skipCellOp={action:"retain",attributes:{},data:1},r.createInlineImageCellOp=function(t,n,i){return void 0===i&&(i={}),null==t?r.skipCellOp:{action:"retain",attributes:e({"font-size":9,wrap:null,vertical:"middle",userId:n,authorId:n,cellValue:null,backgroundImage:t.url,backgroundImageLayout:4,backgroundImageSize:JSON.stringify([String(t.width),String(t.height)])},i),data:1}},r.createTextCellOp=function(t,n,i){return void 0===i&&(i={}),null==t||""===t?r.skipCellOp:{action:"retain",attributes:e({"font-size":9,wrap:"text-no-wrap",format:"@",vertical:"middle",userId:n,authorId:n,cellValue:t},i),data:1}},r.questionResponseToCellOp=function(t){var n=t.question,e=t.response,i=t.userId;if(!d.isQuestionTypeCompatible(n.type,e.type))throw new TypeError("question/response incompatible: "+n.type+", "+e.type);var o=v.questionProviders[e.type];if(n.type===l.FormQuestions.ImageType)return r.createInlineImageCellOp(e.response&&e.response.image,i);var u=o.getResponseText(n.question,e.response,{exportSpread:!0});return r.createTextCellOp(u,i)};var h=function(t){var r=t.data,n=t.getAttributes()||{},e=r.rows.ops.map(function(t){var r=t.data;return{attributes:t.getAttributes()||{},data:r}}),i=r.cols.ops.map(function(t){var r=t.data;return{attributes:t.getAttributes()||{},data:r}}),o=r.cells,u={};return o.forEach(function(t){var r=o.get(t),n=r.data,e=r.getAttributes()||{};u[t]={data:n,attributes:e}}),{attributes:n,cells:u,rows:e,columns:i}},m=function(t){var r=t.attributes,n=void 0===r?{}:r,e=t.data.table,i={},o=0;return{attributes:n,rows:e.rows.map(function(t){var r=t,n=r.attributes;return{attributes:void 0===n?{}:n,data:r.data}}),columns:e.cols.map(function(t){var r=t,n=r.attributes,e=void 0===n?{}:n,u=r.data;if("number"==typeof u)o+=u;else{var c=0;u.delta.forEach(function(t){var r=t,n=r.data,e=r.attributes,u=void 0===e?{}:e;if(u&&null!=u.cellValue||"number"!=typeof n){for(var a="number"==typeof n?n:1,f=0;f<a;f++)i[s.toCellName(c+f,o)]={attributes:u,data:n};c+=a}else c+=n}),o+=1}return{attributes:e,data:"number"==typeof u?u:1}}),cells:i}};r.toSpread=function(t,r){switch(r){case"modoc":return function(t){return t.toJSON().map(m)}("string"==typeof t?new a.Delta(t):t);case"richdoc":return function(t){return t.ops.map(h)}("string"==typeof t?f.unpack(t):t);default:return c.assertNever(r)}},r.toTextTable=function(t){for(var n=t.cells,e=Object.keys(n).filter(function(t){return r.getCellContent(n[t])}).map(s.fromCellName),i=Math.max.apply(Math,o([-1],e.map(function(t){return t.row})))+1,u=Math.max.apply(Math,o([-1],e.map(function(t){return t.column})))+1,c=[],a=0;a<i;a++){for(var f=[],l=0;l<u;l++){var d=s.toCellName(a,l);n[d]&&r.getCellContent(n[d])?f.push(r.getCellContent(n[d])):f.push(void 0)}c.push(f)}return c}},2006:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.toColumnName=function(t){if(!(t>=0))throw new Error("Invalid column: "+t);for(var r=t+1,n="";r>0;){var e=(r-1)%26;n=String.fromCharCode(65+e)+n,r=Math.floor((r-e)/26)}return n},r.fromColumnName=function(t){for(var r=0,n=0;n<t.length;n++){var e=t[n].charCodeAt(0);if(!(e>=65&&e<=90))throw new Error("Invalid cell position "+t);r=26*r+e-64}return r},r.toCellName=function(t,r){if(!(t>=0&&r>=0))throw new Error("Invalid cell position "+t+":"+r);for(var n=r+1,e="";n>0;){var i=(n-1)%26;e=String.fromCharCode(65+i)+e,n=Math.floor((n-i)/26)}return e+(t+1)},r.fromCellName=function(t){for(var r=0,n=0,e=0;e<t.length;e++){var i=t[e].charCodeAt(0);if(i>=65&&i<=90)n=26*n+i-64;else{if(!(i>=48&&i<=57))throw new Error("Invalid cell position "+t);r=10*r+i-48}}return{row:r-1,column:n-1}}},2007:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(1).getS18n("lizard-service-form");!function(t){t.TextType="text",t.MultipleTextType="multiple_text",t.SingleChoiceType="single_choice",t.MultipleChoiceType="multiple_choice",t.DropdownListType="dropdown_list",t.RateType="rate",t.DateType="date",t.TimeType="time",t.NumberType="number",t.NameType="name",t.PhoneType="phone",t.EmailType="email",t.AddressType="address",t.ImageType="image",t.List=[t.TextType,t.MultipleTextType,t.SingleChoiceType,t.MultipleChoiceType,t.DropdownListType,t.RateType,t.DateType,t.TimeType,t.NumberType,t.ImageType,t.NameType,t.PhoneType,t.EmailType,t.AddressType]}(r.FormQuestions||(r.FormQuestions={})),function(t){t.ConditionalType="conditional"}(r.FormRules||(r.FormRules={}));r.FORM_KEYS=Object.keys({viewMode:"classic",title:"title",desc:"desc",descAlign:"left",questions:[],rules:[]}),r.FORM_DEFAULT_TITLE=e("未命名表单");var i={formId:1,status:"unpublished",spreadGuid:"123",sheetGuid:"123",fillLimit:"once",deadline:new Date,channels:[]};r.PUBLISH_STATUS_KEYS=Object.keys(i)},2008:function(t,r,n){"use strict";var e=this&&this.s||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r};Object.defineProperty(r,"__esModule",{value:!0});var i=e(n(2498));r.produce=i.produce},2016:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(2401),i=n(2403);!function(t){for(var n in t)r.hasOwnProperty(n)||(r[n]=t[n])}(n(2050)),r.Changeset={Richdoc:i.changeset,Modoc:e.changeset}},2017:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.toColumnName=function(t){if(!(t>=0))throw new Error("Invalid column: "+t);for(var r=t+1,n="";r>0;){var e=(r-1)%26;n=String.fromCharCode(65+e)+n,r=Math.floor((r-e)/26)}return n},r.fromColumnName=function(t){for(var r=0,n=0;n<t.length;n++){var e=t[n].charCodeAt(0);if(!(e>=65&&e<=90))throw new Error("Invalid cell position "+t);r=26*r+e-64}return r},r.toCellName=function(t,r){if(!(t>=0&&r>=0))throw new Error("Invalid cell position "+t+":"+r);for(var n=r+1,e="";n>0;){var i=(n-1)%26;e=String.fromCharCode(65+i)+e,n=Math.floor((n-i)/26)}return e+(t+1)},r.fromCellName=function(t){for(var r=0,n=0,e=0;e<t.length;e++){var i=t[e].charCodeAt(0);if(i>=65&&i<=90)n=26*n+i-64;else{if(!(i>=48&&i<=57))throw new Error("Invalid cell position "+t);r=10*r+i-48}}return{row:r-1,column:n-1}}},2018:function(t,r,n){"use strict";function e(t){for(var n in t)r.hasOwnProperty(n)||(r[n]=t[n])}Object.defineProperty(r,"__esModule",{value:!0}),e(n(2406)),e(n(2099));var i=n(2102);r.ServerTypes=i;var o=n(2101);r.ServerAdapters=o},2019:function(t,r,n){"use strict";var e={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!e.call({1:2},1);r.f=o?function(t){var r=i(this,t);return!!r&&r.enumerable}:e},2020:function(t,r){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},2021:function(t,r,n){var e=n(1980);t.exports=function(t,r){if(!e(t))return t;var n,i;if(r&&"function"==typeof(n=t.toString)&&!e(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!e(i=n.call(t)))return i;if(!r&&"function"==typeof(n=t.toString)&&!e(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},2022:function(t,r,n){var e=n(1971),i=n(1984),o=n(1975),u=n(2052),c=n(2107),a=n(2023),f=a.get,s=a.enforce,l=String(String).split("String");(t.exports=function(t,r,n,c){var a=!!c&&!!c.unsafe,f=!!c&&!!c.enumerable,d=!!c&&!!c.noTargetGet;"function"==typeof n&&("string"!=typeof r||o(n,"name")||i(n,"name",r),s(n).source=l.join("string"==typeof r?r:"")),t!==e?(a?!d&&t[r]&&(f=!0):delete t[r],f?t[r]=n:i(t,r,n)):f?t[r]=n:u(r,n)})(Function.prototype,"toString",function(){return"function"==typeof this&&f(this).source||c(this)})},2023:function(t,r,n){var e,i,o,u=n(2417),c=n(1971),a=n(1980),f=n(1984),s=n(1975),l=n(2024),d=n(2025),v=c.WeakMap;if(u){var h=new v,m=h.get,b=h.has,p=h.set;e=function(t,r){return p.call(h,t,r),r},i=function(t){return m.call(h,t)||{}},o=function(t){return b.call(h,t)}}else{var y=l("state");d[y]=!0,e=function(t,r){return f(t,y,r),r},i=function(t){return s(t,y)?t[y]:{}},o=function(t){return s(t,y)}}t.exports={set:e,get:i,has:o,enforce:function(t){return o(t)?i(t):e(t,{})},getterFor:function(t){return function(r){var n;if(!a(r)||(n=i(r)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},2024:function(t,r,n){var e=n(2053),i=n(2054),o=e("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},2025:function(t,r){t.exports={}},2026:function(t,r,n){var e=n(1988),i=n(1971),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,r){return arguments.length<2?o(e[t])||o(i[t]):e[t]&&e[t][r]||i[t]&&i[t][r]}},2027:function(t,r,n){var e=n(2110),i=n(2057);t.exports=Object.keys||function(t){return e(t,i)}},2028:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.defaultLocale="zh-CN";var e=r.defaultLocale;try{e=document.documentElement.getAttribute("lang")||navigator.language}catch(t){}r.locale={en:"en-US",jp:"ja-JP",cn:"zh-CN"}[e]||e||r.defaultLocale;var i=!1;try{i=/debug=1/.test(window.location.search)||/dev/.test(ENV.NODE_ENV)}catch(t){}r.isDebugging=i},2029:function(t,r,n){"use strict";var e=this&&this.l||function(t,r){return Object.defineProperty?Object.defineProperty(t,"raw",{value:r}):t.raw=r,t},i=this&&this.o||function(){return(i=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)},o=this&&this.r||function(t,r,n,e){return new(n||(n=Promise))(function(i,o){function u(t){try{a(e.next(t))}catch(t){o(t)}}function c(t){try{a(e.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new n(function(r){r(t.value)}).then(u,c)}a((e=e.apply(t,r||[])).next())})},u=this&&this.i||function(t,r){var n,e,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,e&&(i=2&o[0]?e.return:o[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,o[1])).done)return i;switch(e=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,e=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=r.call(t,u)}catch(t){o=[6,t],e=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},c=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},a=this&&this.c||function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(c(arguments[r]));return t},f=this;Object.defineProperty(r,"__esModule",{value:!0});var s=n(1).getS18n("lizard-service-form"),l=n(2124),d=n(1972),v=n(2031),h=n(2501),m=n(2504),b=n(2505),p=n(2008),y=n(2030),w=n(2069),g=n(2521),O=n(2028);r.generateFormGuid=function(){return v.generateId(8)},r.generateQuestionGuid=function(){return v.generateId(8)},r.generateRuleGuid=function(){return v.generateId(8)},r.createForm=function(t){void 0===t&&(t={});var r=t.questions,n=void 0===r?[]:r,e=t.rules,i=void 0===e?[]:e,o=t.title,u=void 0===o?"":o,c=t.desc,a=void 0===c?"":c,f=t.descAlign,s=void 0===f?"center":f,l=t.viewMode;return{questions:n,rules:i,title:u,desc:a,descAlign:s,viewMode:void 0===l?"classic":l}},r.createQuestion=function(t){return{guid:r.generateQuestionGuid(),type:t.type,required:!0,subject:t.initSubject?t.initSubject():"",question:t.initQuestion(),response:t.initResponse()}},r.createRule=function(t){return{guid:r.generateRuleGuid(),type:t.type,rule:t.initRule()}},r.createPublishStatus=function(t){return{formId:t,status:"unpublished",channels:[]}},r.fillForm=function(t,n){return p.produce(t,function(t){t.questions.forEach(function(t){var e=w.questionProviders[t.type],i=n&&n.questions.find(function(n){return r.isQuestionEqual(n,t)});t.response=i&&i.response||e.initResponse(),t.error=void 0})})},r.toText=function(t,r){void 0===r&&(r={separator:"\n"});var n=t.title,e=t.desc,i=t.questions;return a([n,e],i.map(function(t){var n;switch(t.type){case"text":case"multiple_text":case"address":case"image":case"rate":case"time":case"email":case"number":case"date":case"name":case"phone":n="";break;case"multiple_choice":case"single_choice":case"dropdown_list":n=t.question.options.map(function(t){switch(t.type){case"normal":return t.label;case"other":return"";default:return d.softAssertNever(t),""}}).filter(Boolean).join(r.separator);break;default:d.softAssertNever(t),n=JSON.stringify(t.question)}return a([t.subject],""===n?[]:[n]).join(r.separator)})).join(r.separator)};var j=Object.keys(r.createForm()),_=["guid","question","required","subject","type"];r.isQuestionEqual=function(t,r){return _.every(function(n){return b.isDeepEqual(t[n],r[n],{ignoreEmptyKey:!0})})},r.isQuestionTypeCompatible=function(t,r){if(t===r)return!0;switch(t){case"text":case"multiple_text":switch(r){case"text":case"multiple_text":return!0;default:return!1}case"single_choice":case"multiple_choice":case"dropdown_list":switch(r){case"single_choice":case"multiple_choice":case"dropdown_list":return!0;default:return!1}case"address":case"date":case"email":case"number":case"rate":case"time":case"name":case"phone":case"image":return!1;default:return d.assertNever(t)}};var S=["guid","rule","type"];r.isRuleEqual=function(t,r){return S.every(function(n){return b.isDeepEqual(t[n],r[n],{ignoreEmptyKey:!0})})},r.isFormEqual=function(t,n){return!(!t||!n)&&j.every(function(e){switch(e){case"viewMode":case"title":case"desc":case"descAlign":return t[e]===n[e];case"questions":var i=t[e],o=n[e];return i&&o&&i.length===o.length&&i.every(function(t,n){return r.isQuestionEqual(t,o[n])});case"rules":var u=t[e],c=n[e];return u&&c&&u.length===c.length&&u.every(function(t,n){return r.isRuleEqual(t,c[n])});default:return d.assertNever(e)}})},r.validateChannel=function(t){if(!/^[0-9a-zA-Z\-]{1,15}$/.test(t))return s(I||(I=e(['后缀只能由 数字/字母/"-" 组成，长度 1~15'],['后缀只能由 数字/字母/"-" 组成，长度 1~15'])))};var C="/api/newforms";r.setApiBase=function(t){C=t};var E=function(t){if(t&&"string"==typeof t.errmsg)throw t;return t};r.checkForm=function(t,r){return o(f,void 0,void 0,function(){var n;return u(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,m.ajax.request(C+"/forms/"+t+"/valid",{method:"GET",data:r?{userFinger:r}:void 0})];case 1:return n=e.sent(),[2,y.convertCheckResult(n)];case 2:throw e.sent();case 3:return[2]}})})},r.fetchPublishedInfo=function(t){return o(f,void 0,void 0,function(){var r,n,e,i,o,c,a;return u(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),n=E,[4,m.ajax.request(C+"/forms/"+t+"/publications",{method:"GET"})];case 1:return r=n.apply(void 0,[u.sent()]),e=r&&JSON.parse(r.publishedContent),i=y.adaptOldForm(e),o=r&&y.fromServerPublishedStatus(r),c=r&&r.publishedRev,[2,{form:i,publishStatus:o,rev:c}];case 2:if((a=u.sent())&&(20221===a.code||/尚未发布/.test(a.errmsg)))return[2,void 0];throw a;case 3:return[2]}})})},r.fetchPublishedForm=function(t){return o(f,void 0,void 0,function(){var n;return u(this,function(e){switch(e.label){case 0:return[4,r.fetchPublishedInfo(t)];case 1:return n=e.sent(),[2,n&&n.form]}})})},r.fetchDraftForm=function(t,r){return void 0===r&&(r=!1),o(f,void 0,void 0,function(){var n,e,i;return u(this,function(o){switch(o.label){case 0:return[4,m.ajax.request(C+"/forms/"+t+"/content",{method:"GET"})];case 1:return(n=o.sent()).contentUrl?(e=function(t){var r="undefined"==typeof window?"https:":window.location.protocol;return t.replace(/^\w+:/,r)},[4,m.ajax.request(e(n.contentUrl),{method:"GET",extract:function(t){var n=t.data,e=t.headers,i=r?Number(e["x-amz-meta-head"]):Number(e["x-oss-meta-head"]),o=r?Number(e["x-amz-meta-length"]):Number(e["x-oss-meta-length"]);return{head:i,content:n.substr(0,o)}}})]):[2,void 0];case 2:return i=o.sent().content,[2,l.toForm(i)]}})})};var I,T=function(t){return t.split("").reverse().join("")};r.encodeDate=function(t,r){return r.substr(3,2)+T(t.getTime().toString(36))},r.decodeDate=function(t,r){try{var n=t.substr(0,2),e=t.substr(2);if(n!==r.substr(3,2))return;var i=parseInt(T(e),36);if(!i||isNaN(i))return;return new Date(i)}catch(t){return}},r.getPreviewLink=function(t,n,e){void 0===e&&(e=60);var i=new Date;return i.setSeconds(0),i.setMilliseconds(0),t+"/forms/"+n+"/preview?t="+r.encodeDate(new Date(i.getTime()+60*e*1e3),n)},r.parsePreviewLink=function(t){var n=c(/\/forms\/(\w+)\/preview\?t=(\w+)\b/.exec(t)||[],3),e=n[1],i=n[2];if(e&&i){var o=r.decodeDate(i,e);return o&&{formGuid:e,expireAt:o}}},r.fetchPublishStatus=function(t){return o(f,void 0,void 0,function(){var n;return u(this,function(e){switch(e.label){case 0:return[4,r.fetchPublishedInfo(t)];case 1:return[2,(n=e.sent())&&n.publishStatus]}})})},r.publishForm=function(t){return o(f,void 0,void 0,function(){var r,n;return u(this,function(e){switch(e.label){case 0:return r=i({},y.toServerPublishedStatus(t.publishStatus),{publishedContent:JSON.stringify(t.form),publishedRev:t.rev,userId:t.userId}),[4,m.ajax.request(C+"/forms/"+t.guid+"/publications",{method:"POST",data:r})];case 1:return n=e.sent(),[2,E(n)]}})})},r.patchPublishStatus=function(t){return o(f,void 0,void 0,function(){var r,n;return u(this,function(e){switch(e.label){case 0:return r=i({},y.toServerPublishedStatus(t.publishStatus),{userId:t.userId}),n=E,[4,m.ajax.request(C+"/forms/"+t.guid+"/publications",{method:"PATCH",data:r})];case 1:return[2,n.apply(void 0,[e.sent()])]}})})},r.unlinkFormAndSheet=function(t){return o(f,void 0,void 0,function(){var r;return u(this,function(n){switch(n.label){case 0:return[4,m.ajax.request(C+"/forms/"+t.guid+"/unlink",{method:"POST"})];case 1:return r=n.sent(),[2,E(r)]}})})},r.postSubmission=function(t){return o(f,void 0,void 0,function(){var r,n;return u(this,function(e){switch(e.label){case 0:return r=i({formRev:t.rev,userFinger:String(t.userId),userName:t.userName,responseContent:t.form.questions.map(function(t){var r=t.guid,n=t.type,e=t.response;return y.toServerResponse(r,n,e)}).filter(Boolean)},t.channel?{channel:t.channel}:{}),[4,m.ajax.request(C+"/forms/"+t.guid+"/submit",{method:"POST",data:r})];case 1:return n=e.sent(),[2,E(n)]}})})},r.batchPostSubmissions=function(t){return o(f,void 0,void 0,function(){var r,n;return u(this,function(e){switch(e.label){case 0:return r=i({formRev:t.rev,userName:t.userName},t.channel?{channel:t.channel}:{},{batchContent:t.submitActions.map(function(t){switch(t.action){case"add":return{action:"add",responseContent:t.form.questions.map(function(t){var r=t.guid,n=t.type,e=t.response;return y.toServerResponse(r,n,e)}).filter(Boolean)};case"del":return{action:"del",submitId:t.submitId};default:return d.assertNever(t)}})}),[4,m.ajax.request(C+"/forms/"+t.guid+"/batch",{method:"POST",data:r})];case 1:return n=e.sent(),[2,E(n)]}})})},r.fetchSubmissions=function(t){return o(f,void 0,void 0,function(){var r,n,e,i,o;return u(this,function(u){switch(u.label){case 0:return r={formGuid:t.guid,offset:t.offset,limit:t.limit},[4,m.ajax.request(C+"/forms/"+t.guid+"/responses",{method:"GET",data:r})];case 1:return n=u.sent(),e=E(n),i=e.total,o=e.responses,[2,{total:i,submissions:o.map(y.fromServerSubmission)}]}})})},r.fetchAllSubmissions=function(t){return o(f,void 0,void 0,function(){var n;return u(this,function(e){switch(e.label){case 0:return n=1e6,[4,r.fetchSubmissions({guid:t.guid,offset:0,limit:n})];case 1:return[2,e.sent().submissions]}})})},r.fetchStatistics=function(t,r){return o(f,void 0,void 0,function(){return u(this,function(n){switch(n.label){case 0:return[4,m.ajax.request(C+"/forms/"+t+"/questions/"+r+"/assessments",{method:"GET"})];case 1:return[2,n.sent()]}})})},r.deleteSubmissionById=function(t,r){return o(f,void 0,void 0,function(){return u(this,function(n){switch(n.label){case 0:return[4,m.ajax.request(C+"/forms/"+t+"/responses/"+r,{method:"DELETE"})];case 1:return n.sent(),[2]}})})},r.fetchFormViewCount=function(t){return o(f,void 0,void 0,function(){return u(this,function(r){switch(r.label){case 0:return[4,m.ajax.request(C+"/forms/"+t+"/views",{method:"GET"})];case 1:return[2,r.sent()]}})})},r.increaseFormViewCount=function(t){return o(f,void 0,void 0,function(){return u(this,function(r){switch(r.label){case 0:return[4,m.ajax.request(C+"/forms/"+t+"/views",{method:"POST"})];case 1:return r.sent(),[2]}})})},O.isDebugging&&h.logObject({fetchAllSubmissions:r.fetchAllSubmissions,fetchDraftForm:r.fetchDraftForm},"form"),r.fetchDistricts=function(t){return o(f,void 0,void 0,function(){var r;return u(this,function(n){switch(n.label){case 0:return[4,m.ajax.request("/api/district/district",{method:"GET",data:t})];case 1:return(r=n.sent().message)?g.isArray(r)?[2,r.map(function(t){return{code:t.code,name:t.name}})]:[2,r.children&&r.children.map(function(t){return{code:t.code,name:t.name}})]:[2,void 0]}})})}},2030:function(t,r,n){"use strict";var e=this&&this.o||function(){return(e=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0});var i,o=n(2007),u=n(1972),c=n(2500),a=function(t){return null==t||""===t},f=[o.FormQuestions.TextType,o.FormQuestions.SingleChoiceType,o.FormQuestions.MultipleChoiceType,o.FormQuestions.DropdownListType,o.FormQuestions.MultipleTextType,o.FormQuestions.RateType,o.FormQuestions.DateType,o.FormQuestions.TimeType,o.FormQuestions.NumberType,o.FormQuestions.NameType,o.FormQuestions.PhoneType,o.FormQuestions.EmailType,o.FormQuestions.AddressType,o.FormQuestions.ImageType];r.toServerQuestionType=function(t){var r=f.indexOf(t);if(-1===r)throw new Error("unknown type: "+t);return r},r.fromServerQuestionType=function(t){return"number"==typeof t?f[t]:t},r.toServerPublishedStatus=function(t){if(t){var r={};for(var n in t)if(t.hasOwnProperty(n)){var e=n;switch(e){case"deadline":r[e]=t.deadline?t.deadline.toISOString():"0001-01-01T00:00:00Z";break;case"fillLimit":case"sheetGuid":case"spreadGuid":r[e]=t[e]||"";break;case"status":case"formId":r[e]=t[e];break;case"channels":r[e]=JSON.stringify(t[e]||[]);break;default:u.softAssertNever(e)}}return r}},r.fromServerPublishedStatus=function(t){var r,n={};for(var e in t)if(t.hasOwnProperty(e)){var i=e;switch(i){case"deadline":n[i]=t.deadline&&(r=t.deadline,new Date(r).getTime()!==new Date("0001-01-01T00:00:00Z").getTime())?new Date(t.deadline):void 0;break;case"fillLimit":case"sheetGuid":case"spreadGuid":n[i]=a(t[i])?void 0:t[i];break;case"status":if(a(t[i]))throw new TypeError("unexpected `status`: "+t[i]);n[i]=t[i];break;case"formId":if(a(t[i]))throw new TypeError("unexpected `formId`: "+t[i]);n[i]=t[i];break;case"channels":n[i]=a(t[i])?[]:JSON.parse(t[i])}}return n},function(t){t[t.NotFound=20211]="NotFound",t[t.NotPublished=20212]="NotPublished",t[t.Overdue=20213]="Overdue",t[t.StoppedCollecting=20214]="StoppedCollecting",t[t.ReachLimitOnce=20215]="ReachLimitOnce",t[t.ReachLimitOncePerDay=20216]="ReachLimitOncePerDay",t[t.UnknownError=-1]="UnknownError"}(i=r.CheckError||(r.CheckError={})),r.convertCheckResult=function(t){var r=t.code;return{canSubmit:t.isValid,reason:r in i?r:i.UnknownError}},r.fromServerResponse=function(t){var n=t.choice,e=t.choices,i=t.text,o=t.rate,c=t.date,a=t.time,f=t.number,s=t.address,l=t.image,d=r.fromServerQuestionType(t.type);return{type:d,guid:t.guid,response:function(){switch(d){case"text":case"multiple_text":case"name":case"phone":case"email":return i&&null!==i.content?{content:i.content}:void 0;case"dropdown_list":case"single_choice":return null==n?void 0:{choice:n};case"multiple_choice":return null==e?void 0:{choices:e};case"number":return null==f?void 0:{number:f};case"date":return c&&c.date?{date:new Date(c.date)}:void 0;case"time":return a&&a.time?{time:new Date(a.time)}:void 0;case"rate":return o&&o.value?{value:o.value}:void 0;case"address":return null==s?void 0:s;case"image":return null==l?void 0:l;default:return u.assertNever(d)}}()}},r.toServerResponse=function(t,n,e){if(e){var i=r.toServerQuestionType(n);switch(n){case"text":case"multiple_text":case"name":case"phone":case"email":return{type:i,guid:t,text:{content:e.content}};case"dropdown_list":case"single_choice":return{type:i,guid:t,choice:e.choice};case"multiple_choice":return{type:i,guid:t,choices:e.choices};case"rate":return{type:i,guid:t,rate:{value:e.value}};case"date":return{type:i,guid:t,date:{date:e.date}};case"time":return{type:i,guid:t,time:{time:e.time}};case"number":return{type:i,guid:t,number:e.number};case"address":return{type:i,guid:t,address:{province:e.province,city:e.city,district:e.district,detail:e.detail}};case"image":return{type:i,guid:t,image:{image:e.image}};default:return u.assertNever(n)}}},r.fromServerSubmission=function(t){var n="string"==typeof t.content?c.parse(t.content):t.content;return{userId:Number(t.userFinger),userName:t.userName,channel:t.channel,responses:n.map(r.fromServerResponse),createdAt:"string"==typeof t.createdAt?new Date(t.createdAt):t.createdAt,submitId:t.submitId}},r.toServerSubmission=function(t){return{formGuid:t.formGuid,formRev:t.formRev,userFinger:t.userId,userName:t.userName,channel:t.channel,submitId:t.submitId,createdAt:t.createdAt&&new Date(t.createdAt).toISOString(),userId:t.userId,content:t.responses.map(function(t){return r.toServerResponse(t.guid,t.type,t.response)}).filter(Boolean)}},r.adaptOldForm=function(t){return e({},t,{viewMode:t.viewMode||"classic"})}},2031:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";r.generateId=function(t){for(var r="",n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r}},2049:function(t,r,n){"use strict";n.d(r,"a",function(){return e}),n.d(r,"b",function(){return F});var e,i=n(1),o=n.n(i),u=n(2398),c=(n.n(u),n(2018)),a=(n.n(c),n(2412)),f=(n.n(a),n(2069)),s=(n.n(f),n(150)),l=(n.n(s),n(64)),d=(n.n(l),n(3)),v=n(51),h=n.n(v),m=n(784),b=n(2527),p=n(791),y=n(793),w=n(2529),g=n(2132),O=n(2531),j=n(2533),_=this&&this.r||function(t,r,n,e){return new(n||(n=Promise))(function(i,o){function u(t){try{a(e.next(t))}catch(t){o(t)}}function c(t){try{a(e.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new n(function(r){r(t.value)}).then(u,c)}a((e=e.apply(t,r||[])).next())})},S=this&&this.i||function(t,r){var n,e,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,e&&(i=2&o[0]?e.return:o[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,o[1])).done)return i;switch(e=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,e=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=r.call(t,u)}catch(t){o=[6,t],e=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},C=this,E=a.formService.createQuestion,I=d.sheets.alert,T=I.confirm,M=I.showAlert;!function(t){t.FormChanged="FormChanged",t.FormUiChanged="FormUiChanged"}(e||(e={}));var F=function(t){var r,n=t.A,i=t.pageBaseUrl,d=t.apiBaseUrl,v=t.user,I=i?i+"s":"/forms",F=c.createFormService({formApiUrl:d}),k=function(t,r){return _(C,void 0,Promise,function(){var n,e,i,o,u;return S(this,function(c){switch(c.label){case 0:return r!==m.a.V1?[3,2]:[4,F.fetchForm(t)];case 1:return n=c.sent(),[2,{formGuid:t,formVersion:r,data:u=n&&{form:n}}];case 2:return r!==m.a.V2?[3,4]:[4,Promise.all([a.formService.fetchPublishedInfo(t),b.a.fetchFile(t).catch(function(t){return"denied"})])];case 3:return e=c.sent(),i=e[0],o=e[1],u=i&&o&&{form:i.form,publishStatus:i.publishStatus,file:o},[2,{formGuid:t,formVersion:r,data:u}];case 4:throw new Error("unexpected formVersion: "+r)}})})},x=Object(p.b)(k);y.a&&Object(O.a)(x,"form:cache"),x.on(p.a.Cached,function(){P.emit(e.FormChanged)});var N=function(t,r){return x.get(t,r)},G=function(t,r){if(!t)return!1;var n=N(t,r);if(!n||!n.data)return!1;if(n.formVersion===m.a.V1)return Boolean(n.data.form.spreadGuid);if(n.formVersion===m.a.V2){var e=n.data.publishStatus;return Boolean(e.spreadGuid&&"normal"===e.status)}throw new Error("unexpected formVersion: "+r)},A=function(t,r,i){return _(C,void 0,Promise,function(){var o,c,f,d,h;return S(this,function(b){switch(b.label){case 0:return i!==m.a.V1?[3,3]:[4,n.getContent()];case 1:return o=b.sent(),c=u.createChangeForUnlinkForm({spread:o,sheetGuid:t.id,type:-4===n.fileType?"modoc":"richdoc",userId:v.id}),[4,n.applyAndSendChange(c,{disableRecords:!0})];case 2:b.sent(),b.label=3;case 3:return i!==m.a.V2?[3,6]:[4,n.getContent()];case 4:return f=b.sent(),d=Array.isArray(f.ops)?"richdoc":"modoc",h=a.sheetChangeset.createChangeForUnlinkForm({spread:f,fileType:d,formGuid:r,userId:v.id}),[4,n.applyAndSendChange("richdoc"===d?l.unpack(h):new s.Delta(h),{disableRecords:!0})];case 5:b.sent(),b.label=6;case 6:return P.emit(e.FormChanged),[2]}})})},D=function(t,n,e){return _(C,void 0,Promise,function(){var t,i,u;return S(this,function(c){switch(c.label){case 0:return e!==m.a.V1?[3,2]:[4,F.fetchForm(n)];case 1:if(!(t=c.sent())||!t.guid)throw new Error(o()("表单不存在，请检查后再试"));(t.spreadGuid||t.sheetGuid)&&F.unlinkForm(n),c.label=2;case 2:return e!==m.a.V2?[3,5]:[4,a.formService.fetchPublishedInfo(n)];case 3:if(!(i=c.sent()))throw new Error(o()("表单不存在，请检查后再试"));return u=i.publishStatus,r&&u.spreadGuid===r?[4,a.formService.patchPublishStatus({guid:n,publishStatus:{spreadGuid:null,sheetGuid:null},userId:v.id})]:[3,5];case 4:c.sent(),c.label=5;case 5:return[2]}})})},R=function(t,r,n){return _(C,void 0,Promise,function(){return S(this,function(e){switch(e.label){case 0:return[4,A(t,r,n)];case 1:return e.sent(),[4,D(t,r,n)];case 2:return e.sent(),[2]}})})},P=Object.assign(new h.a,{setSpreadGuid:function(t){r=t},canReadForm:function(t,r){if(!t)return!1;var n=N(t,r);if(!n||!n.data)return!1;if(n.formVersion===m.a.V1)return v.id===n.data.form.creatorId;if(n.formVersion===m.a.V2){var e=n.data.file;return Boolean(e&&"object"==typeof e&&e.permissions.readable)}throw new Error("unexpected formVersion: "+r)},isFormPublished:G,getFillPageUrl:function(t,r){if(G(t,r))return(r===m.a.V1?i:I)+"/"+t+"/fill"},createForm:function(t){return _(C,void 0,Promise,function(){var e,i,u,c,f,d;return S(this,function(h){switch(h.label){case 0:e=window.open(),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,function(t){return void 0===t&&(t={}),_(C,void 0,Promise,function(){var e,i,u,c,f,d,h,m,p,y,O,j,_;return S(this,function(S){switch(S.label){case 0:if(!r)throw new Error("spreadGuid is required");return[4,b.a.fetchFile(r)];case 1:return e=S.sent(),[4,b.a.fetchFileAncestors(r)];case 2:if(i=S.sent(),!e)throw new Error("sheetFile is not accessible");return d=function(t,r){if(-1===r.indexOf(t))return t;for(var n=1;-1!==r.indexOf(t+" "+n);)n++;return t+" "+n}("string"==typeof t.title?t.title:o()("未命名表单"),n.spread.sheets.map(function(t){return t.name})),u=Object(g.a)(a.formService.createForm(t),function(t){t.title=d}),h=a.formChangeset.toFormDelta(u).stringify(),[4,b.a.createFile({folder:i.length?i[i.length-1].guid:void 0,name:d,type:"form",content:h})];case 3:return c=S.sent(),f=c.guid,m=Object(w.a)(5),[4,n.getContent()];case 4:return p=S.sent(),y=Array.isArray(p.ops)?"richdoc":"modoc",O=a.sheetChangeset.createChangeForCreateForm({spread:p,fileType:y,formGuid:f,sheetGuid:m,sheetTitle:d,userId:v.id,questions:t&&t.questions||[]}),[4,n.applyAndSendChange("richdoc"===y?l.unpack(O):new s.Delta(O),{disableRecords:!0})];case 5:return S.sent(),j=Object(g.a)(a.formService.createPublishStatus(c.id),function(t){t.spreadGuid=e.guid,t.sheetGuid=m,t.status="unpublished"}),_=1,[4,a.formService.publishForm({guid:c.guid,publishStatus:j,userId:v.id,rev:_,form:u})];case 6:return S.sent(),n.spread.TK(m),[2,{guid:f,name:d}]}})})}(t)];case 2:return i=h.sent(),u=i.guid,c=i.name,(f=n.F.get("HistoryList"))&&f.instance&&f.instance.addHistory({action:"create_form",options:{name:c}}),e&&(e.location.href=I+"/"+u+"/edit"),[2,{guid:u,name:c}];case 3:throw d=h.sent(),e&&e.close(),d;case 4:return[2]}})})},unlinkStaleForms:function(){return _(C,void 0,Promise,function(){var t,e,i,o,u,c,a,f,s,l,d,v=this;return S(this,function(h){switch(h.label){case 0:return r?(t=n.spread.getSheets().filter(function(t){return(t.E.attrs||{}).formGuid}),[4,Promise.all(t.map(function(t){return _(v,void 0,void 0,function(){var r,n,e,i;return S(this,function(o){switch(o.label){case 0:return r=t.E.attrs,n=r.formGuid,e=r.formVersion,[4,k(n,e).catch(function(){})];case 1:return i=o.sent(),[2,{sheet:t,AV:i}]}})})}))]):[2];case 1:if(e=h.sent().filter(function(t){return t.AV}),i=e.filter(function(t){var n=t.AV,e=t.sheet;if(!n.data)return!1;if(r&&e.id){if(n.formVersion===m.a.V1){var i=n.data.form;return!(i.spreadGuid===r&&i.sheetGuid===e.id)}if(n.formVersion===m.a.V2){var o=n.data.publishStatus;return!(o.spreadGuid===r&&o.sheetGuid===e.id)}throw new Error("unexpected formVersion: "+n.formVersion)}return!1}),o=e.filter(function(t){var n=t.AV,e=t.sheet;if(r&&e.id){if(n.formVersion===m.a.V1)return!1;if(n.formVersion===m.a.V2)return void 0===n.data;throw new Error("unexpected formVersion: "+n.formVersion)}return!1}),!i.length)return[3,5];c=0,h.label=2;case 2:return c<i.length?(u=i[c],f=u.sheet,s=u.AV,[4,A(f,s.formGuid,s.formVersion)]):[3,5];case 3:h.sent(),h.label=4;case 4:return c++,[3,2];case 5:if(!o.length)return[3,10];c=0,h.label=6;case 6:return c<o.length?(a=o[c],f=a.sheet,s=a.AV,l=s.formGuid,d=s.formVersion,[4,A(f,l,d)]):[3,10];case 7:return h.sent(),[4,D(f,l,d).catch(function(){})];case 8:h.sent(),h.label=9;case 9:return c++,[3,6];case 10:return[2]}})})},unlink:R,ui:{openOrFocusPage:function(t,r,n){var e="form_"+t+"_"+r,o=(n===m.a.V1?i:I)+"/"+r+"/"+t;window.open(o,e)},confirmUnlinkForm:function(){var t=n.spread.B(),r=t.E.attrs,e=r.formGuid,i=r.formVersion;i===m.a.V1?T({title:o()("确定停用表单吗？"),description:o()("停用后该工作表会变成普通工作表，已创建的表单会失效，将不会再收到关于此表单内容的回复。"),confirmLabel:o()("停用"),confirmFun:function(){return _(C,void 0,void 0,function(){var r,n;return S(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,R(t,e,i)];case 1:return u.sent(),M({title:o()("表单已停用")}),[3,3];case 2:return r=u.sent(),n=r&&r.errmsg||o()("停用表单失败，请稍后再试"),M({title:n,type:"error"}),[3,3];case 3:return[2]}})})},abortLabel:o()("取消")}):i===m.a.V2&&T({title:o()("确定取消关联表单吗"),description:o()("取消关联后该表单的新回复将不再发送到该电子表格，但已有数据不会被删除。"),confirmLabel:o()("取消关联"),confirmFun:function(){return _(C,void 0,void 0,function(){var r,n;return S(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,R(t,e,i)];case 1:return u.sent(),M({title:o()("表单已取消关联")}),[3,3];case 2:return r=u.sent(),n=r&&r.errmsg||o()("取消关联失败，请稍后再试"),M({title:n,type:"error"}),[3,3];case 3:return[2]}})})},abortLabel:o()("取消")})},createFormPopup:{props:void 0,show:function(t){P.ui.createFormPopup.props={A:n,formController:P,sheetGuid:t.sheetGuid,onCreate:function(r){return _(this,void 0,Promise,function(){var e,i,u;return S(this,function(c){switch(c.label){case 0:return e=n.spread.getSheet(t.sheetGuid),i=e?e.name+o()("_表单"):void 0,u=r.questions.map(function(t){var r=E(f.questionProviders.text);return r.subject=t,r}),[4,P.createForm({title:i,questions:u})];case 1:return[2,{guid:c.sent().guid}]}})})},onClose:P.ui.createFormPopup.hide},P.emit(e.FormUiChanged)},hide:function(){P.ui.createFormPopup.props=void 0,P.emit(e.FormUiChanged)}}},events:j.a,track:j.b});return y.a&&Object(O.a)(P,"form"),P}},2050:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(t){t.Table="table",t.Column="column",t.Row="row",t.Cell="cell"}(r.Element||(r.Element={})),function(t){t.Insert="insert",t.Remove="remove",t.Retain="retain"}(r.Action||(r.Action={})),r.isOperator=function(t){return t&&-1!==["insert","remove","retain"].indexOf(t.action)},function(t){t.Richdoc="richdoc",t.Modoc="modoc"}(r.ChangesetType||(r.ChangesetType={}))},2051:function(t,r,n){var e=n(1978),i=n(2020),o="".split;t.exports=e(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==i(t)?o.call(t,""):Object(t)}:Object},2052:function(t,r,n){var e=n(1971),i=n(1984);t.exports=function(t,r){try{i(e,t,r)}catch(n){e[t]=r}return r}},2053:function(t,r,n){var e=n(1990),i=n(2108);(t.exports=function(t,r){return i[t]||(i[t]=void 0!==r?r:{})})("versions",[]).push({version:"3.6.2",mode:e?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},2054:function(t,r){var n=0,e=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+e).toString(36)}},2055:function(t,r,n){var e=n(2110),i=n(2057).concat("length","prototype");r.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},2056:function(t,r){var n=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:n)(t)}},2057:function(t,r){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2058:function(t,r){r.f=Object.getOwnPropertySymbols},2059:function(t,r,n){var e=n(2020);t.exports=Array.isArray||function(t){return"Array"==e(t)}},2060:function(t,r,n){var e=n(1978);t.exports=!!Object.getOwnPropertySymbols&&!e(function(){return!String(Symbol())})},2061:function(t,r,n){var e={};e[n(1970)("toStringTag")]="z",t.exports="[object z]"===String(e)},2062:function(t,r,n){var e,i=n(1987),o=n(2427),u=n(2057),c=n(2025),a=n(2428),f=n(2106),s=n(2024)("IE_PROTO"),l=function(){},d=function(t){return"<script>"+t+"<\/script>"},v=function(){try{e=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,r;v=e?function(t){t.write(d("")),t.close();var r=t.parentWindow.Object;return t=null,r}(e):((r=f("iframe")).style.display="none",a.appendChild(r),r.src=String("javascript:"),(t=r.contentWindow.document).open(),t.write(d("document.F=Object")),t.close(),t.F);for(var n=u.length;n--;)delete v.prototype[u[n]];return v()};c[s]=!0,t.exports=Object.create||function(t,r){var n;return null!==t?(l.prototype=i(t),n=new l,l.prototype=null,n[s]=t):n=v(),void 0===r?n:o(n,r)}},2063:function(t,r,n){var e=n(1970);r.f=e},2064:function(t,r,n){var e=n(2065),i=n(2051),o=n(1992),u=n(1991),c=n(2112),a=[].push,f=function(t){var r=1==t,n=2==t,f=3==t,s=4==t,l=6==t,d=5==t||l;return function(v,h,m,b){for(var p,y,w=o(v),g=i(w),O=e(h,m,3),j=u(g.length),_=0,S=b||c,C=r?S(v,j):n?S(v,0):void 0;j>_;_++)if((d||_ in g)&&(y=O(p=g[_],_,w),t))if(r)C[_]=y;else if(y)switch(t){case 3:return!0;case 5:return p;case 6:return _;case 2:a.call(C,p)}else if(s)return!1;return l?-1:f||s?s:C}};t.exports={forEach:f(0),map:f(1),filter:f(2),some:f(3),every:f(4),find:f(5),findIndex:f(6)}},2065:function(t,r,n){var e=n(2430);t.exports=function(t,r,n){if(e(t),void 0===r)return t;switch(n){case 0:return function(){return t.call(r)};case 1:return function(n){return t.call(r,n)};case 2:return function(n,e){return t.call(r,n,e)};case 3:return function(n,e,i){return t.call(r,n,e,i)}}return function(){return t.apply(r,arguments)}}},2066:function(t,r,n){var e=n(1970),i=n(2062),o=n(1982),u=e("unscopables"),c=Array.prototype;void 0==c[u]&&o.f(c,u,{configurable:!0,value:i(null)}),t.exports=function(t){c[u][t]=!0}},2067:function(t,r,n){var e=n(2474);t.exports=function(t){if(e(t))throw TypeError("The method doesn't accept regular expressions");return t}},2068:function(t,r,n){var e=n(1970)("match");t.exports=function(t){var r=/./;try{"/./"[t](r)}catch(n){try{return r[e]=!1,"/./"[t](r)}catch(t){}}return!1}},2069:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(2507),i=n(2508),o=n(2509),u=n(2510),c=n(2511),a=n(2512),f=n(2513),s=n(2514),l=n(2515),d=n(2516),v=n(2517),h=n(2518),m=n(2519),b=n(2520);r.questionProviders={address:o.address,date:u.date,dropdown_list:l.dropdownList,email:a.email,multiple_choice:d.multipleChoice,multiple_text:i.multipleText,name:c.name,number:v.number,phone:f.phone,rate:s.rate,single_choice:h.singleChoice,text:e.text,time:m.time,image:b.image}},2070:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(1).getS18n("lizard-service-form"),i=n(1972);r.isOptionNormal=function(t){return"normal"===t.type},r.isOptionOther=function(t){return"other"===t.type},r.isOptionMatch=function(t,r){return t===r||!(!t||!r)&&Boolean("normal"===t.type&&"normal"===r.type&&t.value===r.value||"other"===t.type&&"other"===r.type)},r.getChoiceText=function(t,r){if(t){if("other"===t.type)return""===t.value?e("其他"):t.value.trim();if("normal"!==t.type)i.softAssertNever(t);else{var n=r.options.find(function(r){return"normal"===r.type&&r.value===t.value});if(n){if("normal"===n.type)return n.label.trim();throw new Error("unexpected type:"+n.type)}}}},r.getChoiceResponseText=function(t,n){var e=n?"choice"in n?n.choice?[n.choice]:[]:n.choices:[];return 0===e.length?"":t.options.map(function(t){return e.find(function(n){return r.isOptionMatch(n,t)})}).filter(Boolean).map(function(n){return r.getChoiceText(n,t)}).filter(function(t){return null!=t&&""!==t}).join(",")}},2098:function(t,r,n){"use strict";var e=this&&this.o||Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t},i=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},o=this&&this.c||function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(i(arguments[r]));return t};Object.defineProperty(r,"__esModule",{value:!0});var u=n(2016),c=n(2405),a=n(2017),f=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r]};r.createChangeForSubmitForm=function(t){var r=t.spread,n=t.type,i=t.response,s="richdoc"===n?u.Changeset.Richdoc:u.Changeset.Modoc,l="richdoc"===n?u.Changeset.Richdoc.from(r):u.Changeset.Modoc.from(r),d=o(l),v=d.findIndex(function(t){return t.attrs.formGuid===i.guid});if(-1===v)throw new Error("找不到关联的表");var h=d[v];if("number"==typeof h.data)throw new Error("工作表无数据");var m=h.data,b=m.rows,p=m.columns,y=m.cells,w=function(t){if(t)switch(t.type){case c.FormItemType.Text:return t.response;case c.FormItemType.SingleChoice:return t.choice&&t.choice.label;case c.FormItemType.MultipleChoice:return t.choices&&t.choices.map(function(t){return t.label}).join(",");case c.FormItemType.DropdownList:return t.choice&&t.choice.label;default:return function(t){throw new Error("Unexpected object: "+t)}(t)}},g=0,O=p.map(function(t){var r,n,e,o,u,a,f,s,l,d,v=t.attrs.formItemGuid,h=v&&i.items.find(function(t){return t.guid===v}),m=v?v===c.ColumnType.CREATE_AT?{value:(r=i.createAt,n=(new Date).getTimezoneOffset()/-60,e=new Date(r.valueOf()+60*(8-n)*60*1e3),o=e.getFullYear(),u=e.getMonth(),a=e.getDate(),f=e.getHours(),s=e.getMinutes(),l=e.getSeconds(),d=function(t){return t<10?"0"+t:""+t},o+"/"+d(u+1)+"/"+d(a)+" "+d(f)+":"+d(s)+":"+d(l)),guid:c.ColumnType.CREATE_AT,required:!0}:h&&{value:w(h),guid:h.guid,required:h.required}:void 0,b={colIndex:g,colItem:m};return g+=t.data,b}).filter(function(t){return t.colItem});if(f("columnData ",O),!O.some(function(t){return Boolean(t.colItem)}))throw new Error("找不到关联的表单列");for(var j=Object.keys(y).map(function(t){var r=a.fromCellName(t);return{row:r.row,column:r.column,cell:y[t]}}),_=j.filter(function(t){return null!=t.cell.attrs.cellValue}),S=j.filter(function(t){return t.cell.attrs.rowspan}),C=function(t){return S.some(function(r){return t>r.row&&t<=r.row+r.cell.attrs.rowspan-1})},E=O.filter(function(t){return t.colItem&&t.colItem.required}),I=E.find(function(t){return t.colItem.guid===c.ColumnType.CREATE_AT}),T=function(t){var r=_.filter(function(r){return r.row===t});if(I){var n=r.find(function(t){return t.column===I.colIndex});return Boolean(n)}return E.length?E.every(function(t){return r.some(function(r){return r.column===t.colIndex})}):O.some(function(t){return r.some(function(r){return r.column===t.colIndex})})},M=1,F=b.reduce(function(t,r){return t+r.data},0);M<F&&(T(M)||C(M));)M++;f("insertAt ",M);var k=function(){var t={};O.filter(function(t){return t.colItem}).forEach(function(r){var n=a.toCellName(M,r.colIndex),o=r.colItem;t[n]=s.retain(u.Element.Cell,e({vertical:"middle",wrap:"text-no-wrap",format:"@","font-size":9,userID:i.userId,authorId:i.userId,cellValue:o&&o.value},r.colItem.guid===c.ColumnType.CREATE_AT?{format:"YYYY/MM/DD HH:mm:ss"}:{}),1)});var r=[s.retain(u.Element.Row,{},M),s.insert(u.Element.Row,{height:22},1)],n=o(0===v?[]:[s.retain(u.Element.Table,{},v)],[s.retain(u.Element.Table,{id:h.attrs.id},{cells:t,rows:r})]);return s.create(n)}();return f("change ",k),k.content}},2099:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(t){t.Text="text",t.SingleChoice="single_choice",t.MultipleChoice="multiple_choice",t.DropdownList="dropdown_list"}(r.FormItemType||(r.FormItemType={}))},2100:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createLogger=function(t){var r=t.channel,n=t.logger;return function(t,e){return e=e||t.name,function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];n.info.apply(n,["["+r+"]["+e+"] args:"].concat(i));try{var u=t.apply(void 0,i);if(u&&u.then)return u.then(function(t){return n.info("["+r+"]["+e+"] result:",t),t},function(t){throw n.error("["+r+"]["+e+"] error:",t),t})}catch(t){throw n.error("["+r+"]["+e+"] error:",t),t}}}}},2101:function(t,r,n){"use strict";var e=this&&this.o||function(){return(e=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0});var i=n(2018),o=n(2102),u=n(2103);r.toServerFormItem=function(t){return{guid:t.guid,name:t.subject,type:(r=t.type,((n={})[i.FormItemType.Text]=o.ServerFormItemType.Text,n[i.FormItemType.SingleChoice]=o.ServerFormItemType.SingleChoice,n[i.FormItemType.MultipleChoice]=o.ServerFormItemType.MultipleChoice,n[i.FormItemType.DropdownList]=o.ServerFormItemType.DropdownList,n)[r]),isRequired:t.required?1:0,choices:t.type===i.FormItemType.Text?void 0:u.stringify(t.options),allowOther:t.type===i.FormItemType.Text||t.type===i.FormItemType.DropdownList?void 0:t.options.some(function(t){return"other"===t.type})};var r,n};var c=function(t){var r={guid:t.guid,required:1===t.isRequired,subject:t.name};if(t.type===o.ServerFormItemType.Text)return e({type:i.FormItemType.Text},r);if(t.type===o.ServerFormItemType.SingleChoice)return e({type:i.FormItemType.SingleChoice},r,{options:u.parse(t.choices)});if(t.type===o.ServerFormItemType.MultipleChoice)return e({type:i.FormItemType.MultipleChoice},r,{options:u.parse(t.choices)});if(t.type===o.ServerFormItemType.DropdownList)return e({type:i.FormItemType.DropdownList},r,{options:u.parse(t.choices)});throw new Error("unknown item type: "+t.type)};r.toServerForm=function(t){var r=t;return{guid:r.guid,name:r.title,description:"string"==typeof r.desc?r.desc:"",fileGuid:r.spreadGuid,sheetGuid:r.sheetGuid,expiredAt:"boolean"==typeof r.deadline?r.deadline?new Date(r.deadlineDate).getTime():null:void 0}},r.fromServerForm=function(t,r){var n=new Date(new Date((new Date).getTime()+6048e5).setHours(12,0,0,0));return{creatorId:t.creatorId,guid:t.guid,title:t.name||"",desc:"string"==typeof t.description?t.description:"",spreadGuid:t.fileGuid,sheetGuid:t.sheetGuid,deadline:Boolean(t.expiredAt),deadlineDate:t.expiredAt?new Date(t.expiredAt):n,items:r.map(c)}},r.fromServerItemReponse=function(t,r){var n=c(r);if(!n)throw new Error("formItem not found, item guid: "+t.guid);if(n.type===i.FormItemType.Text)return n.response=t.value,n;if(n.type===i.FormItemType.SingleChoice||n.type===i.FormItemType.DropdownList){if("single_choice"!==(e=u.parse(t.value)).type&&"dropdown_list"!==e.type)throw new Error("unexpected response type: "+e.type);return n.choice=e.value.choice,n}if(n.type===i.FormItemType.MultipleChoice){var e;if("multiple_choice"!==(e=u.parse(t.value)).type)throw new Error("unexpected response type: "+e.type);return n.choices=e.value.choices,n}throw new Error("unknown formItem type: "+JSON.stringify(n))},r.toServerItemReponse=function(t,r){var n={guid:t.guid,isRequired:t.required?1:0,importerId:""+r};if(t.type===i.FormItemType.Text)return e({},n,{value:t.response});if(t.type===i.FormItemType.SingleChoice)return e({},n,{value:u.stringify({type:"single_choice",value:{choice:t.choice}})});if(t.type===i.FormItemType.MultipleChoice)return e({},n,{value:u.stringify({type:"multiple_choice",value:{choices:t.choices}})});if(t.type===i.FormItemType.DropdownList)return e({},n,{value:u.stringify({type:"dropdown_list",value:{choice:t.choice}})});throw new Error("unknown item: "+JSON.stringify(t))}},2102:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(t){t[t.Text=0]="Text",t[t.SingleChoice=1]="SingleChoice",t[t.MultipleChoice=2]="MultipleChoice",t[t.DropdownList=3]="DropdownList"}(r.ServerFormItemType||(r.ServerFormItemType={}))},2103:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parse=JSON.parse,r.stringify=JSON.stringify},2104:function(t,r,n){"use strict";var e=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},i=this&&this.c||function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(e(arguments[r]));return t};Object.defineProperty(r,"__esModule",{value:!0});var o=n(2016),u=n(2017),c="CREATE_AT";r.createChangeForUpdateForm=function(t){var r=t.spread,n=t.form,e=t.type,a=t.userId,f="richdoc"===e?o.Changeset.Richdoc:o.Changeset.Modoc,s="richdoc"===e?o.Changeset.Richdoc.from(r):o.Changeset.Modoc.from(r),l=i(s),d=l.findIndex(function(t){return t.attrs.formGuid===n.guid});if(-1===d)throw new Error("找不到关联的表");var v=l[d];if("number"==typeof v.data)throw new Error("工作表无数据");for(var h=v.data,m=(h.rows,h.columns),b=h.cells,p=m.reduce(function(t,r){var n=t[t.length-1];return t.concat({colIndex:n?n.colIndex+n.colOperator.data:0,colOperator:r})},[]),y=p.length-1;y>=0;){if(null!=p[y].colOperator.attrs.formItemGuid)break;y--}var w=-1!==y?p[y].colIndex:-1,g={},O=p.slice(0,y+1).map(function(t){var r=t.colIndex,e=t.colOperator;if(null==e.attrs.formItemGuid)return f.retain(o.Element.Column,{},e.data);if(e.attrs.formItemGuid==c)return f.retain(o.Element.Column,{},e.data);var i=n.items.find(function(t){return t.guid===e.attrs.formItemGuid});if(i){var s=u.toCellName(0,r),l=b[s];return(l&&function(t){var r=t.data,n=t.attrs;if("number"!=typeof r)return n.cellValue}(l))!==i.subject&&(g[s]=f.retain(o.Element.Cell,{userId:a,authorId:a,cellValue:i.subject},1)),f.retain(o.Element.Column,{},e.data)}return f.retain(o.Element.Column,{formItemGuid:null,userId:a,authorId:a},e.data)}),j=n.items.filter(function(t){return!p.find(function(r){return r.colOperator.attrs.formItemGuid===t.guid})}).map(function(t,r){var n=u.toCellName(0,w+1+r);return g[n]=f.retain(o.Element.Cell,{userId:a,color:"#ffffff",background:"#41464b",format:"@",cellValue:null!=t.subject?t.subject:""},1),f.insert(o.Element.Column,{formItemGuid:t.guid},1)}),_=void 0;n.title!==v.attrs.name&&(l.map(function(t){return t.attrs.name}).every(function(t){return t!==n.title})&&(_=n.title));var S=i(0===d?[]:[f.retain(o.Element.Table,{},d)],[f.retain(o.Element.Table,{id:n.sheetGuid,name:_},{cells:g,columns:i(O,j)})]);return f.create(S).content}},2105:function(t,r,n){var e=n(1979),i=n(1978),o=n(2106);t.exports=!e&&!i(function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})},2106:function(t,r,n){var e=n(1971),i=n(1980),o=e.document,u=i(o)&&i(o.createElement);t.exports=function(t){return u?o.createElement(t):{}}},2107:function(t,r,n){var e=n(2108),i=Function.toString;"function"!=typeof e.inspectSource&&(e.inspectSource=function(t){return i.call(t)}),t.exports=e.inspectSource},2108:function(t,r,n){var e=n(1971),i=n(2052),o=e["__core-js_shared__"]||i("__core-js_shared__",{});t.exports=o},2109:function(t,r,n){var e=n(1975),i=n(2418),o=n(2e3),u=n(1982);t.exports=function(t,r){for(var n=i(r),c=u.f,a=o.f,f=0;f<n.length;f++){var s=n[f];e(t,s)||c(t,s,a(r,s))}}},2110:function(t,r,n){var e=n(1975),i=n(1986),o=n(2419).indexOf,u=n(2025);t.exports=function(t,r){var n,c=i(t),a=0,f=[];for(n in c)!e(u,n)&&e(c,n)&&f.push(n);for(;r.length>a;)e(c,n=r[a++])&&(~o(f,n)||f.push(n));return f}},2111:function(t,r,n){"use strict";var e=n(2021),i=n(1982),o=n(2001);t.exports=function(t,r,n){var u=e(r);u in t?i.f(t,u,o(0,n)):t[u]=n}},2112:function(t,r,n){var e=n(1980),i=n(2059),o=n(1970)("species");t.exports=function(t,r){var n;return i(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!i(n.prototype)?e(n)&&null===(n=n[o])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===r?0:r)}},2113:function(t,r,n){var e=n(2060);t.exports=e&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},2114:function(t,r,n){var e,i,o=n(1971),u=n(2423),c=o.process,a=c&&c.versions,f=a&&a.v8;f?i=(e=f.split("."))[0]+e[1]:u&&(!(e=u.match(/Edge\/(\d+)/))||e[1]>=74)&&(e=u.match(/Chrome\/(\d+)/))&&(i=e[1]),t.exports=i&&+i},2115:function(t,r,n){var e=n(2061),i=n(2020),o=n(1970)("toStringTag"),u="Arguments"==i(function(){return arguments}());t.exports=e?i:function(t){var r,n,e;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,r){try{return t[r]}catch(t){}}(r=Object(t),o))?n:u?i(r):"Object"==(e=i(r))&&"function"==typeof r.callee?"Arguments":e}},2116:function(t,r,n){n(1968)("iterator")},2117:function(t,r,n){"use strict";var e=n(2453).charAt,i=n(2023),o=n(2118),u=i.set,c=i.getterFor("String Iterator");o(String,"String",function(t){u(this,{type:"String Iterator",string:String(t),index:0})},function(){var t,r=c(this),n=r.string,i=r.index;return i>=n.length?{value:void 0,done:!0}:(t=e(n,i),r.index+=t.length,{value:t,done:!1})})},2118:function(t,r,n){"use strict";var e=n(1974),i=n(2454),o=n(2120),u=n(2456),c=n(2002),a=n(1984),f=n(2022),s=n(1970),l=n(1990),d=n(2003),v=n(2119),h=v.IteratorPrototype,m=v.BUGGY_SAFARI_ITERATORS,b=s("iterator"),p=function(){return this};t.exports=function(t,r,n,s,v,y,w){i(n,r,s);var g,O,j,_=function(t){if(t===v&&T)return T;if(!m&&t in E)return E[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},S=r+" Iterator",C=!1,E=t.prototype,I=E[b]||E["@@iterator"]||v&&E[v],T=!m&&I||_(v),M="Array"==r&&E.entries||I;if(M&&(g=o(M.call(new t)),h!==Object.prototype&&g.next&&(l||o(g)===h||(u?u(g,h):"function"!=typeof g[b]&&a(g,b,p)),c(g,S,!0,!0),l&&(d[S]=p))),"values"==v&&I&&"values"!==I.name&&(C=!0,T=function(){return I.call(this)}),l&&!w||E[b]===T||a(E,b,T),d[r]=T,v)if(O={values:_("values"),keys:y?T:_("keys"),entries:_("entries")},w)for(j in O)!m&&!C&&j in E||f(E,j,O[j]);else e({target:r,proto:!0,forced:m||C},O);return O}},2119:function(t,r,n){"use strict";var e,i,o,u=n(2120),c=n(1984),a=n(1975),f=n(1970),s=n(1990),l=f("iterator"),d=!1;[].keys&&("next"in(o=[].keys())?(i=u(u(o)))!==Object.prototype&&(e=i):d=!0),void 0==e&&(e={}),s||a(e,l)||c(e,l,function(){return this}),t.exports={IteratorPrototype:e,BUGGY_SAFARI_ITERATORS:d}},2120:function(t,r,n){var e=n(1975),i=n(1992),o=n(2024),u=n(2455),c=o("IE_PROTO"),a=Object.prototype;t.exports=u?Object.getPrototypeOf:function(t){return t=i(t),e(t,c)?t[c]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},2121:function(t,r,n){var e=n(1979),i=n(2027),o=n(1986),u=n(2019).f,c=function(t){return function(r){for(var n,c=o(r),a=i(c),f=a.length,s=0,l=[];f>s;)n=a[s++],e&&!u.call(c,n)||l.push(t?[n,c[n]]:c[n]);return l}};t.exports={entries:c(!0),values:c(!1)}},2122:function(t,r,n){var e=n(1979),i=n(1978),o=n(1975),u=Object.defineProperty,c=function(t){throw t};t.exports=function(t,r){r||(r={});var n=[][t],a=!!o(r,"ACCESSORS")&&r.ACCESSORS,f=o(r,0)?r[0]:c,s=o(r,1)?r[1]:void 0;return!!n&&!i(function(){if(a&&!e)return!0;var t={length:-1},r=function(r){a?u(t,r,{enumerable:!0,get:c}):t[r]=1};r(1),r(2147483646),r(4294967294),n.call(t,f,s)})}},2123:function(t,r,n){"use strict";var e=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},i=this&&this.c||function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(e(arguments[r]));return t},o=this&&this.s||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r};Object.defineProperty(r,"__esModule",{value:!0});var u=n(1).getS18n("lizard-service-form"),c=n(2005),a=o(n(150)),f=o(n(64)),s=n(1972),l=n(1972),d=n(2006),v=n(2128),h=n(2030),m=n(2524);r.createChangeForSubmitForm=function(t){var r=t.fileType,n=t.spread,o=t.form,b=t.formGuid,p=t.submission,y=t.time,w=[].concat(p);switch(r){case"modoc":return function(t){var r=t.spread,n=t.formGuid,o=t.submissions;l.assert(o.length,"submissions is empty"),l.assert(a.Delta.isDelta(r),"spread should be modoc.Delta"),l.assert("string"==typeof n,"formGuid should be string");var f=o.findIndex(function(t){return t.channel}),s=-1!==f?m.ensureChannelColumnModoc(r,n,o[f].userId):void 0;s&&(r=r.compose(s));var d=c.getModocOperators(r),b=d.map(function(t){return t.getAttributes()||{}}).findIndex(function(t){return t.formGuid===n});if(-1===b)throw new Error(u("找不到指定的表单工作表"));var p,y=d[b],w=0===b?void 0:{action:"retain",attributes:{},data:b},g=[{action:"retain",attributes:{},data:1},{action:"insert",attributes:{height:22},data:o.length}],O={action:"retain",attributes:{userId:t.submissions[0].userId,authorId:t.submissions[0].userId},data:{table:{rows:g}}},j=w?[w,O]:[O];p=new a.Delta(j);var _,S,C,E=e(y.getParsedData(),2);E[0];S=E[1].toJSON().map(function(r){var n=r.attributes||{},e="number"==typeof r.data?r.data:1;if(!n.formItemGuid)return{action:"retain",attributes:{},data:e};var u=n.formItemGuid,a=t.form.questions.find(function(t){return t.guid===u}),f=o.reverse().map(function(r){var n=h.fromServerSubmission(r).responses.find(function(t){return t.guid===u});return u===c.CREATE_AT||u===c.CREATE_BY||u===c.CHANNEL||n&&a?u===c.CREATE_AT?c.createTextCellOp(v.stringifyDate(t.time),r.userId):u===c.CREATE_BY?c.createTextCellOp(r.userName||"",r.userId):u===c.CHANNEL?c.createTextCellOp(r.channel||"",r.userId):c.questionResponseToCellOp({question:a,response:n,userId:r.userId}):{action:"retain",attributes:{},data:e}});return{action:"retain",attributes:{},data:{delta:i([{action:"retain",attributes:{},data:1}],f)}}});O={action:"retain",attributes:{userId:o[0].userId,authorId:o[0].userId},data:{table:{cols:S}}};return C=w?[w,O]:[O],_=new a.Delta(C),(s?s.compose(p.compose(_)):p.compose(_)).stringify()}({spread:"string"==typeof n?new a.Delta(n):n,form:o,formGuid:b,submissions:w,time:y});case"richdoc":return function(t){var r=t.spread,n=t.formGuid,e=t.form,i=t.submissions,o=t.time;l.assert(i.length,"submissions is empty"),l.assert(Array.isArray(r&&r.ops),"spread should be richdoc.Delta"),l.assert("string"==typeof n,"formGuid should be string");var a=i.findIndex(function(t){return t.channel}),s=-1!==a?m.ensureChannelColumnRichdoc(r,n,i[a].userId):void 0;s&&(r=r.compose(s));var b=r.ops,p=b.map(function(t){return t.getAttributes()||{}}).findIndex(function(t){return t.formGuid===n});if(-1===p)throw new Error(u("找不到指定的表单工作表"));var y,w,g=b[p],O=0===p?void 0:new f.TableOperator({action:"retain",attributes:{},data:p}),j=new f.Delta([new f.Operator({action:"retain",attributes:{},data:1}),new f.Operator({action:"insert",attributes:{height:22},data:i.length})]),_=new f.TableOperator({action:"retain",attributes:{userId:i[0].userId,authorId:i[0].userId},data:{rows:j}}),S=O?[O,_]:[_];y=new f.Delta(S);var C=g.data,E=C.cols,I=(C.rows,{}),T=0;E.ops.forEach(function(t){var r=t.getAttributes()||{},n=t.data,u="number"==typeof n?n:1;if(r.formItemGuid){var a=r.formItemGuid,s=e.questions.find(function(t){return t.guid===a});i.reverse().forEach(function(t,r){var n=h.fromServerSubmission(t).responses.find(function(t){return t.guid===a});(a===c.CREATE_AT||a===c.CREATE_BY||a===c.CHANNEL||n&&s)&&(I[d.toCellName(1+r,T)]=a===c.CREATE_AT?new f.CellOperator(c.createTextCellOp(v.stringifyDate(o),t.userId)):a===c.CREATE_BY?new f.CellOperator(c.createTextCellOp(t.userName||"",t.userId)):a===c.CHANNEL?new f.CellOperator(c.createTextCellOp(t.channel||"",t.userId)):new f.CellOperator(c.questionResponseToCellOp({question:s,response:n,userId:t.userId})))}),T+=u}else T+=u});S=void 0,_=new f.TableOperator({action:"retain",attributes:{userId:i[0].userId,authorId:i[0].userId},data:{cells:I}});S=O?[O,_]:[_],w=new f.Delta(S);var M=s?s.compose(y.compose(w)):y.compose(w);return f.pack(M)}({spread:"string"==typeof n?f.unpack(n):n,form:o,formGuid:b,submissions:w,time:y});default:return s.assertNever(r)}}},2124:function(t,r,n){"use strict";var e=this&&this.o||function(){return(e=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)},i=this&&this.v||function(t,r){var n={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&r.indexOf(e)<0&&(n[e]=t[e]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(e=Object.getOwnPropertySymbols(t);i<e.length;i++)r.indexOf(e[i])<0&&Object.prototype.propertyIsEnumerable.call(t,e[i])&&(n[e[i]]=t[e[i]])}return n},o=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},u=this&&this.s||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r};Object.defineProperty(r,"__esModule",{value:!0});var c=n(2029),a=n(1972),f=n(2008),s=n(150),l=u(n(150)),d=n(2499),v=n(2030);n(2028).isDebugging&&"undefined"!=typeof window&&(window.modoc=window.modoc||l),r.createQuestionOperator=d.createOperator,r.createRuleOperator=d.createOperator,r.createFormOperator=d.createOperator,r.createFormDelta=function(t){return new s.Delta(t)},r.toQuestionOperator=function(t,n){if("remove"===t)return r.createQuestionOperator(t,{},1);var i=n.guid,o=n.required,u=n.subject,c=n.question,a=n.type;return r.createQuestionOperator(t,{},{object:{guid:i,required:o,subject:u,question:e({type:a},c)}})},r.toRuleOperator=function(t,n){if("remove"===t)return r.createRuleOperator(t,{},1);var i=n.guid,o=n.type,u=n.rule;return r.createRuleOperator(t,{},{object:{guid:i,rule:e({type:o},u)}})},r.toFormOperatorAttributes=function(t){var r={};for(var n in t)if(t.hasOwnProperty(n)){var e=n;switch(e){case"viewMode":case"title":case"desc":case"descAlign":r[e]=t[e];break;case"questions":case"rules":break;default:return a.assertNever(e)}}return r},r.toFormOperator=function(t){var n=t.questions,e=t.rules,o=i(t,["questions","rules"]),u=n?n.map(function(t){return r.toQuestionOperator("insert",t)}):[],c=e?e.map(function(t){return r.toRuleOperator("insert",t)}):[];return r.createFormOperator("insert",r.toFormOperatorAttributes(o),{form:[u,c]})},r.toFormDelta=function(t){var n=r.toFormOperator(t);return r.createFormDelta([n])},r.createEmptyForm=function(t){var n=f.produce(c.createForm(),function(t){});return r.toFormDelta(n).stringify()},r.toFormQuestion=function(t){var r=t.action,n=t.data;if("insert"!==r)throw new Error("should be insert");if("number"==typeof n)throw new Error("should be object");var e=n.object,o=e.guid,u=e.required,c=e.subject,a=e.question;return{guid:o,type:a.type,required:u,subject:c,question:i(a,["type"])}},r.toFormRule=function(t){var r=t.action,n=t.data;if("insert"!==r)throw new Error("should be insert");if("number"==typeof n)throw new Error("should be object");var e=n.object,o=e.guid,u=e.rule;return{guid:o,type:u.type,rule:i(u,["type"])}};r.operatorToForm=function(t){var n=t.action,e=t.attributes,i=void 0===e?{}:e,u=t.data;if("insert"!==n)throw new Error("should be insert");if("number"==typeof u)throw new Error("should be object");var s=o(u.form,2),l=s[0],d=void 0===l?[]:l,h=s[1],m=void 0===h?[]:h,b=d.map(r.toFormQuestion),p=m.map(r.toFormRule),y=f.produce(c.createForm(),function(t){Object.assign(t,function(t){var r={};for(var n in t)if(t.hasOwnProperty(n)){var e=n;switch(e){case"viewMode":case"title":case"desc":case"descAlign":r[e]=null==t[e]?void 0:t[e];break;default:a.softAssertNever(e)}}return r}(i),{questions:b,rules:p})});return v.adaptOldForm(y)},r.toForm=function(t){var n=o("string"==typeof t?new s.Delta(t).toJSON():t.toJSON(),1)[0];return r.operatorToForm(n)},r.compose=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=o(t),e=n[0],i=n.slice(1);if(!e)throw new Error("no deltas to compose");return i.reduce(function(t,r){return t.compose(r)},e)}},2125:function(t,r,n){(function(e){r.formatArgs=function(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;r.splice(1,0,n,"color: inherit");var e=0,i=0;r[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(i=++e)}),r.splice(i,0,n)},r.save=function(t){try{t?r.storage.setItem("debug",t):r.storage.removeItem("debug")}catch(t){}},r.load=function(){var t;try{t=r.storage.getItem("debug")}catch(t){}!t&&void 0!==e&&"env"in e&&(t=Object({NODE_ENV:"production",HOST:"shimo_im",VERSION:"pro[baaa439]",BRANCH:"pro",COMMIT:"baaa439",GC_VERSION:"baaa439",SDK:!1}).DEBUG);return t},r.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.m))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},r.storage=function(){try{return localStorage}catch(t){}}(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],r.log=console.debug||console.log||function(){},t.exports=n(2502)(r),t.exports.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(r,n(103))},2126:function(t,r,n){"use strict";var e=this&&this.o||function(){return(e=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0});var i=function(t){return"function"==typeof(t&&t.then)};function o(t){var r=t.onCalled,n=t.onReturned,e=t.onError,o=t.fnName,u=t.self,c=void 0===u?null:u;return function(t){return function(){for(var u=[],a=0;a<arguments.length;a++)u[a]=arguments[a];r&&r(u,o||t.name);try{var f=t.apply(c,u);return i(f)?f.then(function(r){return n&&n(r,u,o||t.name),r},function(r){throw e&&e(r,u,o||t.name),r}):(n&&n(f,u,o||t.name),f)}catch(r){throw e&&e(r,u,o||t.name),r}}}}r.createDecorator=o,r.decorateObject=function(t,r){for(var n in t){var i=t[n];if("constructor"!==n&&"function"==typeof i){var u=o(e({},r,{self:t,fnName:n}));t[n]=u(i)}}return t}},2127:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=function(t){return("0"+String(t)).slice(-2)};r.formatTime=function(t,r){if(!t)return"";var n=(t=new Date(t)).getFullYear(),i=t.getMonth()+1,o=t.getDate(),u=t.getHours(),c=t.getMinutes(),a=t.getSeconds();return r.replace(/\bYYYY\b/,String(n)).replace(/\bMM\b/,e(i)).replace(/\bDD\b/,e(o)).replace(/\bhh\b/,e(u)).replace(/\bmm\b/,e(c)).replace(/\bss\b/,e(a))}},2128:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=(new Date).getTimezoneOffset()/-60;r.parseDate=function(t,r){void 0===r&&(r=8);var n=new Date(t);return new Date(n.getTime()-60*(r-e)*60*1e3)},r.stringifyDate=function(t,r){void 0===r&&(r=8);var n=new Date(t.getTime()+60*(r-e)*60*1e3),i=n.getFullYear(),o=n.getMonth(),u=n.getDate(),c=n.getHours(),a=n.getMinutes(),f=n.getSeconds(),s=function(t){return t<10?"0"+t:""+t};return i+"/"+s(o+1)+"/"+s(u)+" "+s(c)+":"+s(a)+":"+s(f)}},2129:function(t,r,n){"use strict";var e=this&&this.o||function(){return(e=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)},i=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},o=this&&this.c||function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(i(arguments[r]));return t},u=this&&this.s||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r};Object.defineProperty(r,"__esModule",{value:!0});var c=n(1).getS18n("lizard-service-form"),a=n(2005),f=u(n(150)),s=u(n(64)),l=n(1972),d=n(1972),v=n(2006);r.createChangeForUpdateForm=function(t){var r=t.fileType,n=t.spread,u=t.form,h=t.formGuid,m=t.userId;switch(r){case"modoc":return function(t){var r=t.spread,n=t.formGuid,u=t.form,s=t.userId;d.assert(f.Delta.isDelta(r),"spread should be modoc.Delta"),d.assert("string"==typeof n,"formGuid should be string"),d.assert(u,"form is required"),d.assert(s,"userId should be string");var l=a.getModocOperators(r),v=l.map(function(t){return t.getAttributes()||{}}),h=v.map(function(t){return t.name}),m=v.findIndex(function(t){return t.formGuid===n});if(-1===m)throw new Error(c("找不到指定的表单工作表"));var b,p=l[m],y=0===m?void 0:{action:"retain",attributes:{},data:m},w=i(p.getParsedData(),2),g=(w[0],w[1].toJSON()),O=g.map(function(t){return(t.attributes||{}).formItemGuid}).filter(Boolean),j=-1;g.forEach(function(t,r){t.attributes&&t.attributes.formItemGuid&&(j=r)});var _=g.map(function(r,n){var e=r.attributes||{},i=r.data,o="number"==typeof i?i:1,u={action:"retain",attributes:{},data:o};if(!e.formItemGuid)return u;if(e.formItemGuid===a.CREATE_AT||e.formItemGuid===a.CREATE_BY||e.formItemGuid===a.CHANNEL)return u;var c=e.formItemGuid,f=c&&t.form.questions.find(function(t){return t.guid===c});return f?{action:"retain",attributes:{},data:{delta:[{action:"retain",attributes:{cellValue:f.subject},data:1}]}}:{action:"retain",attributes:{formItemGuid:null},data:o}});_=_.slice(0,j+1);var S,C=u.questions.filter(function(t){return-1===O.indexOf(t.guid)}).map(function(t){return{action:"insert",attributes:{formItemGuid:t.guid},data:{delta:[{action:"retain",attributes:{color:"#ffffff",userId:s,authorId:s,background:"#41464b",format:"@",cellValue:t.subject||c("未命名问题")},data:1}]}}});b=o(_,C);var E={action:"retain",attributes:e({},-1===h.indexOf(u.title)?{name:u.title}:{},{userId:s,authorId:s}),data:{table:{cols:b}}};return S=y?[y,E]:[E],new f.Delta(S).stringify()}({spread:"string"==typeof n?new f.Delta(n):n,form:u,formGuid:h,userId:m});case"richdoc":return function(t){var r=t.spread,n=t.formGuid,i=t.form,u=t.userId;d.assert(Array.isArray(r.ops),"spread should be modoc.Delta"),d.assert("string"==typeof n,"formGuid should be string"),d.assert(i,"form is required"),d.assert(u,"userId should be string");var f=r.ops,l=f.map(function(t){return t.getAttributes()||{}}),h=l.map(function(t){return t.name}),m=l.findIndex(function(t){return t.formGuid===n});if(-1===m)throw new Error(c("找不到指定的表单工作表"));var b,p=f[m],y=0===m?void 0:new s.TableOperator({action:"retain",attributes:{},data:m}),w={},g=p.data,O=g.cells,j=g.cols.ops,_=j.map(function(t){return(t.getAttributes()||{}).formItemGuid}).filter(Boolean),S=-1,C=0,E=j.map(function(r,n){var e=r.getAttributes()||{},i=r.data,o="number"==typeof i?i:1,c=new s.Operator({action:"retain",attributes:{},data:o});if(!e.formItemGuid)return C+=o,c;if(e.formItemGuid===a.CREATE_AT||e.formItemGuid===a.CREATE_BY||e.formItemGuid===a.CHANNEL)return S=Math.max(n,S),C+=o,c;var f=e.formItemGuid,l=f&&t.form.questions.find(function(t){return t.guid===f});if(l){S=Math.max(n,S);var d=v.toCellName(0,C),h=O.get(d);return(h&&a.getCellContent(h))!==l.subject&&(w[d]=new s.CellOperator(a.createTextCellOp(l.subject,u))),C+=o,c}return C+=o,new s.Operator({action:"retain",attributes:{formItemGuid:null},data:o})});E=E.slice(0,S+1);var I,T=i.questions.filter(function(t){return-1===_.indexOf(t.guid)}),M=a.getOperatorSize(E),F=T.map(function(t,r){var n=v.toCellName(0,M+r);return w[n]=new s.CellOperator(a.createTextCellOp(t.subject||c("未命名问题"),u,{color:"#ffffff",background:"#41464b",format:"@"})),new s.Operator({action:"insert",attributes:{formItemGuid:t.guid},data:1})});b=o(E,F);var k=new s.TableOperator({action:"retain",attributes:e({},-1===h.indexOf(i.title)?{name:i.title}:{},{userId:u,authorId:u}),data:{cols:new s.Delta(b),cells:w}});return I=y?[y,k]:[k],s.pack(new s.Delta(I))}({spread:"string"==typeof n?s.unpack(n):n,form:u,formGuid:h,userId:m});default:return l.assertNever(r)}}},2130:function(t,r,n){"use strict";var e=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},i=this&&this.s||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r};Object.defineProperty(r,"__esModule",{value:!0});var o=n(1).getS18n("lizard-service-form"),u=i(n(150)),c=i(n(64)),a=n(1972),f=n(1972);r.createChangeForUnlinkForm=function(t){var r=t.fileType,n=t.spread,i=t.formGuid,s=t.userId;switch(r){case"modoc":return function(t){var r=t.spread,n=t.formGuid,i=t.userId;f.assert(u.Delta.isDelta(r),"spread should be modoc.Delta"),f.assert("string"==typeof n,"formGuid should be string"),f.assert(i,"userId is not provided");for(var c=[],a=r.getIter();a.hasNext();)c.push(a.next());var s=c.map(function(t){return t.getAttributes()||{}}),l=s.findIndex(function(t){return t.formGuid===n});if(-1===l)throw new Error(o("找不到指定的表单工作表"));for(var d=c[l],v=s[l],h=e(d.getParsedData(),2)[1].getIter(),m=[];h.hasNext();)m.push(h.next());var b=m.map(function(t){var r=t.getAttributes(),n=t.data,e="number"==typeof n?n:1;return r.formItemGuid?{action:"retain",attributes:{formItemGuid:null},data:e}:{action:"retain",attributes:{},data:e}}),p=0===l?void 0:{action:"retain",attributes:{},data:l},y={action:"retain",attributes:v.formVersion?{formGuid:null,formVersion:null,userId:i,authorId:i}:{formGuid:null,userId:i,authorId:i},data:{table:{cols:b}}},w=p?[p,y]:[y];return new u.Delta(w).stringify()}({spread:"string"==typeof n?new u.Delta(n):n,formGuid:i,userId:s});case"richdoc":return function(t){var r=t.spread,n=t.formGuid,e=t.userId;f.assert(Array.isArray(r&&r.ops),"spread should be richdoc.Delta"),f.assert("string"==typeof n,"formGuid should be string"),f.assert(e,"userId is not provided");for(var i=[],u=r.getIter();u.hasNext();)i.push(u.next());var a=i.map(function(t){return t.getAttributes()||{}}),s=a.findIndex(function(t){return t.formGuid===n});if(-1===s)throw new Error(o("找不到指定的表单工作表"));for(var l=i[s],d=a[s],v=l.data.cols.getIter(),h=[];v.hasNext();)h.push(v.next());var m=new c.Delta(h.map(function(t){var r=t.getAttributes(),n=t.data,e="number"==typeof n?n:1;return r.formItemGuid?new c.Operator({action:"retain",attributes:{formItemGuid:null},data:e}):new c.Operator({action:"retain",attributes:{},data:e})})),b=0===s?void 0:new c.TableOperator({action:"retain",attributes:{},data:s}),p=new c.TableOperator({action:"retain",attributes:d.formVersion?{formGuid:null,formVersion:null,userId:e,authorId:e}:{formGuid:null,userId:e,authorId:e},data:{cols:m}}),y=new c.Delta(b?[b,p]:[p]);return c.pack(y)}({spread:"string"==typeof n?c.unpack(n):n,formGuid:i,userId:s});default:return a.assertNever(r)}}},2131:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.arrayOf=function(t){if(t<0)throw new Error("size should >= 0");for(var r=[],n=0;n<t;n++)r.push(void 0);return r}},2132:function(t,r,n){"use strict";n.d(r,"a",function(){return i});var e=n(2530),i=function(t,r){var n=Object(e.a)(t);return r(n),n}},2395:function(t,r,n){"use strict";var e=n(1),i=n.n(e),o=n(2396),u=n.n(o),c=n(2397),a=n.n(c);i.a.addLocaleResource("en-US",u.a),i.a.addLocaleResource("ja-JP",a.a),i.a.setLocaleSync({en:"en-US",jp:"ja-JP"}[document.documentElement.lang]||document.documentElement.lang||"zh-CN")},2396:function(t,r){t.exports={"未命名表单":"Unnamed form","确定停用表单吗？":"Are you sure to disable the form?","停用后该工作表会变成普通工作表，已创建的表单会失效，将不会再收到关于此表单内容的回复。":"Once disabled the worksheet would become a normal sheet.The created form would be void.No more feedbacks to the form would be reveived.","停用":"Disable","表单已停用":"Form has been disabled","停用表单失败，请稍后再试":"Form disable failed, Try again later","取消":"Cancel","确定取消关联表单吗":"Are you sure to unlink the form?","取消关联后该表单的新回复将不再发送到该电子表格，但已有数据不会被删除。":"New responses to this form will no longer be sent to the spreadsheet after disassociation, but existing data will not be deleted.","取消关联":"Unlink","表单已取消关联":"Form has been unlinked","取消关联失败，请稍后再试":"Unlink failed, please try again later","表单不存在，请检查后再试":"Form doesn't exist. Check and try again.","_表单":"_form","暂无权限访问该表单，请联系该表单的所有者":"No access to the form, please contact the owner of the form","取消关联表单":"Unlink form","停用表单":"Deactivate form","暂无权限取消关联表单":"No permission to unlink the form","表单":"Form","表格协作者才能创建表单":"Only the collaborator can create form","表单创建失败，请稍后重试":"Form create failed, Try it again later","指定的表单不存在":"The specified form does not exist","表单未发布":"Form not published","表单链接复制成功":"Form link copied successfully","表单链接复制失败":"Copy form link failed","创建表单失败，请稍后再试":"Failed to create form, please try again later","基于表头创建表单":"Create a form based on the header","选择表头内容行":"Select header content line","选择字段":"Select field","确定":"Confirm"}},2397:function(t,r){t.exports={"未命名表单":"無名のフォーム","确定停用表单吗？":"本当にフォームを無効にしますか？","停用后该工作表会变成普通工作表，已创建的表单会失效，将不会再收到关于此表单内容的回复。":"無効にするとワークシートは通常のワークシートになります。作成されたフォームは無効になり、このフォームに対する返信を受け取ることはなくなります。","停用":"無効にする","表单已停用":"フォームが無効化されました。","停用表单失败，请稍后再试":"フォームの無効化に失敗しました。しばらくしてからもう一度お試しください。","取消":"キャンセル","确定取消关联表单吗":"フォームのリンクを解除しますか？","取消关联后该表单的新回复将不再发送到该电子表格，但已有数据不会被删除。":"リンクを解除すると、このフォームへの新しい回答はに送信されなくなりますが、既存のデータは削除されません。","取消关联":"リンク解除","表单已取消关联":"フォームのリンクが解除されました。","取消关联失败，请稍后再试":"リンクの解除に失敗しました。しばらくしてからもう一度お試しください。","表单不存在，请检查后再试":"フォームが存在しません。 確認してやり直してください。","_表单":"フォーム","暂无权限访问该表单，请联系该表单的所有者":"フォームにアクセスできません。オーナーに連絡してください。","取消关联表单":"フォームのリンクを解除","停用表单":"フォームを無効にする。","暂无权限取消关联表单":"フォームのリンクを解除する権限がありません。","表单":"フォーム","表格协作者才能创建表单":"フォーム共同編集者はフォームを作成できます。","表单创建失败，请稍后重试":"フォーム作成に失敗しました。しばらくしてからもう一度お試しください。","指定的表单不存在":"指定されたフォームは存在しません。","表单未发布":"フォームが公開されていません。","表单链接复制成功":"フォームリンクをコピーしました。","表单链接复制失败":"フォームリンクのコピーに失敗しました。","创建表单失败，请稍后再试":"フォームを作成できませんでした。しばらくしてからもう一度お試しください。","基于表头创建表单":"ヘッダーからフォームを作成します","选择表头内容行":"ヘッダー行を選択","选择字段":"フィールドを選択","确定":"確定"}},2398:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(2399);r.formEntryToChangeset=e.formEntryToChangeset;var i=n(2098);r.createChangeForSubmitForm=i.createChangeForSubmitForm;var o=n(2410);r.createChangeForCreateForm=o.createChangeForCreateForm;var u=n(2104);r.createChangeForUpdateForm=u.createChangeForUpdateForm;var c=n(2411);r.createChangeForUnlinkForm=c.createChangeForUnlinkForm},2399:function(t,r,n){"use strict";var e=this&&this.o||Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t},i=this&&this.s||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r};Object.defineProperty(r,"__esModule",{value:!0});var o=i(n(2400)),u=n(2098),c=n(2018),a=n(2104),f=i(n(64)),s=i(n(150));r.formEntryToChangeset=function(t){var r=t.content,n=t.formEntry,i=t.userId,l=t.fileType,d=void 0===l?"richdoc":l;if(null==n.action)return o.genSheetFormChangeset({content:r,userId:i,formEntry:n});var v="richdoc"===d?f.unpack.bind(f):function(t){return new s.Delta(t)},h="richdoc"===d?f.pack.bind(f):function(t){return t.stringify()};if("submit_entry"===n.action){var m=n.payload,b=m.form,p=m.items,y=m.responses,w=m.userId;return h(u.createChangeForSubmitForm({spread:v(r),type:d,response:{guid:b.guid,items:p.map(function(t,r){var n=y[r];if(!n||n.guid!==t.guid)throw new Error("cannot find matching response for item["+r+"]: "+JSON.stringify(t));return c.ServerAdapters.fromServerItemReponse(e({},n,{importerId:""+w}),t)}),userId:w,createAt:new Date}}))}if("update_form"===n.action){var g=n.payload,O=(b=g.form,p=g.items,g.userId);return h(a.createChangeForUpdateForm({spread:v(r),type:d,form:c.ServerAdapters.fromServerForm(b,p),userId:O}))}throw new Error("unexpected formEntry: "+JSON.stringify(n))}},2400:function(t,r,n){"use strict";var e=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},i=this&&this.c||function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(e(arguments[r]));return t},o=this&&this.s||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r};Object.defineProperty(r,"__esModule",{value:!0});var u=o(n(64)),c={ALPHABET:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",getColumnLabel:function(t){if(t>676)throw new Error("column index exceeds 26^2, not supported");var r=Math.floor(t/26),n=t%26;return""+(r?c.ALPHABET[r-1]:"")+c.ALPHABET[n]},parseColumnLabel:function(t){var r=e(t.split("").map(function(t){return c.ALPHABET.indexOf(t)}),2),n=r[0],i=r[1];return null==i?n:26*(n+1)+i},getCellName:function(t,r){return""+c.getColumnLabel(r)+(t+1)},parseCellName:function(t){return{column:c.parseColumnLabel(t.match(/^[a-zA-Z]+/)[0]),row:Number(t.match(/\d+$/)[0])-1}}},a=function(){var t=function(t,r,n,e){return void 0===e?new u[r+"Operator"]({action:t,data:n}):new u[r+"Operator"]({action:t,attributes:n,data:e})},r=function(t){return new u.Delta(t)};return Object.assign(r,{retain:t.bind(null,"retain"),insert:t.bind(null,"insert"),delete:t.bind(null,"delete")}),r}();r.genSheetFormChangeset=function(t){var r=t.content,n=t.formEntry,e=t.userId;r=u.unpack(r);var o=n.formGuid,f=n.formItems,s=r.ops.find(function(t){return(t.getAttributes()||{}).formGuid===o}),l=r.ops.findIndex(function(t){return(t.getAttributes()||{}).formGuid===o});if(!s)throw new Error("找不到关联的表");var d=function(){var t={};f.forEach(function(r){return t[r.guid]=r});for(var r=s.data.cols.length,n=i(new Array(r)),e=0,o=0;o<s.data.cols.ops.length;o++){var u=s.data.cols.ops[o],c=(u.getAttributes()||{}).formItemGuid;c&&t[c]&&(n[e]=t[c]),e+=u.data}return n}();if(!d.some(Boolean))throw new Error("找不到关联的表单列");var v,h,m=function(){var t=d.map(function(t,r){return t&&t.isRequired?r:null}).filter(function(t){return null!=t});0===t.length&&(t=[0]);for(var r=s.data.rows.length,n=function(r){return t.every(function(t){var n=c.getCellName(r,t);if(s.data.cells.get(n)){var e=s.data.cells.get(n).data.ops[0];return e&&"insert"===e.action}return!1})},e=s.data.cells.keys().map(function(t){return{row:c.parseCellName(t).row,column:c.parseCellName(t).column,cell:s.data.cells.get(t)}}).filter(function(t){var r=t.cell.getAttributes()||{},n=r.rowspan,e=r.colspan;return n||e}),i=function(t){return e.some(function(r){var n=r.row,e=(r.cell.getAttributes()||{}).rowspan;return n<t&&t<=n+e-1})},o=0;o<r&&(0===o||n(o)||i(o));)o++;return o}(),b=(v=a,h=d.map(function(t,r){return{row:m,col:r,item:t}}).reduce(function(t,r){var n=r.row,i=r.col,o=r.item;return t[c.getCellName(n,i)]=v.retain("Cell",{vertical:"middle",wrap:"text-no-wrap",format:"@","font-size":9,userID:e},o?v([v.insert("Text",{userID:e},o.value)]):1),t},{}),v([0!==l&&v.retain("Table",l),v.retain("Table",{id:(s.getAttributes()||{}).id},{cells:h,rows:v([0!==m&&v.retain("",m),v.insert("",{height:22},1)].filter(Boolean))})].filter(Boolean)));return u.pack(b)}},2401:function(t,r,n){"use strict";var e=this&&this.o||Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t},i=this&&this.i||function(t,r){var n,e,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,e&&(i=2&o[0]?e.return:o[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,o[1])).done)return i;switch(e=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,e=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=r.call(t,u)}catch(t){o=[6,t],e=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},o=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},u=this&&this.c||function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(o(arguments[r]));return t},c=this&&this.s||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r};Object.defineProperty(r,"__esModule",{value:!0});var a=c(n(150)),f=n(2017),s=n(2050),l=n(2402),d=function(t){var r=t.action,n=(t.element,t.attrs),e=t.data;return"number"==typeof e?{action:r,data:e,attributes:n}:{action:r,data:1,attributes:n}},v=function(t){var r=t.action,n=(t.element,t.attrs);return{action:r,data:t.data,attributes:n}},h=function(t){var n=t.action,e=(t.element,t.attrs),i=t.data;return"number"==typeof i?{action:n,attributes:e,data:i}:{action:n,attributes:e,data:{table:{rows:i.rows&&i.rows.map(v),cols:function(t,n,e){t||(t=[]),n||(n=[]),e||(e={});var i={};Object.keys(e).forEach(function(t){var r=f.fromCellName(t),n=r.row,o=r.column;i[o]||(i[o]={}),i[o][n]=e[t]});var o=[];Object.keys(i).map(function(t){return+t}).sort(function(t,r){return t-r}).forEach(function(t){var n=-1,e=[];Object.keys(i[t]).map(function(t){return+t}).sort(function(t,r){return t-r}).forEach(function(o){var u=i[t][o],c=o-n-1;n=o,c?e.push(r.changeset.retain(s.Element.Cell,{},c),u):e.push(u)}),o.push({column:t,operator:p(e).map(d)})});for(var c,a=0,l=function(t,r){return o.filter(function(n){return n.column>=t&&n.column<=r})},v=function(t,r,n){var e=[],i=r,o=t?t.action:s.Action.Retain,u=t&&t.attrs||{},c=t?t.data:1/0;if(n.forEach(function(t){var r=t.column,n=t.operator,c=r-i;c>0&&e.push({action:o,data:c,attributes:u}),e.push({action:o,data:{delta:n},attributes:u}),i=r+1}),Number.isFinite(c)){var a=c-(i-r);a>0&&e.push({action:o,data:a,attributes:u})}return e},h=-1,m=-1,b=[];;){var y=t[a++],w=l(h=m+1,m=h+(y?"number"==typeof(c=y).data?c.data:1:1/0)-1);if(!y&&0===w.length)break;var g=v(y,h,w);b.push.apply(b,u(g))}return b}(i.columns,i.rows,i.cells)}}}},m=function(t){var n=t.data,e=t.action,i=t.attributes||{};return r.changeset[e](s.Element.Row,i,n)},b=function(t){var n=t.data,e=t.action,i=t.attributes||{};return r.changeset[e](s.Element.Column,i,"number"==typeof n?n:1)},p=function(t){for(var r=function(t,r){var n=Object.keys(t),e=Object.keys(r);return n.length===e.length&&[].concat(n,e).every(function(n){return t[n]===r[n]})},n=[],e=0,i=void 0;e<t.length;){var o=t[e],u=t[e],c=u.action,a=u.data,f=u.attrs,s=(u.element,i&&c===i.action&&"number"==typeof a&&r(i.attrs,f)),l="number"==typeof a;i&&s?i.data+=a:(i&&(n.push(i),i=void 0),l?i=Object.assign({},o):n.push(o)),e++}return i&&(n.push(i),i=void 0),n},y=function(t){var n,i,u=t.toJSON(),c=u.action,a=u.attributes,l=void 0===a?{}:a,d=u.data;if("number"==typeof d)return(n={},n[s.Action.Insert]=r.changeset.insert,n[s.Action.Retain]=r.changeset.retain,n[s.Action.Remove]=r.changeset.remove,n)[c](s.Element.Table,l,d);var v=d.table.rows&&d.table.rows.map(m),h=d.table.cols&&d.table.cols.map(b),y={},w=0;(d.table.cols||[]).forEach(function(t){var n=t.action,i=t.data;if("insert"===n||"retain"===n)if("number"==typeof i)w+=i;else{var u=0;i.delta.forEach(function(n){var i=n.action,c=n.data,a=n.attributes;if("insert"===i||"retain"===i){a&&null!=a.cellValue||"number"!=typeof c?(n.action=t.action,y[f.toCellName(u,w)]=function(t){var n,i=t.data,u=t.action,c=t.attributes||{};if("number"!=typeof i&&Array.isArray(i&&i.delta)){var a=o(i.delta,2),f=a[0],l=a[1];l?n=l.data:f.action===s.Action.Remove?n=null:"string"==typeof f.data&&(n=f.data)}else"cellValue"in c&&(n=c.cellValue);return"number"==typeof i?r.changeset[u](s.Element.Cell,c,i):r.changeset[u](s.Element.Cell,e({},c,{cellValue:n}),1)}(n),u+=1):u+=c}else{if("remove"!==i)throw new Error("unknown action: "+i);u+=c}}),w+=1}else{if("remove"!==n)throw new Error("unknown action: "+n);w+=i}});var g=h&&p(h);return(i={},i[s.Action.Insert]=r.changeset.insert,i[s.Action.Retain]=r.changeset.retain,i[s.Action.Remove]=r.changeset.remove,i)[c](s.Element.Table,l,{rows:v,columns:g,cells:y})};function w(){var t,r;return i(this,function(n){switch(n.label){case 0:t=this.content.getIter(),n.label=1;case 1:return t.hasNext()?(r=t.next(),[4,y(r)]):[3,3];case 2:return n.sent(),[3,1];case 3:return[2]}})}r.changeset={from:function(t){var r;return(r={type:s.ChangesetType.Modoc,content:t})[Symbol.iterator]=w,r},create:function(t){return r.changeset.from(new a.Delta(t.map(h)))},insert:function(t,r,n){return{action:s.Action.Insert,element:t,attrs:l.prune(r),data:n}},retain:function(t,r,n){return{action:s.Action.Retain,element:t,attrs:l.prune(r),data:n}},remove:function(t,r,n){return{action:s.Action.Remove,element:t,attrs:l.prune(r),data:n}},compose:function(t){return r.changeset.from(t.map(function(t){return t.content}).reduce(function(t,r){return t.compose(r)},new a.Delta([])))},transform:function(t,n){return r.changeset.from(t.content.transform(n.content))},invert:function(t,n){return r.changeset.from(t.content.invert(n.content))},serialize:function(t){return t.content.stringify()},deserialize:function(t){var n=new a.Delta(t);return r.changeset.from(n)}}},2402:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.prune=function(t){if(!t)return t;var r={};for(var n in t)t.hasOwnProperty(n)&&void 0!==t[n]&&(r[n]=t[n]);return r}},2403:function(t,r,n){"use strict";var e=this&&this.o||Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t},i=this&&this.i||function(t,r){var n,e,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,e&&(i=2&o[0]?e.return:o[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,o[1])).done)return i;switch(e=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,e=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=r.call(t,u)}catch(t){o=[6,t],e=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},o=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},u=this&&this.s||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r};Object.defineProperty(r,"__esModule",{value:!0});var c=u(n(64)),a=n(2404),f=n(2050),s=function(t){var r=t.action,n=(t.element,t.attrs),e=t.data;return"number"==typeof e?new c.CellOperator({action:r,data:e,attributes:n}):new c.CellOperator({action:r,data:1,attributes:n})},l=function(t){var r=t.action,n=(t.element,t.attrs),e=t.data;return new c.Operator({action:r,data:e,attributes:n})},d=function(t){var r=t.action,n=(t.element,t.attrs),e=t.data;return new c.Operator({action:r,data:e,attributes:n})};r.toRichdocTable=function(t){var r=t.action,n=(t.element,t.attrs),e=t.data,i="object"!=typeof e?e:{cells:"object"!=typeof e.cells?e.cells:a.mapObject(e.cells,s),rows:Array.isArray(e.rows)?new c.Delta(e.rows.map(d)):e.rows,cols:Array.isArray(e.columns)?new c.Delta(e.columns.map(l)):e.columns};return new c.TableOperator({action:r,data:i,attributes:n})};var v=function(t){var n=t.data,e=t.action,i=t.getAttributes()||{};return r.changeset[e](f.Element.Row,i,n)},h=function(t){var n=t.data,e=t.action,i=t.getAttributes()||{};return r.changeset[e](f.Element.Column,i,n)},m=function(t){var n,i,u,c=t.data,a=t.action,s=t.getAttributes()||{},l="object"!=typeof c?c:{rows:c.rows&&c.rows.ops.map(v),columns:c.cols&&c.cols.ops.map(h),cells:c.cells&&(i=c.cells,u={},i.forEach(function(t){u[t]=function(t){var n,i=t.data,u=t.action,c=t.getAttributes()||{};if("number"!=typeof i&&Array.isArray(i&&i.ops)&&i.ops.length){var a=o(i.ops,2),s=a[0],l=a[1];l?n=l.data:s.action===f.Action.Remove?n=null:"string"==typeof s.data&&(n=s.data)}else"cellValue"in c&&(n=c.cellValue);return"number"==typeof i?r.changeset[u](f.Element.Cell,c,i):r.changeset[u](f.Element.Cell,e({},c,{cellValue:n}),1)}(i.get(t))}),u)};return(n={},n[f.Action.Insert]=r.changeset.insert,n[f.Action.Retain]=r.changeset.retain,n[f.Action.Remove]=r.changeset.remove,n)[a](f.Element.Table,s,l)};function b(){var t,r;return i(this,function(n){switch(n.label){case 0:t=this.content.getIter(),n.label=1;case 1:return t.hasNext()?(r=t.next(),[4,m(r)]):[3,3];case 2:return n.sent(),[3,1];case 3:return[2]}})}r.changeset={from:function(t){var r;return(r={type:f.ChangesetType.Richdoc,content:t})[Symbol.iterator]=b,r},create:function(t){return r.changeset.from(new c.Delta(t.map(r.toRichdocTable)))},insert:function(t,r,n){return{action:f.Action.Insert,element:t,attrs:r,data:n}},retain:function(t,r,n){return{action:f.Action.Retain,element:t,attrs:r,data:n}},remove:function(t,r,n){return{action:f.Action.Remove,element:t,attrs:r,data:n}},compose:function(t){return r.changeset.from(t.map(function(t){return t.content}).reduce(function(t,r){return t.compose(r)},new c.Delta([])))},transform:function(t,n){return r.changeset.from(t.content.transform(n.content))},invert:function(t,n){return r.changeset.from(t.content.invert(n.content))},serialize:function(t){return c.pack(t.content)},deserialize:function(t){return r.changeset.from(c.unpack(t))}}},2404:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mapObject=function(t,r){var n={};for(var e in t)if(t.hasOwnProperty(e)){var i=t[e];n[e]=r(i)}return n}},2405:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(t){for(var n in t)r.hasOwnProperty(n)||(r[n]=t[n])}(n(2018)),r.ColumnType={CREATE_AT:"CREATE_AT"}},2406:function(t,r,n){"use strict";var e=this&&this.o||function(){return(e=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)},i=this&&this.r||function(t,r,n,e){return new(n||(n=Promise))(function(i,o){function u(t){try{a(e.next(t))}catch(t){o(t)}}function c(t){try{a(e.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new n(function(r){r(t.value)}).then(u,c)}a((e=e.apply(t,r||[])).next())})},o=this&&this.i||function(t,r){var n,e,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,e&&(i=2&o[0]?e.return:o[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,o[1])).done)return i;switch(e=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,e=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=r.call(t,u)}catch(t){o=[6,t],e=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},u=this;Object.defineProperty(r,"__esModule",{value:!0});var c=n(2099),a=n(2407),f=n(2100),s=n(2101),l=n(2103),d=n(2408),v=function(){},h={info:v,error:v};r.createFormService=function(t){var r=t.formApiUrl,n=t.isMocking,v=void 0!==n&&n,m=t.logger,b=void 0===m?h:m,p=t.isTesting,y=void 0!==p&&p;null==r&&(r=window.location.origin+"/form");var w=void 0,g=void 0,O=f.createLogger({channel:"form",logger:b}),j=d.createFormApi({formApiUrl:r,logger:b,isTesting:y}),_=function(t){return i(u,void 0,void 0,function(){var r,n;return o(this,function(e){switch(e.label){case 0:return v?[2,g&&g.guid===t?g:void 0]:[3,1];case 1:return e.trys.push([1,3,,4]),[4,j.fetchForm(t)];case 2:return r=e.sent(),[2,s.fromServerForm(r.form,r.formItems)];case 3:if((n=e.sent())&&404==n.code&&/不存在/.test(n.errmsg))return[2,void 0];throw n;case 4:return[2]}})})},S=function(t){return i(u,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:if(!v)return[3,1];if(!g)throw new Error("mock form does not exist, cannot update");return Object.assign(g,t),[3,3];case 1:return[4,j.updateForm(e({},s.toServerForm(t),{formGuid:t.guid,formItems:t.items&&l.stringify(t.items.map(s.toServerFormItem))}))];case 2:r.sent(),r.label=3;case 3:return[2]}})})},C=function(t){return i(u,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:return v?(g=t,[3,3]):[3,1];case 1:return[4,j.createForm(e({},s.toServerForm(t),{formItems:l.stringify(t.items.map(s.toServerFormItem))}))];case 2:r.sent(),r.label=3;case 3:return[2]}})})},E=function(t){return i(u,void 0,void 0,function(){var r;return o(this,function(n){switch(n.label){case 0:return v?(g=void 0,[3,4]):[3,1];case 1:return[4,j.fetchFormDrafts(t)];case 2:return(r=n.sent())&&r.forms&&r.forms.length?[4,Promise.all(r.forms.map(function(t){return j.deleteForm(t.guid)}))]:[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}})})};return{MAX_ITEM_COUNT:100,MAX_DESC_LENGTH:200,createForm:function(){var t=new Date(new Date((new Date).getTime()+6048e5).setHours(12,0,0,0));return{guid:a.genId(16),spreadGuid:"",sheetGuid:"",title:"",desc:"",items:[],deadline:!1,deadlineDate:t}},createFormOption:function(t,r){return void 0===t&&(t=""),void 0===r&&(r="normal"),{type:r,value:a.genId(5),label:t}},createFormItemText:function(){return{guid:a.genId(5),type:c.FormItemType.Text,subject:"",required:!0}},createFormItemSingleChoice:function(){return{guid:a.genId(5),type:c.FormItemType.SingleChoice,subject:"",required:!0,options:[]}},createFormItemMultipleChoice:function(){return{guid:a.genId(5),type:c.FormItemType.MultipleChoice,subject:"",required:!0,options:[]}},createFormItemDropdownList:function(){return{guid:a.genId(5),type:c.FormItemType.DropdownList,subject:"",required:!0,options:[]}},copyFormItem:function(t){var r;return e({},(r=t,JSON.parse(JSON.stringify(r))),{guid:a.genId(5)})},isFormUnlinked:function(t){return null==t.sheetGuid||null==t.spreadGuid},isFormOverdue:function(t){return t.deadline&&t.deadlineDate&&t.deadlineDate.getTime()<(new Date).getTime()},fetchForm:O(_),fetchFormDraft:O(function(t){return i(u,void 0,void 0,function(){var r,n,e;return o(this,function(i){switch(i.label){case 0:return v?[2,w&&w.guid===t?w:void 0]:[3,1];case 1:return i.trys.push([1,6,,7]),[4,j.fetchFormDrafts(t)];case 2:return(r=i.sent())&&r.forms&&r.forms.length?[4,_(r.forms[0].guid)]:[3,4];case 3:return(n=i.sent())&&(n.guid=t),[2,n];case 4:return[2,void 0];case 5:return[3,7];case 6:if((e=i.sent())&&404==e.code&&/不存在/.test(e.errmsg))return[2,void 0];throw e;case 7:return[2]}})})}),submitFilledForm:O(function(t){var r=t.guid,n=t.items,e=t.userId;return i(u,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return v?[2]:[4,j.submitForm({formGuid:r,formItems:l.stringify(n.map(function(t){return s.toServerItemReponse(t,e)}))})];case 1:return t.sent(),[2]}})})}),publishForm:O(function(t){return i(u,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:return v?(w&&w.guid===t.guid&&(w=void 0),g=t,[3,8]):[3,1];case 1:return[4,_(t.guid)];case 2:return r.sent()?[3,4]:[4,O(C)(t)];case 3:return r.sent(),[3,6];case 4:return[4,O(S)(t)];case 5:r.sent(),r.label=6;case 6:return[4,E(t.guid)];case 7:r.sent(),r.label=8;case 8:return[2]}})})}),updateForm:O(S),unlinkForm:O(function(t){return i(u,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:if(!v)return[3,1];if(!g)throw new Error("mock form does not exist, cannot update");return g.spreadGuid=null,g.sheetGuid=null,[3,4];case 1:return[4,j.unlinkForm(t)];case 2:return r.sent(),[4,E(t)];case 3:r.sent(),r.label=4;case 4:return[2]}})})}),saveFormDraft:O(function(t){return i(u,void 0,void 0,function(){var r,n;return o(this,function(i){switch(i.label){case 0:return v?(w=t,[2]):[3,1];case 1:return[4,j.fetchFormDrafts(t.guid)];case 2:return(r=i.sent().forms).length?(n=r[0],[4,j.updateForm(e({},s.toServerForm(t),{guid:n.guid,formItems:l.stringify(t.items.map(s.toServerFormItem)),formGuid:n.guid}))]):[3,4];case 3:return i.sent(),[3,6];case 4:return[4,j.createFormDraft(e({},s.toServerForm(t),{formItems:l.stringify(t.items.map(s.toServerFormItem)),formGuid:t.guid}))];case 5:i.sent(),i.label=6;case 6:return[2]}})})}),updateFormDeadline:O(function(t){return i(u,void 0,void 0,function(){var r;return o(this,function(n){switch(n.label){case 0:return v?(g&&g.guid===t.guid&&Object.assign(g,{deadline:t.deadline,deadlineDate:t.deadlineDate}),[3,3]):[3,1];case 1:return r={guid:t.guid,deadline:t.deadline,deadlineDate:t.deadlineDate},[4,S(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})})}}},2407:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";r.genId=function(t){void 0===t&&(t=5);for(var r="",n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r}},2408:function(t,r,n){"use strict";var e=this&&this.r||function(t,r,n,e){return new(n||(n=Promise))(function(i,o){function u(t){try{a(e.next(t))}catch(t){o(t)}}function c(t){try{a(e.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new n(function(r){r(t.value)}).then(u,c)}a((e=e.apply(t,r||[])).next())})},i=this&&this.i||function(t,r){var n,e,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,e&&(i=2&o[0]?e.return:o[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,o[1])).done)return i;switch(e=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,e=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=r.call(t,u)}catch(t){o=[6,t],e=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},o=this;Object.defineProperty(r,"__esModule",{value:!0});var u=n(2100),c=n(2409),a=function(){},f={info:a,error:a};r.createFormApi=function(t){var r=t.formApiUrl,n=t.logger,a=void 0===n?f:n,s=t.isTesting,l=void 0!==s&&s,d=u.createLogger({channel:"request",logger:a})(function(t){var n=t.path,u=t.method,a=t.data;return e(o,void 0,void 0,function(){var t,e,o,f,s,d,v;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t={},l&&(t["x-shimo-user"]=JSON.stringify({id:12345}),(a=a||{}).test=1),[4,c.ajax.request(r+n,{method:u.toLowerCase(),data:a,headers:t})];case 1:return[2,i.sent()];case 2:throw e=i.sent(),o=e.response,f=o.status,s=o.data,d=(s||{}).message,(v=void 0===d?"":d)?{errmsg:v,code:f}:e;case 3:return[2]}})})});return{createForm:function(t){return d({path:"/forms",method:"POST",data:t})},createFormDraft:function(t){return d({path:"/forms/"+t.formGuid+"/drafts",method:"POST",data:t})},deleteForm:function(t){return d({path:"/forms/"+t,method:"DELETE"})},updateForm:function(t){return d({path:"/forms/"+t.formGuid,method:"PUT",data:t})},fetchForm:function(t){return d({path:"/forms/"+t,method:"GET"})},fetchFormDrafts:function(t){return d({path:"/forms/"+t+"/drafts",method:"GET"})},submitForm:function(t){return d({path:"/forms/"+t.formGuid+"/submitHistories",method:"POST",data:t})},unlinkForm:function(t){return d({path:"/forms/"+t+"/unLink",method:"POST",data:{formGuid:t}})}}}},2409:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(102);r.ajax={request:function(t,r){var n=r.method,i=r.data,o=r.headers;return"get"===n.toLowerCase()?e.default.request({url:t,method:n,params:i,headers:o}).then(function(t){return t.data}):e.default.request({url:t,method:n,data:i,headers:o}).then(function(t){return t.data})}}},2410:function(t,r,n){"use strict";var e=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},i=this&&this.c||function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(e(arguments[r]));return t};Object.defineProperty(r,"__esModule",{value:!0});var o=n(2016),u=n(2017),c="CREATE_AT";r.createChangeForCreateForm=function(t){for(var r=t.spread,n=t.form,e=t.type,a=t.userId,f="richdoc"===e?o.Changeset.Richdoc:o.Changeset.Modoc,s="richdoc"===e?o.Changeset.Richdoc.from(r):o.Changeset.Modoc.from(r),l=i(s),d=l[0].attrs.nextIndex||1,v=i(["填写时间"],n.items.map(function(t){return t.subject})),h=Math.max(18,v.length),m={},b=0;b<h;b++){var p=v[b];m[u.toCellName(0,b)]=f.retain(o.Element.Cell,{userId:a,authorId:a,color:"#ffffff",background:"#41464b",format:"@",cellValue:p},1)}var y=[f.insert(o.Element.Row,{height:30},1),f.insert(o.Element.Row,{},199)],w=i([f.insert(o.Element.Column,{formItemGuid:c,width:135},1)],n.items.map(function(t){return f.insert(o.Element.Column,{formItemGuid:t.guid},1)}),[1+n.items.length<18?f.insert(o.Element.Column,{},18-(n.items.length+1)):null]).filter(Boolean),g=[f.retain(o.Element.Table,{nextIndex:d+1},1),l.length>1?f.retain(o.Element.Table,{},l.length-1):null,f.insert(o.Element.Table,{id:n.sheetGuid,name:n.title,order:d,formGuid:n.guid,fixedRowsTop:1},{cells:m,rows:y,columns:w})].filter(Boolean);return f.create(g).content}},2411:function(t,r,n){"use strict";var e=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},i=this&&this.c||function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(e(arguments[r]));return t};Object.defineProperty(r,"__esModule",{value:!0});var o=n(2016);r.createChangeForUnlinkForm=function(t){var r=t.spread,n=t.sheetGuid,e=t.type,u=t.userId,c="richdoc"===e?o.Changeset.Richdoc:o.Changeset.Modoc,a="richdoc"===e?o.Changeset.Richdoc.from(r):o.Changeset.Modoc.from(r),f=i(a),s=f.findIndex(function(t){return(t.attrs||{}).id===n}),l=f[s],d=(l.data&&"number"!=typeof l.data&&l.data.columns||[]).map(function(t){return c.retain(o.Element.Column,{formItemGuid:null},t.data)}).filter(Boolean),v=[s>0?c.retain(o.Element.Table,{},s):null,c.retain(o.Element.Table,{formGuid:null,userId:u,authorId:u},{columns:d})].filter(Boolean);return c.create(v).content}},2412:function(t,r,n){"use strict";var e=this&&this.s||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r};Object.defineProperty(r,"__esModule",{value:!0}),n(2413),n(2495);var i=e(n(2497));r.formEntry=i;var o=e(n(2029));r.formService=o;var u=e(n(2007));r.types=u;var c=e(n(2124));r.formChangeset=c;var a=n(2525),f=n(2130),s=n(2129),l=n(2526),d=n(2123),v=n(2126).createDecorator({onError:function(t,r,n){}}),h={createChangeForCreateForm:v(a.createChangeForCreateForm),createChangeForUnlinkForm:v(f.createChangeForUnlinkForm),createChangeForUpdateForm:v(s.createChangeForUpdateForm),createChangeForCreateSpread:v(l.createChangeForCreateSpread),createChangeForSubmitForm:v(d.createChangeForSubmitForm)};r.sheetChangeset=h},2413:function(t,r,n){"use strict";try{n(2414),n(2451),n(2461),n(2465),n(2468),n(2471),n(2475),n(2478),n(2481),n(2489),n(2492),n(1844).polyfill()}catch(t){throw t}},2414:function(t,r,n){var e=n(2415);n(2446),n(2447),n(2448),n(2449),n(2450),t.exports=e},2415:function(t,r,n){n(2416),n(2424),n(2426),n(2431),n(2432),n(2433),n(2434),n(2116),n(2435),n(2436),n(2437),n(2438),n(2439),n(2440),n(2441),n(2442),n(2443),n(2444),n(2445);var e=n(1988);t.exports=e.Symbol},2416:function(t,r,n){"use strict";var e=n(1974),i=n(1978),o=n(2059),u=n(1980),c=n(1992),a=n(1991),f=n(2111),s=n(2112),l=n(2422),d=n(1970),v=n(2114),h=d("isConcatSpreadable"),m=v>=51||!i(function(){var t=[];return t[h]=!1,t.concat()[0]!==t}),b=l("concat"),p=function(t){if(!u(t))return!1;var r=t[h];return void 0!==r?!!r:o(t)};e({target:"Array",proto:!0,forced:!m||!b},{concat:function(t){var r,n,e,i,o,u=c(this),l=s(u,0),d=0;for(r=-1,e=arguments.length;r<e;r++)if(o=-1===r?u:arguments[r],p(o)){if(d+(i=a(o.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<i;n++,d++)n in o&&f(l,d,o[n])}else{if(d>=9007199254740991)throw TypeError("Maximum allowed index exceeded");f(l,d++,o)}return l.length=d,l}})},2417:function(t,r,n){var e=n(1971),i=n(2107),o=e.WeakMap;t.exports="function"==typeof o&&/native code/.test(i(o))},2418:function(t,r,n){var e=n(2026),i=n(2055),o=n(2058),u=n(1987);t.exports=e("Reflect","ownKeys")||function(t){var r=i.f(u(t)),n=o.f;return n?r.concat(n(t)):r}},2419:function(t,r,n){var e=n(1986),i=n(1991),o=n(2420),u=function(t){return function(r,n,u){var c,a=e(r),f=i(a.length),s=o(u,f);if(t&&n!=n){for(;f>s;)if((c=a[s++])!=c)return!0}else for(;f>s;s++)if((t||s in a)&&a[s]===n)return t||s||0;return!t&&-1}};t.exports={includes:u(!0),indexOf:u(!1)}},2420:function(t,r,n){var e=n(2056),i=Math.max,o=Math.min;t.exports=function(t,r){var n=e(t);return n<0?i(n+r,0):o(n,r)}},2421:function(t,r,n){var e=n(1978),i=/#|\.prototype\./,o=function(t,r){var n=c[u(t)];return n==f||n!=a&&("function"==typeof r?e(r):!!r)},u=o.normalize=function(t){return String(t).replace(i,".").toLowerCase()},c=o.data={},a=o.NATIVE="N",f=o.POLYFILL="P";t.exports=o},2422:function(t,r,n){var e=n(1978),i=n(1970),o=n(2114),u=i("species");t.exports=function(t){return o>=51||!e(function(){var r=[];return(r.constructor={})[u]=function(){return{foo:1}},1!==r[t](Boolean).foo})}},2423:function(t,r,n){var e=n(2026);t.exports=e("navigator","userAgent")||""},2424:function(t,r,n){var e=n(2061),i=n(2022),o=n(2425);e||i(Object.prototype,"toString",o,{unsafe:!0})},2425:function(t,r,n){"use strict";var e=n(2061),i=n(2115);t.exports=e?{}.toString:function(){return"[object "+i(this)+"]"}},2426:function(t,r,n){"use strict";var e=n(1974),i=n(1971),o=n(2026),u=n(1990),c=n(1979),a=n(2060),f=n(2113),s=n(1978),l=n(1975),d=n(2059),v=n(1980),h=n(1987),m=n(1992),b=n(1986),p=n(2021),y=n(2001),w=n(2062),g=n(2027),O=n(2055),j=n(2429),_=n(2058),S=n(2e3),C=n(1982),E=n(2019),I=n(1984),T=n(2022),M=n(2053),F=n(2024),k=n(2025),x=n(2054),N=n(1970),G=n(2063),A=n(1968),D=n(2002),R=n(2023),P=n(2064).forEach,V=F("hidden"),z=N("toPrimitive"),q=R.set,L=R.getterFor("Symbol"),B=Object.prototype,J=i.Symbol,U=o("JSON","stringify"),Y=S.f,Q=C.f,H=j.f,W=E.f,$=M("symbols"),K=M("op-symbols"),Z=M("string-to-symbol-registry"),X=M("symbol-to-string-registry"),tt=M("wks"),rt=i.QObject,nt=!rt||!rt.prototype||!rt.prototype.findChild,et=c&&s(function(){return 7!=w(Q({},"a",{get:function(){return Q(this,"a",{value:7}).a}})).a})?function(t,r,n){var e=Y(B,r);e&&delete B[r],Q(t,r,n),e&&t!==B&&Q(B,r,e)}:Q,it=function(t,r){var n=$[t]=w(J.prototype);return q(n,{type:"Symbol",tag:t,description:r}),c||(n.description=r),n},ot=f?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof J},ut=function(t,r,n){t===B&&ut(K,r,n),h(t);var e=p(r,!0);return h(n),l($,e)?(n.enumerable?(l(t,V)&&t[V][e]&&(t[V][e]=!1),n=w(n,{enumerable:y(0,!1)})):(l(t,V)||Q(t,V,y(1,{})),t[V][e]=!0),et(t,e,n)):Q(t,e,n)},ct=function(t,r){h(t);var n=b(r),e=g(n).concat(lt(n));return P(e,function(r){c&&!at.call(n,r)||ut(t,r,n[r])}),t},at=function(t){var r=p(t,!0),n=W.call(this,r);return!(this===B&&l($,r)&&!l(K,r))&&(!(n||!l(this,r)||!l($,r)||l(this,V)&&this[V][r])||n)},ft=function(t,r){var n=b(t),e=p(r,!0);if(n!==B||!l($,e)||l(K,e)){var i=Y(n,e);return!i||!l($,e)||l(n,V)&&n[V][e]||(i.enumerable=!0),i}},st=function(t){var r=H(b(t)),n=[];return P(r,function(t){l($,t)||l(k,t)||n.push(t)}),n},lt=function(t){var r=t===B,n=H(r?K:b(t)),e=[];return P(n,function(t){!l($,t)||r&&!l(B,t)||e.push($[t])}),e};(a||(T((J=function(){if(this instanceof J)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,r=x(t),n=function(t){this===B&&n.call(K,t),l(this,V)&&l(this[V],r)&&(this[V][r]=!1),et(this,r,y(1,t))};return c&&nt&&et(B,r,{configurable:!0,set:n}),it(r,t)}).prototype,"toString",function(){return L(this).tag}),T(J,"withoutSetter",function(t){return it(x(t),t)}),E.f=at,C.f=ut,S.f=ft,O.f=j.f=st,_.f=lt,G.f=function(t){return it(N(t),t)},c&&(Q(J.prototype,"description",{configurable:!0,get:function(){return L(this).description}}),u||T(B,"propertyIsEnumerable",at,{unsafe:!0}))),e({global:!0,wrap:!0,forced:!a,sham:!a},{Symbol:J}),P(g(tt),function(t){A(t)}),e({target:"Symbol",stat:!0,forced:!a},{for:function(t){var r=String(t);if(l(Z,r))return Z[r];var n=J(r);return Z[r]=n,X[n]=r,n},keyFor:function(t){if(!ot(t))throw TypeError(t+" is not a symbol");if(l(X,t))return X[t]},useSetter:function(){nt=!0},useSimple:function(){nt=!1}}),e({target:"Object",stat:!0,forced:!a,sham:!c},{create:function(t,r){return void 0===r?w(t):ct(w(t),r)},defineProperty:ut,defineProperties:ct,getOwnPropertyDescriptor:ft}),e({target:"Object",stat:!0,forced:!a},{getOwnPropertyNames:st,getOwnPropertySymbols:lt}),e({target:"Object",stat:!0,forced:s(function(){_.f(1)})},{getOwnPropertySymbols:function(t){return _.f(m(t))}}),U)&&e({target:"JSON",stat:!0,forced:!a||s(function(){var t=J();return"[null]"!=U([t])||"{}"!=U({a:t})||"{}"!=U(Object(t))})},{stringify:function(t,r,n){for(var e,i=[t],o=1;arguments.length>o;)i.push(arguments[o++]);if(e=r,(v(r)||void 0!==t)&&!ot(t))return d(r)||(r=function(t,r){if("function"==typeof e&&(r=e.call(this,t,r)),!ot(r))return r}),i[1]=r,U.apply(null,i)}});J.prototype[z]||I(J.prototype,z,J.prototype.valueOf),D(J,"Symbol"),k[V]=!0},2427:function(t,r,n){var e=n(1979),i=n(1982),o=n(1987),u=n(2027);t.exports=e?Object.defineProperties:function(t,r){o(t);for(var n,e=u(r),c=e.length,a=0;c>a;)i.f(t,n=e[a++],r[n]);return t}},2428:function(t,r,n){var e=n(2026);t.exports=e("document","documentElement")},2429:function(t,r,n){var e=n(1986),i=n(2055).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?function(t){try{return i(t)}catch(t){return u.slice()}}(t):i(e(t))}},2430:function(t,r){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},2431:function(t,r,n){n(1968)("asyncIterator")},2432:function(t,r,n){"use strict";var e=n(1974),i=n(1979),o=n(1971),u=n(1975),c=n(1980),a=n(1982).f,f=n(2109),s=o.Symbol;if(i&&"function"==typeof s&&(!("description"in s.prototype)||void 0!==s().description)){var l={},d=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),r=this instanceof d?new s(t):void 0===t?s():s(t);return""===t&&(l[r]=!0),r};f(d,s);var v=d.prototype=s.prototype;v.constructor=d;var h=v.toString,m="Symbol(test)"==String(s("test")),b=/^Symbol\((.*)\)[^)]+$/;a(v,"description",{configurable:!0,get:function(){var t=c(this)?this.valueOf():this,r=h.call(t);if(u(l,t))return"";var n=m?r.slice(7,-1):r.replace(b,"$1");return""===n?void 0:n}}),e({global:!0,forced:!0},{Symbol:d})}},2433:function(t,r,n){n(1968)("hasInstance")},2434:function(t,r,n){n(1968)("isConcatSpreadable")},2435:function(t,r,n){n(1968)("match")},2436:function(t,r,n){n(1968)("matchAll")},2437:function(t,r,n){n(1968)("replace")},2438:function(t,r,n){n(1968)("search")},2439:function(t,r,n){n(1968)("species")},2440:function(t,r,n){n(1968)("split")},2441:function(t,r,n){n(1968)("toPrimitive")},2442:function(t,r,n){n(1968)("toStringTag")},2443:function(t,r,n){n(1968)("unscopables")},2444:function(t,r,n){n(2002)(Math,"Math",!0)},2445:function(t,r,n){var e=n(1971);n(2002)(e.JSON,"JSON",!0)},2446:function(t,r,n){n(1968)("asyncDispose")},2447:function(t,r,n){n(1968)("dispose")},2448:function(t,r,n){n(1968)("observable")},2449:function(t,r,n){n(1968)("patternMatch")},2450:function(t,r,n){n(1968)("replaceAll")},2451:function(t,r,n){var e=n(2452);t.exports=e},2452:function(t,r,n){n(2116),n(2117),n(2458);var e=n(2063);t.exports=e.f("iterator")},2453:function(t,r,n){var e=n(2056),i=n(1989),o=function(t){return function(r,n){var o,u,c=String(i(r)),a=e(n),f=c.length;return a<0||a>=f?t?"":void 0:(o=c.charCodeAt(a))<55296||o>56319||a+1===f||(u=c.charCodeAt(a+1))<56320||u>57343?t?c.charAt(a):o:t?c.slice(a,a+2):u-56320+(o-55296<<10)+65536}};t.exports={codeAt:o(!1),charAt:o(!0)}},2454:function(t,r,n){"use strict";var e=n(2119).IteratorPrototype,i=n(2062),o=n(2001),u=n(2002),c=n(2003),a=function(){return this};t.exports=function(t,r,n){var f=r+" Iterator";return t.prototype=i(e,{next:o(1,n)}),u(t,f,!1,!0),c[f]=a,t}},2455:function(t,r,n){var e=n(1978);t.exports=!e(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})},2456:function(t,r,n){var e=n(1987),i=n(2457);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,r=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),r=n instanceof Array}catch(t){}return function(n,o){return e(n),i(o),r?t.call(n,o):n.__proto__=o,n}}():void 0)},2457:function(t,r,n){var e=n(1980);t.exports=function(t){if(!e(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},2458:function(t,r,n){var e=n(1971),i=n(2459),o=n(2460),u=n(1984),c=n(1970),a=c("iterator"),f=c("toStringTag"),s=o.values;for(var l in i){var d=e[l],v=d&&d.prototype;if(v){if(v[a]!==s)try{u(v,a,s)}catch(t){v[a]=s}if(v[f]||u(v,f,l),i[l])for(var h in o)if(v[h]!==o[h])try{u(v,h,o[h])}catch(t){v[h]=o[h]}}}},2459:function(t,r){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},2460:function(t,r,n){"use strict";var e=n(1986),i=n(2066),o=n(2003),u=n(2023),c=n(2118),a=u.set,f=u.getterFor("Array Iterator");t.exports=c(Array,"Array",function(t,r){a(this,{type:"Array Iterator",target:e(t),index:0,kind:r})},function(){var t=f(this),r=t.target,n=t.kind,e=t.index++;return!r||e>=r.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:e,done:!1}:"values"==n?{value:r[e],done:!1}:{value:[e,r[e]],done:!1}},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},2461:function(t,r,n){var e=n(2462);t.exports=e},2462:function(t,r,n){n(2463);var e=n(1988);t.exports=e.Object.assign},2463:function(t,r,n){var e=n(1974),i=n(2464);e({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},2464:function(t,r,n){"use strict";var e=n(1979),i=n(1978),o=n(2027),u=n(2058),c=n(2019),a=n(1992),f=n(2051),s=Object.assign,l=Object.defineProperty;t.exports=!s||i(function(){if(e&&1!==s({b:1},s(l({},"a",{enumerable:!0,get:function(){l(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},r={},n=Symbol();return t[n]=7,"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),7!=s({},t)[n]||"abcdefghijklmnopqrst"!=o(s({},r)).join("")})?function(t,r){for(var n=a(t),i=arguments.length,s=1,l=u.f,d=c.f;i>s;)for(var v,h=f(arguments[s++]),m=l?o(h).concat(l(h)):o(h),b=m.length,p=0;b>p;)v=m[p++],e&&!d.call(h,v)||(n[v]=h[v]);return n}:s},2465:function(t,r,n){var e=n(2466);t.exports=e},2466:function(t,r,n){n(2467);var e=n(1988);t.exports=e.Object.values},2467:function(t,r,n){var e=n(1974),i=n(2121).values;e({target:"Object",stat:!0},{values:function(t){return i(t)}})},2468:function(t,r,n){var e=n(2469);t.exports=e},2469:function(t,r,n){n(2470);var e=n(1988);t.exports=e.Object.entries},2470:function(t,r,n){var e=n(1974),i=n(2121).entries;e({target:"Object",stat:!0},{entries:function(t){return i(t)}})},2471:function(t,r,n){var e=n(2472);t.exports=e},2472:function(t,r,n){n(2473);var e=n(2004);t.exports=e("String","startsWith")},2473:function(t,r,n){"use strict";var e,i=n(1974),o=n(2e3).f,u=n(1991),c=n(2067),a=n(1989),f=n(2068),s=n(1990),l="".startsWith,d=Math.min,v=f("startsWith");i({target:"String",proto:!0,forced:!!(s||v||(e=o(String.prototype,"startsWith"),!e||e.writable))&&!v},{startsWith:function(t){var r=String(a(this));c(t);var n=u(d(arguments.length>1?arguments[1]:void 0,r.length)),e=String(t);return l?l.call(r,e,n):r.slice(n,n+e.length)===e}})},2474:function(t,r,n){var e=n(1980),i=n(2020),o=n(1970)("match");t.exports=function(t){var r;return e(t)&&(void 0!==(r=t[o])?!!r:"RegExp"==i(t))}},2475:function(t,r,n){var e=n(2476);t.exports=e},2476:function(t,r,n){n(2477);var e=n(2004);t.exports=e("String","endsWith")},2477:function(t,r,n){"use strict";var e,i=n(1974),o=n(2e3).f,u=n(1991),c=n(2067),a=n(1989),f=n(2068),s=n(1990),l="".endsWith,d=Math.min,v=f("endsWith");i({target:"String",proto:!0,forced:!!(s||v||(e=o(String.prototype,"endsWith"),!e||e.writable))&&!v},{endsWith:function(t){var r=String(a(this));c(t);var n=arguments.length>1?arguments[1]:void 0,e=u(r.length),i=void 0===n?e:d(u(n),e),o=String(t);return l?l.call(r,o,i):r.slice(i-o.length,i)===o}})},2478:function(t,r,n){var e=n(2479);t.exports=e},2479:function(t,r,n){n(2480);var e=n(2004);t.exports=e("String","includes")},2480:function(t,r,n){"use strict";var e=n(1974),i=n(2067),o=n(1989);e({target:"String",proto:!0,forced:!n(2068)("includes")},{includes:function(t){return!!~String(o(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},2481:function(t,r,n){var e=n(2482);t.exports=e},2482:function(t,r,n){n(2117),n(2483);var e=n(1988);t.exports=e.Array.from},2483:function(t,r,n){var e=n(1974),i=n(2484);e({target:"Array",stat:!0,forced:!n(2488)(function(t){Array.from(t)})},{from:i})},2484:function(t,r,n){"use strict";var e=n(2065),i=n(1992),o=n(2485),u=n(2486),c=n(1991),a=n(2111),f=n(2487);t.exports=function(t){var r,n,s,l,d,v,h=i(t),m="function"==typeof this?this:Array,b=arguments.length,p=b>1?arguments[1]:void 0,y=void 0!==p,w=f(h),g=0;if(y&&(p=e(p,b>2?arguments[2]:void 0,2)),void 0==w||m==Array&&u(w))for(n=new m(r=c(h.length));r>g;g++)v=y?p(h[g],g):h[g],a(n,g,v);else for(d=(l=w.call(h)).next,n=new m;!(s=d.call(l)).done;g++)v=y?o(l,p,[s.value,g],!0):s.value,a(n,g,v);return n.length=g,n}},2485:function(t,r,n){var e=n(1987);t.exports=function(t,r,n,i){try{return i?r(e(n)[0],n[1]):r(n)}catch(r){var o=t.return;throw void 0!==o&&e(o.call(t)),r}}},2486:function(t,r,n){var e=n(1970),i=n(2003),o=e("iterator"),u=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||u[o]===t)}},2487:function(t,r,n){var e=n(2115),i=n(2003),o=n(1970)("iterator");t.exports=function(t){if(void 0!=t)return t[o]||t["@@iterator"]||i[e(t)]}},2488:function(t,r,n){var e=n(1970)("iterator"),i=!1;try{var o=0,u={next:function(){return{done:!!o++}},return:function(){i=!0}};u[e]=function(){return this},Array.from(u,function(){throw 2})}catch(t){}t.exports=function(t,r){if(!r&&!i)return!1;var n=!1;try{var o={};o[e]=function(){return{next:function(){return{done:n=!0}}}},t(o)}catch(t){}return n}},2489:function(t,r,n){var e=n(2490);t.exports=e},2490:function(t,r,n){n(2491);var e=n(2004);t.exports=e("Array","find")},2491:function(t,r,n){"use strict";var e=n(1974),i=n(2064).find,o=n(2066),u=!0,c=n(2122)("find");"find"in[]&&Array(1).find(function(){u=!1}),e({target:"Array",proto:!0,forced:u||!c},{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o("find")},2492:function(t,r,n){var e=n(2493);t.exports=e},2493:function(t,r,n){n(2494);var e=n(2004);t.exports=e("Array","findIndex")},2494:function(t,r,n){"use strict";var e=n(1974),i=n(2064).findIndex,o=n(2066),u=!0,c=n(2122)("findIndex");"findIndex"in[]&&Array(1).findIndex(function(){u=!1}),e({target:"Array",proto:!0,forced:u||!c},{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o("findIndex")},2495:function(t,r,n){"use strict";var e=this&&this.s||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r};Object.defineProperty(r,"__esModule",{value:!0});var i=n(1),o=n(2028),u=i.getS18n("lizard-service-form"),c=e(n(2496));u.addLocaleResource("ja-JP",c),u.setLocaleSync(o.locale)},2496:function(t,r){t.exports={"填写时间":"提交時間","填写人":"直接入力","未命名问题":"質問の名前","数据来源":"データソース","找不到指定的表单工作表":"指定されたワークシートが見つかりません。",'后缀只能由 数字/字母/"-" 组成，长度 1~15':'サフィックスは数字/文字/ "-"、長さ1〜15のみで構成できます',"未命名表单":"フォーム名","地址":"住所","日期":"日付","下拉列表":"ドロップダウンリスト","列表":"リスト","请填写'其他'项内容":"「その他」の項目を記入してください。","选项%s":"オプション%s","邮箱":"E-mail","邮箱格式不正确":"メールボックスの形式が正しくありません","图片收集":"画像収集","图片":"画像","限定的选项数设置有误":"修飾されたオプションの数が正しく設定されていません。","选择 %s 项":"%sアイテムを選択してください","最少选择 %1 项，最多选择 %2 项":"少なくとも%1アイテムを選択し、最大で%2アイテムを選択してください","选择 %1 - %2 项":"%1-%2アイテムを選択してください","最少选择 %s 项":"少なくとも%s個のアイテムを選択してください","最多选择 %s 项":"最大%s個のアイテムを選択してください","多选":"複数選択","多行文本":"複数行のテキスト","多行":"複数行","姓名":"名前","数字":"数","电话":"電話","号码格式不正确":"数値の形式が正しくありません。","其他":"その他","评分":"スコア","单选":"ラジオ","单行文本":"一行のテキスト","单行":"一行","时间":"時間","缺少必要的信息":"必要な項目が不足しています","问题项不存在":"設問がありません","问题项必须为 单选/多选/下拉 类型":"設問項目はラジオボタン/複数選択/プルダウンでなければなりません","选项不存在":"オプションが存在しません","要显示的问题不存在":"表示する設問が存在しません","要显示的问题项须在触发问题项后面":"表示される設問は、元となる設問の後になければなりません","要显示的问题项已被其他规则指定":"表示する設問は別のルールで指定されています"}},2497:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(2123),i=n(2129),o=n(2130);r.formEntryToChangeset=function(t){var r=t.content,n=t.formEntry,u=(t.userId,t.fileType);if(u=u||"richdoc","submit_entry_v2"===n.action){var c=n.payload,a=c.form,f=c.formGuid,s=c.submission;c.userId;return e.createChangeForSubmitForm({spread:r,fileType:u,form:a,formGuid:f,submission:s,time:new Date})}if("submit_entry_batch_v2"===n.action){var l=n.payload;a=l.form,f=l.formGuid,s=l.submission,l.userId;return e.createChangeForSubmitForm({spread:r,fileType:u,form:a,formGuid:f,submission:s,time:new Date})}if("update_form_v2"===n.action){var d=n.payload,v=(a=d.form,f=d.formGuid,d.userId);return i.createChangeForUpdateForm({spread:r,fileType:u,form:a,formGuid:f,userId:v})}if("unlink_form_v2"===n.action){var h=n.payload,m=(f=h.formGuid,h.userId);return o.createChangeForUnlinkForm({spread:r,fileType:u,formGuid:f,userId:m})}throw new Error("unexpected formEntry: "+JSON.stringify(n))}},2498:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(t){var e;n.d(r,"Immer",function(){return B}),n.d(r,"applyPatches",function(){return W}),n.d(r,"createDraft",function(){return $}),n.d(r,"finishDraft",function(){return K}),n.d(r,"immerable",function(){return o}),n.d(r,"isDraft",function(){return c}),n.d(r,"isDraftable",function(){return a}),n.d(r,"nothing",function(){return i}),n.d(r,"original",function(){return f}),n.d(r,"produce",function(){return U}),n.d(r,"produceWithPatches",function(){return Y}),n.d(r,"setAutoFreeze",function(){return Q}),n.d(r,"setUseProxies",function(){return H});var i="undefined"!=typeof Symbol?Symbol("immer-nothing"):((e={})["immer-nothing"]=!0,e),o="undefined"!=typeof Symbol&&Symbol.for?Symbol.for("immer-draftable"):"__$immer_draftable",u="undefined"!=typeof Symbol&&Symbol.for?Symbol.for("immer-state"):"__$immer_state";function c(t){return!!t&&!!t[u]}function a(t){return!!t&&(function(t){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t))return!0;var r=Object.getPrototypeOf(t);return!r||r===Object.prototype}(t)||!!t[o]||!!t.constructor[o])}function f(t){if(t&&t[u])return t[u].base}var s=Object.assign||function(t,r){for(var n in r)m(r,n)&&(t[n]=r[n]);return t},l="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames;function d(t,r){if(void 0===r&&(r=!1),Array.isArray(t))return t.slice();var n=Object.create(Object.getPrototypeOf(t));return l(t).forEach(function(e){if(e!==u){var i=Object.getOwnPropertyDescriptor(t,e),o=i.value;if(i.get){if(!r)throw new Error("Immer drafts cannot have computed properties");o=i.get.call(t)}i.enumerable?n[e]=o:Object.defineProperty(n,e,{value:o,writable:!0,configurable:!0})}}),n}function v(t,r){if(Array.isArray(t))for(var n=0;n<t.length;n++)r(n,t[n],t);else l(t).forEach(function(n){return r(n,t[n],t)})}function h(t,r){var n=Object.getOwnPropertyDescriptor(t,r);return!!n&&n.enumerable}function m(t,r){return Object.prototype.hasOwnProperty.call(t,r)}function b(t,r){return t===r?0!==t||1/t==1/r:t!=t&&r!=r}function p(t){if(!a(t))return t;if(Array.isArray(t))return t.map(p);var r=Object.create(Object.getPrototypeOf(t));for(var n in t)r[n]=p(t[n]);return r}var y=function(t){this.drafts=[],this.parent=t,this.canAutoFreeze=!0,this.patches=null};function w(t){t[u].revoke()}y.prototype.usePatches=function(t){t&&(this.patches=[],this.inversePatches=[],this.patchListener=t)},y.prototype.revoke=function(){this.leave(),this.drafts.forEach(w),this.drafts=null},y.prototype.leave=function(){this===y.current&&(y.current=this.parent)},y.current=null,y.enter=function(){return this.current=new y(this.current)};var g={};function O(t,r){var n=Array.isArray(t),e=I(t);v(e,function(r){!function(t,r,n){var e=g[r];e?e.enumerable=n:g[r]=e={configurable:!0,enumerable:n,get:function(){return function(t,r){T(t);var n=S(_(t),r);if(t.finalizing)return n;if(n===S(t.base,r)&&a(n))return E(t),t.copy[r]=O(n,t);return n}(this[u],r)},set:function(t){!function(t,r,n){if(T(t),t.assigned[r]=!0,!t.modified){if(b(n,S(_(t),r)))return;C(t),E(t)}t.copy[r]=n}(this[u],r,t)}};Object.defineProperty(t,r,e)}(e,r,n||h(t,r))});var i,o,c,f=r?r.scope:y.current;return i=e,o=u,c={scope:f,modified:!1,finalizing:!1,finalized:!1,assigned:{},parent:r,base:t,draft:e,copy:null,revoke:j,revoked:!1},Object.defineProperty(i,o,{value:c,enumerable:!1,writable:!0}),f.drafts.push(e),e}function j(){this.revoked=!0}function _(t){return t.copy||t.base}function S(t,r){var n=t[u];if(n&&!n.finalizing){n.finalizing=!0;var e=t[r];return n.finalizing=!1,e}return t[r]}function C(t){t.modified||(t.modified=!0,t.parent&&C(t.parent))}function E(t){t.copy||(t.copy=I(t.base))}function I(t){var r=t&&t[u];if(r){r.finalizing=!0;var n=d(r.draft,!0);return r.finalizing=!1,n}return d(t)}function T(t){if(!0===t.revoked)throw new Error("Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+JSON.stringify(_(t)))}function M(t){for(var r=t.length-1;r>=0;r--){var n=t[r][u];n.modified||(Array.isArray(n.base)?k(n)&&C(n):F(n)&&C(n))}}function F(t){for(var r=t.base,n=t.draft,e=Object.keys(n),i=e.length-1;i>=0;i--){var o=e[i],c=r[o];if(void 0===c&&!m(r,o))return!0;var a=n[o],f=a&&a[u];if(f?f.base!==c:!b(a,c))return!0}return e.length!==Object.keys(r).length}function k(t){var r=t.draft;if(r.length!==t.base.length)return!0;var n=Object.getOwnPropertyDescriptor(r,r.length-1);return!(!n||n.get)}var x=Object.freeze({willFinalize:function(t,r,n){t.drafts.forEach(function(t){t[u].finalizing=!0}),n?c(r)&&r[u].scope===t&&M(t.drafts):(t.patches&&function t(r){if(r&&"object"==typeof r){var n=r[u];if(n){var e=n.base,i=n.draft,o=n.assigned;if(Array.isArray(r)){if(k(n)){if(C(n),o.length=!0,i.length<e.length)for(var c=i.length;c<e.length;c++)o[c]=!1;else for(var a=e.length;a<i.length;a++)o[a]=!0;for(var f=0;f<i.length;f++)void 0===o[f]&&t(i[f])}}else Object.keys(i).forEach(function(r){void 0!==e[r]||m(e,r)?o[r]||t(i[r]):(o[r]=!0,C(n))}),Object.keys(e).forEach(function(t){void 0!==i[t]||m(i,t)||(o[t]=!1,C(n))})}}}(t.drafts[0]),M(t.drafts))},createProxy:O});function N(t,r){var n=r?r.scope:y.current,e={scope:n,modified:!1,finalized:!1,assigned:{},parent:r,base:t,draft:null,drafts:{},copy:null,revoke:null},i=Array.isArray(t)?Proxy.revocable([e],A):Proxy.revocable(e,G),o=i.revoke,u=i.proxy;return e.draft=u,e.revoke=o,n.drafts.push(u),u}var G={get:function(t,r){if(r===u)return t;var n=t.drafts;if(!t.modified&&m(n,r))return n[r];var e=D(t)[r];if(t.finalized||!a(e))return e;if(t.modified){if(e!==R(t.base,r))return e;n=t.copy}return n[r]=N(e,t)},has:function(t,r){return r in D(t)},ownKeys:function(t){return Reflect.ownKeys(D(t))},set:function(t,r,n){if(!t.modified){var e=R(t.base,r),i=n?b(e,n)||n===t.drafts[r]:b(e,n)&&r in t.base;if(i)return!0;P(t)}return t.assigned[r]=!0,t.copy[r]=n,!0},deleteProperty:function(t,r){void 0!==R(t.base,r)||r in t.base?(t.assigned[r]=!1,P(t)):t.assigned[r]&&delete t.assigned[r];t.copy&&delete t.copy[r];return!0},getOwnPropertyDescriptor:function(t,r){var n=D(t),e=Reflect.getOwnPropertyDescriptor(n,r);e&&(e.writable=!0,e.configurable=!Array.isArray(n)||"length"!==r);return e},defineProperty:function(){throw new Error("Object.defineProperty() cannot be used on an Immer draft")},getPrototypeOf:function(t){return Object.getPrototypeOf(t.base)},setPrototypeOf:function(){throw new Error("Object.setPrototypeOf() cannot be used on an Immer draft")}},A={};function D(t){return t.copy||t.base}function R(t,r){var n=t[u],e=Reflect.getOwnPropertyDescriptor(n?D(n):t,r);return e&&e.value}function P(t){t.modified||(t.modified=!0,t.copy=s(d(t.base),t.drafts),t.drafts=null,t.parent&&P(t.parent))}v(G,function(t,r){A[t]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}}),A.deleteProperty=function(t,r){if(isNaN(parseInt(r)))throw new Error("Immer only supports deleting array indices");return G.deleteProperty.call(this,t[0],r)},A.set=function(t,r,n){if("length"!==r&&isNaN(parseInt(r)))throw new Error("Immer only supports setting array indices and the 'length' property");return G.set.call(this,t[0],r,n)};var V=Object.freeze({willFinalize:function(){},createProxy:N});function z(t,r,n,e){Array.isArray(t.base)?function(t,r,n,e){var i,o,u=t.base,c=t.copy,a=t.assigned;c.length<u.length&&(u=(i=[c,u])[0],c=i[1],n=(o=[e,n])[0],e=o[1]);var f=c.length-u.length,s=0;for(;u[s]===c[s]&&s<u.length;)++s;var l=u.length;for(;l>s&&u[l-1]===c[l+f-1];)--l;for(var d=s;d<l;++d)if(a[d]&&c[d]!==u[d]){var v=r.concat([d]);n.push({op:"replace",path:v,value:c[d]}),e.push({op:"replace",path:v,value:u[d]})}for(var h=n.length,m=l+f-1;m>=l;--m){var b=r.concat([m]);n[h+m-l]={op:"add",path:b,value:c[m]},e.push({op:"remove",path:b})}}(t,r,n,e):function(t,r,n,e){var i=t.base,o=t.copy;v(t.assigned,function(t,u){var c=i[t],a=o[t],f=u?t in i?"replace":"add":"remove";if(c!==a||"replace"!==f){var s=r.concat(t);n.push("remove"===f?{op:f,path:s}:{op:f,path:s,value:a}),e.push("add"===f?{op:"remove",path:s}:"remove"===f?{op:"add",path:s,value:c}:{op:"replace",path:s,value:c})}})}(t,r,n,e)}var q=function(t,r){for(var n=0,e=r;n<e.length;n+=1){var i=e[n],o=i.path,u=i.op,c=p(i.value);if(!o.length)throw new Error("Illegal state");for(var a=t,f=0;f<o.length-1;f++)if(!(a=a[o[f]])||"object"!=typeof a)throw new Error("Cannot apply patch, path doesn't resolve: "+o.join("/"));var s=o[o.length-1];switch(u){case"replace":a[s]=c;break;case"add":Array.isArray(a)?a.splice(s,0,c):a[s]=c;break;case"remove":Array.isArray(a)?a.splice(s,1):delete a[s];break;default:throw new Error("Unsupported patch operation: "+u)}}return t};var L={useProxies:"undefined"!=typeof Proxy&&"undefined"!=typeof Reflect,autoFreeze:void 0===t&&"verifyMinified"===function(){}.name,onAssign:null,onDelete:null,onCopy:null},B=function(t){s(this,L,t),this.setUseProxies(this.useProxies),this.produce=this.produce.bind(this)};B.prototype.produce=function(t,r,n){var e,o=this;if("function"==typeof t&&"function"!=typeof r){var u=r;r=t;var c=this;return function(t){var n=this;void 0===t&&(t=u);for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];return c.produce(t,function(t){return r.call.apply(r,[n,t].concat(e))})}}if("function"!=typeof r)throw new Error("The first or second argument to `produce` must be a function");if(void 0!==n&&"function"!=typeof n)throw new Error("The third argument to `produce` must be a function or undefined");if(a(t)){var f=y.enter(),s=this.createProxy(t),l=!0;try{e=r(s),l=!1}finally{l?f.revoke():f.leave()}return e instanceof Promise?e.then(function(t){return f.usePatches(n),o.processResult(t,f)},function(t){throw f.revoke(),t}):(f.usePatches(n),this.processResult(e,f))}return void 0===(e=r(t))?t:e!==i?e:void 0},B.prototype.produceWithPatches=function(t,r,n){var e,i,o=this;if("function"==typeof t)return function(r){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];return o.produceWithPatches(r,function(r){return t.apply(void 0,[r].concat(n))})};if(n)throw new Error("A patch listener cannot be passed to produceWithPatches");return[this.produce(t,r,function(t,r){e=t,i=r}),e,i]},B.prototype.createDraft=function(t){if(!a(t))throw new Error("First argument to `createDraft` must be a plain object, an array, or an immerable object");var r=y.enter(),n=this.createProxy(t);return n[u].isManual=!0,r.leave(),n},B.prototype.finishDraft=function(t,r){var n=t&&t[u];if(!n||!n.isManual)throw new Error("First argument to `finishDraft` must be a draft returned by `createDraft`");if(n.finalized)throw new Error("The given draft is already finalized");var e=n.scope;return e.usePatches(r),this.processResult(void 0,e)},B.prototype.setAutoFreeze=function(t){this.autoFreeze=t},B.prototype.setUseProxies=function(t){this.useProxies=t,s(this,t?V:x)},B.prototype.applyPatches=function(t,r){var n;for(n=r.length-1;n>=0;n--){var e=r[n];if(0===e.path.length&&"replace"===e.op){t=e.value;break}}return c(t)?q(t,r):this.produce(t,function(t){return q(t,r.slice(n+1))})},B.prototype.processResult=function(t,r){var n=r.drafts[0],e=void 0!==t&&t!==n;if(this.willFinalize(r,t,e),e){if(n[u].modified)throw r.revoke(),new Error("An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.");a(t)&&(t=this.finalize(t,null,r)),r.patches&&(r.patches.push({op:"replace",path:[],value:t}),r.inversePatches.push({op:"replace",path:[],value:n[u].base}))}else t=this.finalize(n,[],r);return r.revoke(),r.patches&&r.patchListener(r.patches,r.inversePatches),t!==i?t:void 0},B.prototype.finalize=function(t,r,n){var e=this,i=t[u];if(!i)return Object.isFrozen(t)?t:this.finalizeTree(t,null,n);if(i.scope!==n)return t;if(!i.modified)return i.base;if(!i.finalized){if(i.finalized=!0,this.finalizeTree(i.draft,r,n),this.onDelete)if(this.useProxies){var o=i.assigned;for(var c in o)o[c]||this.onDelete(i,c)}else{var a=i.base,f=i.copy;v(a,function(t){m(f,t)||e.onDelete(i,t)})}this.onCopy&&this.onCopy(i),this.autoFreeze&&n.canAutoFreeze&&Object.freeze(i.copy),r&&n.patches&&z(i,r,n.patches,n.inversePatches)}return i.copy},B.prototype.finalizeTree=function(t,r,n){var e=this,i=t[u];i&&(this.useProxies||(i.copy=d(i.draft,!0)),t=i.copy);var o=!!r&&!!n.patches,f=function(u,s,l){if(s===l)throw Error("Immer forbids circular references");var d=!!i&&l===t;if(c(s)){var m=d&&o&&!i.assigned[u]?r.concat(u):null;if(c(s=e.finalize(s,m,n))&&(n.canAutoFreeze=!1),Array.isArray(l)||h(l,u)?l[u]=s:Object.defineProperty(l,u,{value:s}),d&&s===i.base[u])return}else{if(d&&b(s,i.base[u]))return;a(s)&&!Object.isFrozen(s)&&v(s,f)}d&&e.onAssign&&e.onAssign(i,u,s)};return v(t,f),t};var J=new B,U=J.produce,Y=J.produceWithPatches.bind(J),Q=J.setAutoFreeze.bind(J),H=J.setUseProxies.bind(J),W=J.applyPatches.bind(J),$=J.createDraft.bind(J),K=J.finishDraft.bind(J);r.default=U}.call(r,n(103))},2499:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.createOperator=function(t,r,n){return{action:t,attributes:r&&function(t){var r={};for(var n in t)if(t.hasOwnProperty(n)){var e=t[n];void 0!==e&&(r[n]=e)}return r}(r),data:n}}},2500:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parse=JSON.parse,r.stringify=JSON.stringify},2501:function(t,r,n){"use strict";var e=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},i=this&&this.c||function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(e(arguments[r]));return t},o=this&&this.p||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0});var u=o(n(2125)),c=n(2126);r.log=function(t){return u.default(t)},r.createLoggingDecorator=function(t,n){void 0===n&&(n=null);var e=r.log(t);return c.createDecorator({onCalled:function(t){e.apply(void 0,i(t))},onReturned:function(t){e(t)},onError:function(t){e(" <ERROR> ")}})},r.logObject=function(t,r){var n={},e=function(t){return n[t]||(n[t]=u.default(r+":"+t)),n[t]},o=c.decorateObject(t,{onCalled:function(t,r){e(r).apply(void 0,i(t))},onReturned:function(t,r,n){e(n)(t)},onError:function(t,r,n){e(n)(" <ERROR> ")}});if("undefined"!=typeof window){var a=window;a.logged||(a.logged={}),a.logged[r]=t}return o}},2502:function(t,r,n){t.exports=function(t){function r(t){for(var r=0,n=0;n<t.length;n++)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}function e(t){var n;function u(){var t=Array.prototype.slice.call(arguments);if(u.enabled){var r=u,i=Number(new Date),o=i-(n||i);r.diff=o,r.prev=n,r.curr=i,n=i,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var c=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,function(n,i){if("%%"===n)return n;c++;var o=e.formatters[i];if("function"==typeof o){var u=t[c];n=o.call(r,u),t.splice(c,1),c--}return n}),e.formatArgs.call(r,t),(r.log||e.log).apply(r,t)}}return u.namespace=t,u.enabled=e.enabled(t),u.useColors=e.useColors(),u.color=r(t),u.destroy=i,u.extend=o,"function"==typeof e.init&&e.init(u),e.instances.push(u),u}function i(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}function o(t,r){var n=e(this.namespace+(void 0===r?":":r)+t);return n.log=this.log,n}function u(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){var t=e.names.map(u).concat(e.skips.map(u).map(function(t){return"-"+t})).join(",");return e.enable(""),t},e.enable=function(t){var r;e.save(t),e.names=[],e.skips=[];var n=("string"==typeof t?t:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(t=n[r].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(r=0;r<e.instances.length;r++){var o=e.instances[r];o.enabled=e.enabled(o.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var r,n;for(r=0,n=e.skips.length;r<n;r++)if(e.skips[r].test(t))return!1;for(r=0,n=e.names.length;r<n;r++)if(e.names[r].test(t))return!0;return!1},e.humanize=n(2503),Object.keys(t).forEach(function(r){e[r]=t[r]}),e.instances=[],e.names=[],e.skips=[],e.formatters={},e.selectColor=r,e.enable(e.load()),e}},2503:function(t,r){var n=1e3,e=60*n,i=60*e,o=24*i,u=7*o,c=365.25*o;function a(t,r,n,e){var i=r>=1.5*n;return Math.round(t/n)+" "+e+(i?"s":"")}t.exports=function(t,r){r=r||{};var f=typeof t;if("string"===f&&t.length>0)return function(t){if((t=String(t)).length>100)return;var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!r)return;var a=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*c;case"weeks":case"week":case"w":return a*u;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*i;case"minutes":case"minute":case"mins":case"min":case"m":return a*e;case"seconds":case"second":case"secs":case"sec":case"s":return a*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(t);if("number"===f&&isFinite(t))return r.long?function(t){var r=Math.abs(t);if(r>=o)return a(t,r,o,"day");if(r>=i)return a(t,r,i,"hour");if(r>=e)return a(t,r,e,"minute");if(r>=n)return a(t,r,n,"second");return t+" ms"}(t):function(t){var r=Math.abs(t);if(r>=o)return Math.round(t/o)+"d";if(r>=i)return Math.round(t/i)+"h";if(r>=e)return Math.round(t/e)+"m";if(r>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},2504:function(t,r,n){"use strict";var e=this&&this.r||function(t,r,n,e){return new(n||(n=Promise))(function(i,o){function u(t){try{a(e.next(t))}catch(t){o(t)}}function c(t){try{a(e.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new n(function(r){r(t.value)}).then(u,c)}a((e=e.apply(t,r||[])).next())})},i=this&&this.i||function(t,r){var n,e,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,e&&(i=2&o[0]?e.return:o[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,o[1])).done)return i;switch(e=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,e=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=r.call(t,u)}catch(t){o=[6,t],e=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},o=this&&this.p||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0});var u=o(n(102));r.ajax={request:function(t,r){var n=r.method,o=r.data,c=r.extract,a=void 0===c?function(t){return t.data}:c;return e(this,void 0,void 0,function(){var r;return i(this,function(e){switch(e.label){case 0:return"get"!==n.toLowerCase()?[3,2]:[4,u.default.request({url:t,method:n,params:o})];case 1:return r=e.sent(),[2,a(r)];case 2:return[4,u.default.request({url:t,method:n,data:o})];case 3:return r=e.sent(),[2,a(r)]}})})}}},2505:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(2506);r.isDeepEqual=function(t,n,i){var o=(void 0===i?{ignoreEmptyKey:!1}:i).ignoreEmptyKey;if(t===n)return!0;var u=e.type(t);if(u!==e.type(n))return!1;if("array"===u)return t.length===n.length&&t.every(function(t,e){return r.isDeepEqual(t,n[e],{ignoreEmptyKey:o})});if(t instanceof Date&&n instanceof Date)return t.getTime()===n.getTime();if("object"===u){var c=Object.keys(t).sort().filter(function(r){return!(void 0===t[r]&&o)}),a=Object.keys(n).sort().filter(function(t){return!(void 0===n[t]&&o)});return c.length===a.length&&c.every(function(e,i){var u=a[i];return e===u&&r.isDeepEqual(t[e],n[u],{ignoreEmptyKey:o})})}return!("number"!=typeof t||!isNaN(t))||t===n}},2506:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.type=function(t){return null===t?"null":void 0===t?"undefined":Array.isArray(t)?"array":typeof t}},2507:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(1).getS18n("lizard-service-form");r.text={type:"text",typeName:e("单行文本"),shortTypeName:e("单行"),tableViewMode:!0,initQuestion:function(){return{}},initResponse:function(){return{content:""}},verify:function(t,r){},isFilled:function(t,r){return Boolean(r&&r.content.trim().length>0)},getResponseText:function(t,r){return null==r?"":r.content.trim()},acceptTypes:{multiple_text:function(t){var n=t,e=n.subject;return{type:"text",required:n.required,guid:n.guid,subject:e,question:r.text.initQuestion(),response:r.text.initResponse()}}}}},2508:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(1).getS18n("lizard-service-form"),i="multiple_text";r.multipleText={type:i,typeName:e("多行文本"),shortTypeName:e("多行"),tableViewMode:!0,initQuestion:function(){return{}},initResponse:function(){return{content:""}},verify:function(t,r){},isFilled:function(t,r){return Boolean(r&&r.content.trim().length>0)},getResponseText:function(t,r){return null==r?"":r.content.trim()},acceptTypes:{text:function(t){var n=t,e=n.subject,o=n.required,u=n.guid,c=r.multipleText.initQuestion(),a=r.multipleText.initResponse();return{type:i,required:o,guid:u,subject:e,question:c,response:a}}}}},2509:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(1).getS18n("lizard-service-form");r.address={type:"address",typeName:e("地址"),shortTypeName:e("地址"),tableViewMode:!1,initQuestion:function(){return{}},initResponse:function(){return{province:void 0,city:void 0,district:void 0,detail:""}},verify:function(t,r){},isFilled:function(t,r){return Boolean(r&&r.province&&r.detail)},getResponseText:function(t,r){if(!r)return"";var n=r.province,e=r.city,i=r.district,o=r.detail;return(n?n.name:"")+" "+(e?e.name:"")+" "+(i?i.name:"")+" "+o},acceptTypes:{}}},2510:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(1).getS18n("lizard-service-form"),i=n(1972),o=n(2127);r.date={type:"date",typeName:e("日期"),shortTypeName:e("日期"),tableViewMode:!0,initQuestion:function(){return{format:"YMD"}},initResponse:function(){return{format:"YMD",date:void 0}},verify:function(t,r){},isFilled:function(t,r){return Boolean(r&&void 0!==r.date)},getResponseText:function(t,r,n){var e=n.exportSpread;if(!r)return"";var u=r.date;if(!u)return"";var c=(new Date).getTimezoneOffset()/-60;e&&(u=new Date(u.getTime()+60*(8-c)*60*1e3));var a=t.format;switch(a){case"YMD":return o.formatTime(u,"YYYY/MM/DD");case"YM":return o.formatTime(u,"YYYY/MM");case"YMDmh":return o.formatTime(u,"YYYY/MM/DD hh:mm");default:return i.assertNever(a)}},acceptTypes:{}}},2511:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(1).getS18n("lizard-service-form");r.name={type:"name",typeName:e("姓名"),shortTypeName:e("姓名"),tableViewMode:!0,initSubject:function(){return e("姓名")},initQuestion:function(){return{}},initResponse:function(){return{content:""}},verify:function(t,r){},isFilled:function(t,r){return Boolean(r&&r.content.trim().length>0)},getResponseText:function(t,r){return null==r?"":r.content.trim()},acceptTypes:{}}},2512:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(1).getS18n("lizard-service-form");r.email={type:"email",typeName:e("邮箱"),shortTypeName:e("邮箱"),tableViewMode:!0,initSubject:function(){return e("邮箱")},initQuestion:function(){return{}},initResponse:function(){return{content:""}},verify:function(t,r){if(r.content&&!/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(r.content))return{reason:e("邮箱格式不正确")}},isFilled:function(t,r){return Boolean(r&&r.content.trim().length>0)},getResponseText:function(t,r){return null==r?"":r.content.trim()},acceptTypes:{}}},2513:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(1).getS18n("lizard-service-form");r.phone={type:"phone",typeName:e("电话"),shortTypeName:e("电话"),tableViewMode:!0,initSubject:function(){return e("电话")},initQuestion:function(){return{}},initResponse:function(){return{content:""}},verify:function(t,r){if(r.content&&!/^[0-9-+()]+$/.test(r.content))return{reason:e("号码格式不正确")}},isFilled:function(t,r){return Boolean(r&&r.content.trim().length>0)},getResponseText:function(t,r){return null==r?"":r.content.trim()},acceptTypes:{}}},2514:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(1).getS18n("lizard-service-form");r.rate={type:"rate",typeName:e("评分"),shortTypeName:e("评分"),tableViewMode:!1,initQuestion:function(){return{shape:"star",sum:5}},initResponse:function(){return{shape:"star",sum:5,value:0}},verify:function(t,r){},isFilled:function(t,r){return Boolean(r&&r.value>0)},acceptTypes:{},getResponseText:function(t,r){if(!r)return"";return String(5===t.sum?r.value/2:r.value)}}},2515:function(t,r,n){"use strict";var e=this&&this.l||function(t,r){return Object.defineProperty?Object.defineProperty(t,"raw",{value:r}):t.raw=r,t};Object.defineProperty(r,"__esModule",{value:!0});var i,o,u=n(1).getS18n("lizard-service-form"),c=n(2070),a=n(2031),f=n(2008),s="dropdown_list";r.dropdownList={type:s,typeName:u("下拉列表"),shortTypeName:u("列表"),tableViewMode:!0,acceptTypes:{single_choice:function(t){var n=t,e=n.subject,i=n.required,o=n.question,u=n.guid,c=r.dropdownList.initResponse(),a=o.options;return{type:s,required:i,guid:u,subject:e,question:{options:a},response:c}},multiple_choice:function(t){var n=t,e=n.subject,i=n.required,o=n.question,u=n.guid,c=r.dropdownList.initResponse(),a=o.options;return{type:s,required:i,guid:u,subject:e,question:{options:a},response:c}}},initQuestion:function(){return{options:[{type:"normal",value:a.generateId(5),label:""}]}},initResponse:function(){return{choice:void 0}},verify:function(t,r){if(t.options.some(function(t){return"other"===t.type})){var n=t.options.find(function(t){return"other"===t.type});if(n&&"other"===n.type&&n.required&&r&&r.choice&&"other"===r.choice.type&&!r.choice.value)return{reason:u(i||(i=e(["请填写'其他'项内容"],["请填写'其他'项内容"])))}}},isFilled:function(t,r){return Boolean(r&&null!=r.choice)},fillWithDefaultQuestion:function(t){return f.produce(t,function(t){t&&t.options.length>0&&t.options.map(function(t,r){"normal"===t.type&&""===t.label.trim()&&(t.label=u(o||(o=e(["选项",""],["选项",""])),r+1))})})},getResponseText:function(t,r){return c.getChoiceResponseText(t,r)}}},2516:function(t,r,n){"use strict";var e=this&&this.l||function(t,r){return Object.defineProperty?Object.defineProperty(t,"raw",{value:r}):t.raw=r,t};Object.defineProperty(r,"__esModule",{value:!0});var i,o,u,c,a,f,s,l=n(1).getS18n("lizard-service-form"),d=n(2031),v=n(2008),h=n(2070),m="multiple_choice";r.getCountLimit=function(t){var r=t.options,n=t.limitCount,e=t.minCount,i=t.maxCount,o=r.length;if(n){var u=null==e?void 0:Math.max(1,Math.round(e)),c=null==i?void 0:Math.max(1,Math.round(i));if((null!=u||null!=c)&&!(null!=u&&null!=c&&u>c||null!=u&&u>o))return{min:u,max:c}}},r.getLimitSettingHint=function(t){var r=t.question,n=r.options,e=r.minCount,i=r.maxCount;return r.limitCount?null!=e&&null!=i&&e>i?l("限定的选项数设置有误"):null!=e&&e>n.length?l("限定的选项数设置有误"):"":""},r.getCountLimitHint=function(t,r){void 0===r&&(r=!1);var n=t.min,f=t.max,s="";return null!=n&&null!=f?s=n===f?l(i||(i=e(["选择 "," 项"],["选择 "," 项"])),n):l(r?o||(o=e(["最少选择 "," 项，最多选择 "," 项"],["最少选择 "," 项，最多选择 "," 项"])):u||(u=e(["选择 "," - "," 项"],["选择 "," - "," 项"])),n,f):null!=n?s=l(c||(c=e(["最少选择 "," 项"],["最少选择 "," 项"])),n):null!=f&&(s=l(a||(a=e(["最多选择 "," 项"],["最多选择 "," 项"])),f)),s},r.multipleChoice={type:m,typeName:l("多选"),shortTypeName:l("多选"),tableViewMode:!0,acceptTypes:{single_choice:function(t){var n=t,e=n.subject,i=n.required,o=n.question,u=n.guid,c=r.multipleChoice.initResponse(),a=o.options;return{type:m,required:i,guid:u,subject:e,question:{options:a},response:c}},dropdown_list:function(t){var n=t,e=n.subject,i=n.required,o=n.question,u=n.guid,c=r.multipleChoice.initResponse(),a=o.options;return{type:m,required:i,guid:u,subject:e,question:{options:a},response:c}}},initQuestion:function(){return{options:[{type:"normal",value:d.generateId(5),label:""}],limitCount:!1}},initResponse:function(){return{choices:[]}},verify:function(t,n){if(t.options.some(function(t){return"other"===t.type})){var i=t.options.find(function(t){return"other"===t.type});if(i&&"other"===i.type&&i.required){var o=n.choices.find(function(t){return"other"===t.type});if(o&&"other"===o.type&&!o.value)return{reason:l(f||(f=e(["请填写'其他'项内容"],["请填写'其他'项内容"])))}}}var u=r.getCountLimit(t);if(u){var c=u.min,a=u.max,s=n.choices.length;if(null!=c&&s<c||null!=a&&s>a)return{reason:r.getCountLimitHint(u,!0)}}},isFilled:function(t,r){return Boolean(r&&r.choices.length>0)},fillWithDefaultQuestion:function(t){return v.produce(t,function(t){t&&t.options.length>0&&t.options.map(function(t,r){"normal"===t.type&&""===t.label.trim()&&(t.label=l(s||(s=e(["选项",""],["选项",""])),r+1))})})},getResponseText:function(t,r){return h.getChoiceResponseText(t,r)}}},2517:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(1).getS18n("lizard-service-form");r.number={type:"number",typeName:e("数字"),shortTypeName:e("数字"),tableViewMode:!0,initQuestion:function(){return{}},initResponse:function(){return{number:void 0}},verify:function(t,r){},isFilled:function(t,r){return Boolean(r&&void 0!==r.number)},getResponseText:function(t,r){if(!r)return"";var n=r.number;return String(n)},acceptTypes:{}}},2518:function(t,r,n){"use strict";var e=this&&this.l||function(t,r){return Object.defineProperty?Object.defineProperty(t,"raw",{value:r}):t.raw=r,t};Object.defineProperty(r,"__esModule",{value:!0});var i,o,u=n(1).getS18n("lizard-service-form"),c=n(2031),a=n(2008),f=n(2070),s="single_choice";r.singleChoice={type:s,typeName:u("单选"),shortTypeName:u("单选"),tableViewMode:!1,acceptTypes:{multiple_choice:function(t){var n=t,e=n.subject,i=n.required,o=n.question,u=n.guid,c=r.singleChoice.initResponse(),a=o.options;return{type:s,required:i,guid:u,subject:e,question:{options:a},response:c}},dropdown_list:function(t){var n=t,e=n.subject,i=n.required,o=n.question,u=n.guid,c=r.singleChoice.initResponse(),a=o.options;return{type:s,required:i,guid:u,subject:e,question:{options:a},response:c}}},initQuestion:function(){return{options:[{type:"normal",value:c.generateId(5),label:""}]}},initResponse:function(){return{choice:void 0}},verify:function(t,r){if(t.options.some(function(t){return"other"===t.type})){var n=t.options.find(function(t){return"other"===t.type});if(n&&"other"===n.type&&n.required&&r&&r.choice&&"other"===r.choice.type&&!r.choice.value)return{reason:u(i||(i=e(["请填写'其他'项内容"],["请填写'其他'项内容"])))}}},isFilled:function(t,r){return Boolean(r&&null!=r.choice)},fillWithDefaultQuestion:function(t){return a.produce(t,function(t){t&&t.options.length>0&&t.options.map(function(t,r){"normal"===t.type&&""===t.label.trim()&&(t.label=u(o||(o=e(["选项",""],["选项",""])),r+1))})})},getResponseText:function(t,r){return f.getChoiceResponseText(t,r)}}},2519:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(1).getS18n("lizard-service-form"),i=n(1972),o=n(2127);r.time={type:"time",typeName:e("时间"),shortTypeName:e("时间"),tableViewMode:!0,initQuestion:function(){return{format:"hms"}},initResponse:function(){return{format:"hms",time:void 0}},verify:function(t,r){},isFilled:function(t,r){return Boolean(r&&void 0!==r.time)},getResponseText:function(t,r,n){var e=n.exportSpread;if(!r)return"";var u=r.time;if(!u)return"";var c=(new Date).getTimezoneOffset()/-60;e&&(u=new Date(u.getTime()+60*(8-c)*60*1e3));var a=t.format;switch(a){case"hms":return o.formatTime(u,"hh:mm:ss");case"hm":return o.formatTime(u,"hh:mm");default:return i.assertNever(a)}},acceptTypes:{}}},2520:function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(1).getS18n("lizard-service-form");r.image={type:"image",typeName:e("图片收集"),shortTypeName:e("图片"),tableViewMode:!0,initQuestion:function(){return{}},initResponse:function(){return{image:void 0}},verify:function(t,r){},isFilled:function(t,r){return Boolean(r&&r.image)},getResponseText:function(t,r){return r&&r.image?""+r.image.url:""},acceptTypes:{}}},2521:function(t,r,n){(function(t){var e=Object.getOwnPropertyDescriptors||function(t){for(var r=Object.keys(t),n={},e=0;e<r.length;e++)n[r[e]]=Object.getOwnPropertyDescriptor(t,r[e]);return n},i=/%[sdj%]/g;r.format=function(t){if(!p(t)){for(var r=[],n=0;n<arguments.length;n++)r.push(c(arguments[n]));return r.join(" ")}n=1;for(var e=arguments,o=e.length,u=String(t).replace(i,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(e[n++]);case"%d":return Number(e[n++]);case"%j":try{return JSON.stringify(e[n++])}catch(t){return"[Circular]"}default:return t}}),a=e[n];n<o;a=e[++n])m(a)||!g(a)?u+=" "+a:u+=" "+c(a);return u},r.deprecate=function(n,e){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return r.deprecate(n,e).apply(this,arguments)};var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(e);t.traceDeprecation,i=!0}return n.apply(this,arguments)}};var o,u={};function c(t,n){var e={seen:[],stylize:f};return arguments.length>=3&&(e.depth=arguments[2]),arguments.length>=4&&(e.colors=arguments[3]),h(n)?e.showHidden=n:n&&r._extend(e,n),y(e.showHidden)&&(e.showHidden=!1),y(e.depth)&&(e.depth=2),y(e.colors)&&(e.colors=!1),y(e.customInspect)&&(e.customInspect=!0),e.colors&&(e.stylize=a),s(e,t,e.depth)}function a(t,r){var n=c.styles[r];return n?"["+c.colors[n][0]+"m"+t+"["+c.colors[n][1]+"m":t}function f(t,r){return t}function s(t,n,e){if(t.customInspect&&n&&_(n.inspect)&&n.inspect!==r.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(e,t);return p(i)||(i=s(t,i,e)),i}var o=function(t,r){if(y(r))return t.stylize("undefined","undefined");if(p(r)){var n="'"+JSON.stringify(r).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(b(r))return t.stylize(""+r,"number");if(h(r))return t.stylize(""+r,"boolean");if(m(r))return t.stylize("null","null")}(t,n);if(o)return o;var u=Object.keys(n),c=function(t){var r={};return t.forEach(function(t,n){r[t]=!0}),r}(u);if(t.showHidden&&(u=Object.getOwnPropertyNames(n)),j(n)&&(u.indexOf("message")>=0||u.indexOf("description")>=0))return l(n);if(0===u.length){if(_(n)){var a=n.name?": "+n.name:"";return t.stylize("[Function"+a+"]","special")}if(w(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(O(n))return t.stylize(Date.prototype.toString.call(n),"date");if(j(n))return l(n)}var f,g="",S=!1,E=["{","}"];(v(n)&&(S=!0,E=["[","]"]),_(n))&&(g=" [Function"+(n.name?": "+n.name:"")+"]");return w(n)&&(g=" "+RegExp.prototype.toString.call(n)),O(n)&&(g=" "+Date.prototype.toUTCString.call(n)),j(n)&&(g=" "+l(n)),0!==u.length||S&&0!=n.length?e<0?w(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),f=S?function(t,r,n,e,i){for(var o=[],u=0,c=r.length;u<c;++u)C(r,String(u))?o.push(d(t,r,n,e,String(u),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(d(t,r,n,e,i,!0))}),o}(t,n,e,c,u):u.map(function(r){return d(t,n,e,c,r,S)}),t.seen.pop(),function(t,r,n){if(t.reduce(function(t,r){return 0,r.indexOf("\n")>=0&&0,t+r.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===r?"":r+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+r+" "+t.join(", ")+" "+n[1]}(f,g,E)):E[0]+g+E[1]}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,r,n,e,i,o){var u,c,a;if((a=Object.getOwnPropertyDescriptor(r,i)||{value:r[i]}).get?c=a.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):a.set&&(c=t.stylize("[Setter]","special")),C(e,i)||(u="["+i+"]"),c||(t.seen.indexOf(a.value)<0?(c=m(n)?s(t,a.value,null):s(t,a.value,n-1)).indexOf("\n")>-1&&(c=o?c.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+c.split("\n").map(function(t){return"   "+t}).join("\n")):c=t.stylize("[Circular]","special")),y(u)){if(o&&i.match(/^\d+$/))return c;(u=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(u=u.substr(1,u.length-2),u=t.stylize(u,"name")):(u=u.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),u=t.stylize(u,"string"))}return u+": "+c}function v(t){return Array.isArray(t)}function h(t){return"boolean"==typeof t}function m(t){return null===t}function b(t){return"number"==typeof t}function p(t){return"string"==typeof t}function y(t){return void 0===t}function w(t){return g(t)&&"[object RegExp]"===S(t)}function g(t){return"object"==typeof t&&null!==t}function O(t){return g(t)&&"[object Date]"===S(t)}function j(t){return g(t)&&("[object Error]"===S(t)||t instanceof Error)}function _(t){return"function"==typeof t}function S(t){return Object.prototype.toString.call(t)}r.debuglog=function(n){if(y(o)&&(o=Object({NODE_ENV:"production",HOST:"shimo_im",VERSION:"pro[baaa439]",BRANCH:"pro",COMMIT:"baaa439",GC_VERSION:"baaa439",SDK:!1}).NODE_DEBUG||""),n=n.toUpperCase(),!u[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){t.pid;u[n]=function(){r.format.apply(r,arguments)}}else u[n]=function(){};return u[n]},r.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=v,r.isBoolean=h,r.isNull=m,r.isNullOrUndefined=function(t){return null==t},r.isNumber=b,r.isString=p,r.isSymbol=function(t){return"symbol"==typeof t},r.isUndefined=y,r.isRegExp=w,r.isObject=g,r.isDate=O,r.isError=j,r.isFunction=_,r.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},r.isBuffer=n(2522);function C(t,r){return Object.prototype.hasOwnProperty.call(t,r)}r.log=function(){},r.inherits=n(2523),r._extend=function(t,r){if(!r||!g(r))return t;for(var n=Object.keys(r),e=n.length;e--;)t[n[e]]=r[n[e]];return t};var E="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function I(t,r){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return r(t)}r.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(E&&t[E]){var r;if("function"!=typeof(r=t[E]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(r,E,{value:r,enumerable:!1,writable:!1,configurable:!0}),r}function r(){for(var r,n,e=new Promise(function(t,e){r=t,n=e}),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push(function(t,e){t?n(t):r(e)});try{t.apply(this,i)}catch(t){n(t)}return e}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),E&&Object.defineProperty(r,E,{value:r,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(r,e(t))},r.promisify.custom=E,r.callbackify=function(r){if("function"!=typeof r)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],e=0;e<arguments.length;e++)n.push(arguments[e]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,u=function(){return i.apply(o,arguments)};r.apply(this,n).then(function(r){t.nextTick(u,null,r)},function(r){t.nextTick(I,r,u)})}return Object.setPrototypeOf(n,Object.getPrototypeOf(r)),Object.defineProperties(n,e(r)),n}}).call(r,n(103))},2522:function(t,r){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},2523:function(t,r){"function"==typeof Object.create?t.exports=function(t,r){t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,r){t.super_=r;var n=function(){};n.prototype=r.prototype,t.prototype=new n,t.prototype.constructor=t}},2524:function(t,r,n){"use strict";var e=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},i=this&&this.s||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r};Object.defineProperty(r,"__esModule",{value:!0});var o=n(1).getS18n("lizard-service-form"),u=i(n(150)),c=i(n(64)),a=n(2005),f=n(2006),s=function(t){return t.map(function(t){return"number"==typeof t.data?t.data:1}).reduce(function(t,r){return t+r},0)};r.ensureChannelColumnModoc=function(t,r,n){var i=a.getModocOperators(t),c=i.map(function(t){return t.getAttributes()||{}}).findIndex(function(t){return t.formGuid===r});if(-1===c)throw new Error(o("找不到指定的表单工作表"));var f=i[c],l=e(f.getParsedData(),2),d=(l[0],l[1].toJSON()),v=d.map(function(t){return(t.attributes||{}).formItemGuid});if(!v.some(function(t){return t===a.CHANNEL})){var h=v.findIndex(function(t){return t===a.CREATE_BY});h<0&&(h=v.findIndex(function(t){return t===a.CREATE_AT}));var m=-1===h?0:s(d.slice(0,h+1)),b=m?{action:"retain",attributes:{},data:m}:void 0,p={action:"insert",attributes:{formItemGuid:a.CHANNEL},data:{delta:[{action:"retain",attributes:{color:"#ffffff",userId:n,authorId:n,background:"#41464b",format:"@",cellValue:o("数据来源")},data:1}]}},y=0===c?void 0:{action:"retain",attributes:{},data:c},w={action:"retain",attributes:{userId:n,authorId:n},data:{table:{cols:b?[b,p]:[p]}}},g=y?[y,w]:[w];return new u.Delta(g)}},r.ensureChannelColumnRichdoc=function(t,r,n){var e,i=t.ops,u=i.map(function(t){return t.getAttributes()||{}}).findIndex(function(t){return t.formGuid===r});if(-1===u)throw new Error(o("找不到指定的表单工作表"));var l=i[u].data,d=l.cols,v=(l.rows,d.ops),h=v.map(function(t){return(t.getAttributes()||{}).formItemGuid});if(!h.some(function(t){return t===a.CHANNEL})){var m=h.findIndex(function(t){return t===a.CREATE_BY});m<0&&(m=h.findIndex(function(t){return t===a.CREATE_AT}));var b=-1===m?0:s(v.slice(0,m+1)),p=b?new c.Operator({action:"retain",attributes:{},data:b}):void 0,y=((e={})[f.toCellName(0,b)]=new c.CellOperator(a.createTextCellOp(o("数据来源"),n,{color:"#ffffff",background:"#41464b",format:"@"})),e),w=new c.Operator({action:"insert",attributes:{formItemGuid:a.CHANNEL},data:1}),g=p?[p,w]:[w],O=0===u?void 0:new c.TableOperator({action:"retain",attributes:{},data:u}),j=new c.TableOperator({action:"retain",attributes:{userId:n,authorId:n},data:{cols:new c.Delta(g),cells:y}}),_=O?[O,j]:[j];return new c.Delta(_)}}},2525:function(t,r,n){"use strict";var e=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},i=this&&this.c||function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(e(arguments[r]));return t},o=this&&this.s||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r};Object.defineProperty(r,"__esModule",{value:!0});var u=n(1).getS18n("lizard-service-form"),c=n(2005),a=o(n(150)),f=o(n(64)),s=n(1972),l=n(1972),d=n(2006),v=n(2007),h=n(2131);r.avoidConfict=function(t,r){if(-1===r.indexOf(t))return t;for(var n=1;-1!==r.indexOf(t+" "+n);)n++;return t+" "+n};var m=function(t){return{action:"retain",attributes:{color:"#ffffff",userId:t,authorId:t,background:"#41464b",format:"@",cellValue:u("填写时间")},data:1}},b=function(t){return{action:"retain",attributes:{color:"#ffffff",userId:t,authorId:t,background:"#41464b",format:"@",cellValue:u("填写人")},data:1}},p=function(t){return{action:"retain",attributes:{color:"#ffffff",userId:t,authorId:t,background:"#41464b",format:"@"},data:1}};r.createChangeForCreateForm=function(t){var n=t.fileType,e=t.spread,o=t.formGuid,y=t.sheetGuid,w=t.sheetTitle,g=void 0===w?v.FORM_DEFAULT_TITLE:w,O=t.userId,j=t.questions;switch(n){case"modoc":return function(t){var n=t.spread,e=t.formGuid,o=t.sheetGuid,f=t.sheetTitle,s=t.userId,d=t.questions,v=void 0===d?[]:d;l.assert(a.Delta.isDelta(n),"spread should be modoc.Delta"),l.assert("string"==typeof e,"formGuid should be string"),l.assert(s,"userId is not provided");for(var y=[],w=n.getIter();w.hasNext();)y.push(w.next());var g=y.map(function(t){return t.getAttributes()||{}}),O=g.map(function(t){return t.name||""}),j=g.map(function(t){return t.order||0}),_=Math.min.apply(Math,i(j)),S={action:"insert",attributes:{formItemGuid:c.CREATE_AT,width:135},data:{delta:[m(s)]}},C={action:"insert",attributes:{formItemGuid:c.CREATE_BY},data:{delta:[b(s)]}},E={action:"insert",data:{delta:[p(s)]}},I=i([S,C],(v||[]).map(function(t){return{action:"insert",attributes:{formItemGuid:t.guid},data:{delta:[{action:"retain",attributes:{color:"#ffffff",userId:s,authorId:s,background:"#41464b",format:"@",cellValue:t.subject||u("未命名问题")},data:1}]}}}),h.arrayOf(Math.max(0,16-v.length)).map(function(){return E})),T={action:"retain",attributes:{},data:y.length},M={action:"insert",attributes:{id:o,name:r.avoidConfict(f,O),order:_-1,formGuid:e,formVersion:c.FORM_VERSION,fixedRowsTop:1,userId:s,authorId:s},data:{table:{rows:[{action:"insert",attributes:{height:30},data:1},{action:"insert",data:199}],cols:I}}};return new a.Delta([T,M]).stringify()}({spread:"string"==typeof e?new a.Delta(e):e,formGuid:o,questions:j,sheetGuid:y,sheetTitle:g,userId:O});case"richdoc":return function(t){var n=t.spread,e=t.formGuid,o=t.sheetGuid,u=t.sheetTitle,a=t.userId,s=t.questions,v=void 0===s?[]:s;l.assert(Array.isArray(n&&n.ops),"spread should be richdoc.Delta"),l.assert("string"==typeof e,"formGuid should be string"),l.assert(a,"userId is not provided");for(var y=[],w=n.getIter();w.hasNext();)y.push(w.next());var g=y.map(function(t){return t.getAttributes()||{}}),O=g.map(function(t){return t.name||""}),j=g.map(function(t){return t.order||0}),_=Math.min.apply(Math,i(j)),S=new f.Operator({action:"insert",attributes:{formItemGuid:c.CREATE_AT,width:135},data:1}),C=new f.Operator({action:"insert",attributes:{formItemGuid:c.CREATE_BY},data:1}),E=new f.Operator({action:"insert",attributes:{},data:1}),I=new f.Delta(i([S,C],v.map(function(t){return new f.Operator({action:"insert",attributes:{formItemGuid:t.guid},data:1})}),h.arrayOf(Math.max(0,16-v.length)).map(function(){return E}))),T=new f.Delta([new f.Operator({action:"insert",attributes:{height:30},data:1}),new f.Operator({action:"insert",attributes:{},data:199})]),M={};h.arrayOf(Math.max(18,2+v.length)).forEach(function(t,r){var n=d.toCellName(0,r),e=v[r-2];M[n]=0===r?new f.CellOperator(m(a)):1===r?new f.CellOperator(b(a)):e?new f.CellOperator(function(t,r){return{action:"retain",attributes:{"font-size":9,wrap:"text-no-wrap",format:"@",vertical:"middle",userId:t,authorId:t,cellValue:r.subject,color:"#ffffff",background:"#41464b"},data:1}}(a,e)):new f.CellOperator(p(a))});var F=new f.TableOperator({action:"retain",attributes:{},data:j.length}),k=new f.TableOperator({action:"insert",attributes:{id:o,name:r.avoidConfict(u,O),order:_-1,formGuid:e,formVersion:c.FORM_VERSION,fixedRowsTop:1,userId:a,authorId:a},data:{rows:T,cols:I,cells:M}}),x=new f.Delta([F,k]);return f.pack(x)}({spread:"string"==typeof e?f.unpack(e):e,formGuid:o,sheetGuid:y,sheetTitle:g,userId:O,questions:j});default:return s.assertNever(n)}}},2526:function(t,r,n){"use strict";var e=this&&this.u||function(t,r){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var e,i,o=n.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(e=o.next()).done;)u.push(e.value)}catch(t){i={error:t}}finally{try{e&&!e.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u},i=this&&this.c||function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(e(arguments[r]));return t};Object.defineProperty(r,"__esModule",{value:!0});var o=n(1).getS18n("lizard-service-form"),u=n(2007),c=n(150),a=n(2005),f=n(2029),s=n(2128),l=n(2131),d=n(2030);r.createChangeForCreateSpread=function(t){var r=t.form,n=t.formGuid,e=t.submissions,v=t.userId,h={};r.questions.forEach(function(t){h[t.guid]=t});var m=[{action:"insert",attributes:{height:30},data:1},{action:"insert",data:Math.max(199,e.length)}],b=e.some(function(t){return t.channel}),p=i([a.CREATE_AT,a.CREATE_BY],b?[a.CHANNEL]:[]),y=i(r.questions.map(function(t){return t.guid}),l.arrayOf(Math.max(0,18-(1+r.questions.length)))),w=i(p,y).map(function(t,n){if(!t)return{action:"insert",attributes:{},data:{delta:[{action:"retain",attributes:{color:"#ffffff",userId:v,authorId:v,background:"#41464b"},data:1}]}};var u={action:"retain",attributes:{color:"#ffffff",userId:v,authorId:v,background:"#41464b",format:"@",cellValue:t===a.CREATE_AT?o("填写时间"):t===a.CREATE_BY?o("填写人"):t===a.CHANNEL?o("数据来源"):h[t].subject||o("未命名问题")},data:1},c=e.map(d.fromServerSubmission).map(function(e){if(!e)return a.skipCellOp;if(t===a.CREATE_AT)return a.createTextCellOp(s.stringifyDate(e.createdAt),e.userId);if(t===a.CREATE_BY)return a.createTextCellOp(e.userName||"",e.userId);if(t===a.CHANNEL)return a.createTextCellOp(e.channel||"",e.userId);var i=n-p.length,o=r.questions[i],u=e.responses.find(function(t){return t.guid===o.guid&&f.isQuestionTypeCompatible(t.type,o.type)});return u?a.questionResponseToCellOp({question:o,response:u,userId:e.userId}):a.skipCellOp}),l=i([u],c);return{action:"insert",attributes:t===a.CREATE_AT?{formItemGuid:a.CREATE_AT,width:135}:t===a.CREATE_BY?{formItemGuid:a.CREATE_BY}:t===a.CHANNEL?{formItemGuid:a.CHANNEL}:{formItemGuid:t},data:{delta:l}}}),g=[{action:"insert",attributes:{id:a.DEFAULT_FORM_SHEET_ID,order:0,name:r.title||u.FORM_DEFAULT_TITLE,fixedRowsTop:1,formGuid:n,formVersion:a.FORM_VERSION,userId:v,authorId:v},data:{table:{rows:m,cols:w}}}];return new c.Delta(g).stringify()}},2527:function(t,r,n){"use strict";n.d(r,"a",function(){return u});var e=n(2528),i=this&&this.r||function(t,r,n,e){return new(n||(n=Promise))(function(i,o){function u(t){try{a(e.next(t))}catch(t){o(t)}}function c(t){try{a(e.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new n(function(r){r(t.value)}).then(u,c)}a((e=e.apply(t,r||[])).next())})},o=this&&this.i||function(t,r){var n,e,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,e&&(i=2&o[0]?e.return:o[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,o[1])).done)return i;switch(e=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,e=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=r.call(t,u)}catch(t){o=[6,t],e=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},u={fetchFile:function(t,r){var n=(void 0===r?{}:r).contentUrl,u=void 0!==n&&n;return i(this,void 0,Promise,function(){var r,n,i;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,e.a.request("/lizard-api/files/"+t,{method:"GET",data:{collaboratorCount:!0,contentUrl:u,creator:1,updateViews:!0},headers:{"Cache-Control":"no-cache"}})];case 1:return[2,o.sent()];case 2:if(r=o.sent(),(i=(n=r)&&n.response&&n.response.data)&&(60001===i.errorCode||60002===i.errorCode||/(不存在|被删除)/.test(i.error)))return[2,void 0];throw r;case 3:return[2]}})})},fetchFileAncestors:function(t){return i(this,void 0,Promise,function(){return o(this,function(r){switch(r.label){case 0:return[4,e.a.request("/lizard-api/files/"+t+"/ancestors",{method:"GET"})];case 1:return[2,r.sent().ancestors||[]]}})})},fetchFileContent:function(t){return i(this,void 0,Promise,function(){return o(this,function(r){switch(r.label){case 0:return[4,e.a.request(t.contentUrl,{method:"GET"})];case 1:return[2,r.sent()]}})})},createFile:function(t){return i(this,void 0,Promise,function(){return o(this,function(r){switch(r.label){case 0:return[4,e.a.request("/lizard-api/files",{method:"POST",data:t})];case 1:return[2,r.sent()]}})})}}},2528:function(t,r,n){"use strict";n.d(r,"a",function(){return c});var e=n(102),i=n.n(e),o=this&&this.r||function(t,r,n,e){return new(n||(n=Promise))(function(i,o){function u(t){try{a(e.next(t))}catch(t){o(t)}}function c(t){try{a(e.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new n(function(r){r(t.value)}).then(u,c)}a((e=e.apply(t,r||[])).next())})},u=this&&this.i||function(t,r){var n,e,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,e&&(i=2&o[0]?e.return:o[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,o[1])).done)return i;switch(e=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,e=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=r.call(t,u)}catch(t){o=[6,t],e=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},c={request:function(t,r){var n=r.method,e=r.data,c=r.headers,a=void 0===c?{}:c;return o(this,void 0,Promise,function(){return u(this,function(r){return"get"===n.toLowerCase()?[2,i.a.request({url:t,method:n,params:e,headers:a}).then(function(t){return t.data})]:[2,i.a.request({url:t,method:n,headers:a,data:e}).then(function(t){return t.data})]})})}}},2529:function(t,r,n){"use strict";r.a=function(t){void 0===t&&(t=5);for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",e=0;e<t;e++)n+=r.charAt(Math.floor(Math.random()*r.length));return n}},2530:function(t,r,n){"use strict";n.d(r,"a",function(){return o});var e=JSON.parse,i=JSON.stringify,o=function(t){return e(i(t))}},2531:function(t,r,n){"use strict";n.d(r,"a",function(){return u});var e=n(2125),i=n.n(e),o=n(2532),u=function(t,r){var n={},e=function(t){return n[t]||(n[t]=i()(r+":"+t)),n[t]},u=Object(o.b)(t,{onCalled:function(t,r){e(r).apply(void 0,t)},onReturned:function(t,r,n){e(n)(t)},onError:function(t,r,n){e(n)(" <ERROR> ")}});if("undefined"!=typeof window){var c=window;c.logged||(c.logged={}),c.logged[r]=t}return u}},2532:function(t,r,n){"use strict";r.a=o,r.b=function(t,r){for(var n in t){var i=t[n];if("constructor"!==n&&"function"==typeof i){var u=o(e({},r,{self:t,fnName:n}));t[n]=u(i)}}return t};var e=this&&this.o||function(){return(e=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)},i=function(t){return"function"==typeof(t&&t.then)};function o(t){var r=t.onCalled,n=t.onReturned,e=t.onError,o=t.fnName,u=t.self,c=void 0===u?null:u;return function(t){return function(){for(var u=[],a=0;a<arguments.length;a++)u[a]=arguments[a];r&&r(u,o||t.name);try{var f=t.apply(c,u);return i(f)?f.then(function(r){return n&&n(r,u,o||t.name),r},function(r){throw e&&e(r,u,o||t.name),r}):(n&&n(f,u,o||t.name),f)}catch(r){throw e&&e(r,u,o||t.name),r}}}}},2533:function(t,r,n){"use strict";n.d(r,"a",function(){return i}),n.d(r,"b",function(){return o});var e=n(3).sheets.track,i={menu:{create_form:"0100",share_form:"0101",unlink_form:"0102",create_form_dropdown:"0103",edit_form:"0114",publish_form:"0115"},create_dialog:{create_new:"0104",edit_draft:"0105"},form_editor:{create_form_click:"0106",create_form_success:"0107"},form_preview:{copy_link_click:"0108"},fill_page:{submit:"0109",enter:"0113"},guide:{view:"0110",dismiss:"0111",try_click:"0112"}},o=function(t){try{e(2,t)}catch(t){}}},2534:function(t,r,n){"use strict";r.a=function(t){var r=t.formController,n=function(){try{return/^(editor|owner)$/.test(window.D.Q.role)}catch(t){return!1}},e=function(t,n){return r.canReadForm(t,n)};return{tabList:{form:function(t){function i(e){var i=t.call(this,e)||this;return i.onCreateForm=function(){return p(i,void 0,Promise,function(){var t,e;return y(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),r.track(r.events.menu.create_form),n()?[4,r.createForm()]:(Object(u.showAlert)({title:o()("表格协作者才能创建表单"),type:"error"}),[2]);case 1:return i.sent(),[3,3];case 2:return t=i.sent(),e=t&&t.errmsg||o()("表单创建失败，请稍后重试"),Object(u.showAlert)({title:e,type:"error"}),[3,3];case 3:return[2]}})})},i.onCreateFormFromHeader=function(){return p(i,void 0,Promise,function(){return y(this,function(t){return r.ui.createFormPopup.show({sheetGuid:this.props.A.spread.B().id}),[2]})})},i.onSelectMenuItem=function(t){var n=i.state,e=n.formGuid,o=n.formVersion,u=t.value;switch(u){case"edit":r.track(r.events.menu.edit_form),o===d.a.V2&&Object(h.b)(h.a.sheet_edit_forms),e&&r.ui.openOrFocusPage("edit",e,o);break;case"unlink":o===d.a.V2&&Object(h.b)(h.a.sheet_unlink_form),r.track(r.events.menu.unlink_form),r.ui.confirmUnlinkForm();break;case"create":Object(h.b)(h.a.create_from_sheets),r.track(r.events.menu.create_form_dropdown),i.onCreateForm();break;case"create_from_header":i.onCreateFormFromHeader();break;case"responses":o===d.a.V2&&Object(h.b)(h.a.sheet_view_response),e&&o===d.a.V2&&r.ui.openOrFocusPage("responses",e,o);break;case"copy_link":o===d.a.V2&&Object(h.b)(h.a.sheet_copy_url),i.onCopyLink();break;case"statistics":o===d.a.V2&&Object(h.b)(h.a.sheet_view_statistics),e&&o===d.a.V2&&r.ui.openOrFocusPage("statistics",e,o);break;default:Object(v.a)(u)}t.trackId&&w(2,t.trackId)},i.onMenuOpen=function(){w(2,8016)},i.onSheetChanged=function(){var t=i.props.A.spread.B();if(t){var r=t.E,n=r.attrs,e=n.formGuid,o=n.formVersion;e===i.state.formGuid&&o===i.state.formVersion||i.setState({formGuid:e,formVersion:o})}else i.setState({formGuid:void 0,formVersion:void 0})},i.onCopyLink=function(){var t,n;try{var e=i.state,c=e.formGuid,a=e.formVersion;if(!c)throw new Error(o()("指定的表单不存在"));var f=r.getFillPageUrl(c,a);if(!f)throw new Error(o()("表单未发布"));t=f,(n=document.createElement("textarea")).value=t,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),Object(u.showAlert)({title:o()("表单链接复制成功")})}catch(t){Object(u.showAlert)({title:o()("表单链接复制失败"),type:"error"})}},i.rerender=function(){i.forceUpdate?i.forceUpdate():i.setState({})},i.state={formGuid:void 0,formVersion:void 0},i}return m(i,t),i.prototype.componentDidMount=function(){this.props.A.on(g.IV,this.onSheetChanged),this.props.A.on(g.AfterChangeApplied,this.onSheetChanged),this.props.A.isRendered?this.onSheetChanged():this.props.A.once(g.Rendered,this.onSheetChanged),r.on(l.a.FormChanged,this.rerender)},i.prototype.componentWillUnmount=function(){this.props.A.off(g.IV,this.onSheetChanged),this.props.A.off(g.AfterChangeApplied,this.onSheetChanged),this.props.A.off(g.Rendered,this.onSheetChanged),r.off(l.a.FormChanged,this.rerender)},i.prototype.shouldComponentUpdate=function(t,r){return this.props.permission.U!==t.permission.U||this.state.formGuid!==r.formGuid||this.state.formVersion!==r.formVersion},i.prototype.render=function(){var t,i=this,u=this.state,c=u.formGuid,a=u.formVersion,l=O().menuItems.form.map(function(t){return function(t,i,u){var c=t.value;switch(c){case"create":var a="form_create";return n()?b({},t,{icon:a}):b({},t,{icon:a,disabled:!0,disabledTip:""});case"create_from_header":var a="";return n()?b({},t,{icon:a}):b({},t,{icon:a,disabled:!0,disabledTip:""});case"edit":var a="form_edit";return i?e(i,u)?b({},t,{icon:a}):b({},t,{icon:a,disabled:!0,disabledTip:o()("暂无权限访问该表单，请联系该表单的所有者")}):b({},t,{icon:a,disabled:!0,disabledTip:""});case"unlink":var a="form_unlink",f=u===d.a.V2?o()("取消关联表单"):o()("停用表单");return i?n()?b({},t,{display:f,icon:a}):b({},t,{display:f,icon:a,disabled:!0,disabledTip:o()("暂无权限取消关联表单")}):b({},t,{display:f,icon:a,disabled:!0,disabledTip:""});case"responses":var a="form_responses";return u!==d.a.V2?b({},t,{icon:a,hidden:!0}):i?e(i,u)?b({},t,{icon:a}):b({},t,{icon:a,disabled:!0,disabledTip:o()("暂无权限访问该表单，请联系该表单的所有者")}):b({},t,{icon:a,disabled:!0,disabledTip:""});case"copy_link":var a="form_copy_link";return i&&r.isFormPublished(i,u)?b({},t,{icon:a}):b({},t,{icon:a,disabled:!0,disabledTip:""});case"statistics":var a="form_statistics";return u!==d.a.V2?b({},t,{icon:a,hidden:!0}):i?e(i,u)?b({},t,{icon:a}):b({},t,{icon:a,disabled:!0,disabledTip:o()("暂无权限访问该表单，请联系该表单的所有者")}):b({},t,{icon:a,disabled:!0,disabledTip:""});default:return Object(v.a)(c)}}(t,c,a)}).map(function(t,r){return t.hidden?[]:[f.a.createElement("div",{className:"tooltip--docker",key:r},f.a.createElement(s.e,{icon:t.icon,text:t.display,disabled:t.disabled&&"fake",onTap:function(){return i.onSelectMenuItem(t)}}),t.disabled&&t.disabledTip&&f.a.createElement(s.k,{option:t.disabledTip,direction:"left"})),"divider"===t.type&&f.a.createElement(s.d,{key:"d"+r})].filter(Boolean)}),h=(t=[]).concat.apply(t,l);return f.a.createElement(s.h,{disabled:!this.props.permission.U,RW:function(){return o()("表单")},onOpen:this.onMenuOpen},function(){return h})},i}(f.a.Component)}}};var e,i=n(1),o=n.n(i),u=n(780),c=(n.n(u),n(3)),a=n(0),f=n.n(a),s=n(49),l=n(2049),d=n(784),v=n(792),h=n(797),m=this&&this.t||(e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(t,r)},function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),b=this&&this.o||function(){return(b=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)},p=this&&this.r||function(t,r,n,e){return new(n||(n=Promise))(function(i,o){function u(t){try{a(e.next(t))}catch(t){o(t)}}function c(t){try{a(e.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new n(function(r){r(t.value)}).then(u,c)}a((e=e.apply(t,r||[])).next())})},y=this&&this.i||function(t,r){var n,e,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,e&&(i=2&o[0]?e.return:o[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,o[1])).done)return i;switch(e=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,e=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=r.call(t,u)}catch(t){o=[6,t],e=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},w=c.sheets.track,g=c.sheets.Events,O=c.sheets.menu.getMenuModel},2535:function(t,r,n){"use strict";n.d(r,"a",function(){return s});var e,i=n(0),o=n.n(i),u=n(2049),c=n(2536),a=this&&this.t||(e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(t,r)},function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),f=this&&this.o||function(){return(f=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)},s=function(t){function r(r){var n=t.call(this,r)||this;return n.rerender=function(){n.forceUpdate()},n.state={},n}return a(r,t),r.prototype.componentDidMount=function(){this.props.formController.on(u.a.FormUiChanged,this.rerender)},r.prototype.componentWillUnmount=function(){this.props.formController.off(u.a.FormUiChanged,this.rerender)},r.prototype.render=function(){var t=this.props.formController.ui;return o.a.createElement(o.a.Fragment,null,t.createFormPopup.props?o.a.createElement(c.a,f({},t.createFormPopup.props)):void 0)},r}(o.a.Component)},2536:function(t,r,n){"use strict";n.d(r,"a",function(){return y});var e,i=n(1),o=n.n(i),u=n(0),c=n.n(u),a=n(2537),f=n(2132),s=n(2538),l=n(3),d=n(4),v=this&&this.t||(e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(t,r)},function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),h=this&&this.o||function(){return(h=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)},m=this&&this.r||function(t,r,n,e){return new(n||(n=Promise))(function(i,o){function u(t){try{a(e.next(t))}catch(t){o(t)}}function c(t){try{a(e.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new n(function(r){r(t.value)}).then(u,c)}a((e=e.apply(t,r||[])).next())})},b=this&&this.i||function(t,r){var n,e,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,e&&(i=2&o[0]?e.return:o[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,o[1])).done)return i;switch(e=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,e=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=r.call(t,u)}catch(t){o=[6,t],e=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},p=l.sheets.alert.showAlert,y=function(t){function r(r){var n=t.call(this,r)||this;n.guessBestRow=function(){var t=Object(s.a)(5).map(function(t,r){return n.getFieldsFromSheetRow(r)}),r=t.map(function(t){return t.length}),e=Math.max.apply(Math,r),i=r.findIndex(function(t){return t===e});return{row:i,fields:t[i]}},n.getFieldsFromSheetRow=function(t){return Object(s.b)(n.props.A,n.props.sheetGuid,t).map(function(t){return h({},t,{selected:!0})})},n.onChangeHeaderRow=function(t){n.setState({headerRow:t-1,fields:n.getFieldsFromSheetRow(t-1)})},n.onToggleField=function(t){var r=Object(f.a)(n.state.fields,function(r){var n=r[t];n.selected=!n.selected});n.setState({fields:r})},n.onSubmit=function(){return m(n,void 0,void 0,function(){var t,r,n,e;return b(this,function(i){switch(i.label){case 0:if(this.state.isCreating)return[2];this.setState({isCreating:!0}),i.label=1;case 1:return i.trys.push([1,3,,4]),t=this.state.fields,[4,this.props.onCreate({questions:t.filter(function(t){return t.selected}).map(function(t){return t.text})})];case 2:return r=i.sent().guid,this.props.A.spread.TK(r),this.props.onClose(),[3,4];case 3:return n=i.sent(),e=n&&n.errmsg||o()("创建表单失败，请稍后再试"),p({title:e,type:"error"}),this.setState({isCreating:!1}),[3,4];case 4:return[2]}})})};var e=n.guessBestRow(),i=e.row,u=e.fields;return n.state={headerRow:i,fields:u,isCreating:!1},n.props.A.on(d.default.IV,n.props.onClose),n}return v(r,t),r.prototype.componentWillUnmount=function(){this.props.A.off(d.default.IV,this.props.onClose)},r.prototype.render=function(){var t=this,r=this.props,n=r.onClose,e=r.A,i=r.sheetGuid,u=this.state,f=u.headerRow,s=u.fields,l=e.spread.getSheet(i),d=l?l.G():0;return c.a.createElement("div",{className:"form-popup-wrapper f-center"},c.a.createElement("div",{className:"form-popup"},c.a.createElement("div",{className:"form-popup-header f-v-center"},c.a.createElement("h3",{className:"form-popup-heading f-1"},o()("基于表头创建表单")),c.a.createElement("div",{className:"form-popup-close-button",onClick:n})),c.a.createElement("div",{className:"form-popup-content"},c.a.createElement("div",{className:"header-row-selector f-v-center"},c.a.createElement("div",{className:"header-row-select-label"},o()("选择表头内容行")),c.a.createElement("div",{className:"header-row-select-input f-1"},c.a.createElement(a.a,{value:f+1,min:1,max:d||1,onChange:this.onChangeHeaderRow}))),c.a.createElement("div",{className:"fields-selector"},c.a.createElement("div",{className:"fields-select-label"},o()("选择字段")),c.a.createElement("div",{className:"fields-select-input"},s.length?s.map(function(r,n){return c.a.createElement("div",{className:"form-field f-v-center",key:n,onClick:function(){return t.onToggleField(n)}},c.a.createElement("div",{className:"form-field-checkbox "+(r.selected?"is-selected":"")}),c.a.createElement("div",{className:"form-field-label f-1"},r.text))}):c.a.createElement("div",{className:"form-fields-placeholder"})))),c.a.createElement("div",{className:"form-popup-footer f-row f-m-end"},c.a.createElement("div",{className:"form-popup-confirm-button f-center "+(this.state.isCreating?"is-disabled":""),onClick:this.state.isCreating?void 0:this.onSubmit},o()("确定")))))},r}(c.a.Component)},2537:function(t,r,n){"use strict";n.d(r,"a",function(){return c});var e,i=n(0),o=n.n(i),u=this&&this.t||(e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(t,r)},function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),c=function(t){function r(){var r=null!==t&&t.apply(this,arguments)||this;return r.onIncrease=function(){var t=r.props,n=t.value;(0,t.onChange)(r.confine(n+1))},r.onDecrease=function(){var t=r.props,n=t.value;(0,t.onChange)(r.confine(n-1))},r.onChange=function(t){var n=r.props,e=n.value,i=n.onChange,o=t.target.value,u=Number(o);i(u!=u?r.confine(e):r.confine(u))},r.onKeyDown=function(t){switch(t.key){case"ArrowUp":r.onIncrease();break;case"ArrowDown":r.onDecrease()}},r.onFocus=function(t){var r=t.target;r.setSelectionRange(0,r.value.length)},r}return u(r,t),r.prototype.confine=function(t){var r=this.props,n=r.max,e=r.min,i=Math.floor(t);return null!=n&&i>n?n:null!=e&&i<e?e:i},r.prototype.render=function(){var t=this.props,r=t.value,n=t.max,e=t.min,i=!(null!=n&&r>=n),u=!(null!=e&&r<=e);return o.a.createElement("div",{className:"form-number-input f-row f-c-stretch"},o.a.createElement("input",{type:"text",className:"f-1 f-v-center",value:r,onChange:this.onChange,onKeyDown:this.onKeyDown,onFocus:this.onFocus}),o.a.createElement("div",{className:"number-spinners f-col f-c-stretch"},o.a.createElement("div",{className:"spinner spinner-increase f-1 f-center "+(i?"":"is-disabled"),onClick:i?this.onIncrease:void 0},o.a.createElement("div",{className:"spinner-icon"})),o.a.createElement("div",{className:"spinner spinner-decrease f-1 f-center "+(u?"":"is-disabled"),onClick:u?this.onDecrease:void 0},o.a.createElement("div",{className:"spinner-icon"}))))},r}(o.a.Component)},2538:function(t,r,n){"use strict";n.d(r,"a",function(){return e}),n.d(r,"b",function(){return i});var e=function(t){for(var r=[],n=0;n<t;n++)r.push(void 0);return r},i=function(t,r,n){var i=t.spread.getSheet(r);if(!i)return[];if(n>=i.G())return[];var o=i.E;return e(i.H()).map(function(t,r){var e=o.getSpan(n,r),i=e||{row:n,col:r,rowCount:1,colCount:1};if(o.isRangeReadable(i)){if(e)return r===e.col?o.getText(e.row,e.col):void 0;var u=o.getCellType(n,r);return u&&"8"===u.typeName?u.text():o.getText(n,r)}}).map(function(t,r){if(null!=t)return"string"==typeof t?""===t.trim()?void 0:{text:t,col:r}:"number"==typeof t?t!=t?void 0:{text:String(t),col:r}:void 0}).filter(Boolean)}}});