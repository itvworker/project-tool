webpackJsonpSm_name_([11],{1855:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"PLUGIN_NAME",function(){return m});var r,i=n(1),s=n.n(i),o=(n(2601),n(3)),a=n(0),c=n.n(a),l=n(12),u=n.n(l),h=n(2604),f=this&&this.t||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=o.sheets.Events,m=(o.Editor,"CellHistory"),v=function(t){function e(n){var r=t.call(this,{name:m,Constructor:e,config:n})||this;return r.options=n,r.render(),r.install(),r}return f(e,t),e.prototype.setLocale=function(t){s.a.setLocaleSync(t)},e.prototype.show=function(t){this.dialog&&this.dialog.show(t,this.options.getRev()),o.sheets.track(2,"13000")},e.prototype.render=function(){var t=this;this.options.A.isRendered?this.renderContainer():this.options.A.on(d.Rendered,function(){t.renderContainer()})},e.prototype.renderContainer=function(){var t=this,e=this.options,n=e.A,r=e.fetchHistoryApi;u.a.render(c.a.createElement(h.a,{ref:function(e){return t.dialog=e},A:n,fetchHistoryApi:r}),this.pluginContainer)},e}(o.sheets.Plugin);e.default=v},2601:function(t,e,n){"use strict";var r=n(1),i=n.n(r),s=n(2602),o=n.n(s),a=n(2603),c=n.n(a);i.a.addLocaleResource("en-US",o.a),i.a.addLocaleResource("ja-JP",c.a),i.a.setLocaleSync({en:"en-US",jp:"ja-JP"}[document.documentElement.lang]||document.documentElement.lang||"zh-CN")},2602:function(t,e){t.exports={"改动来源于数据透视表":"Changed by pivottable","改动来源于数组公式":"Changed by array formula","改动来源于 %s 单元格公式":"Changed by %s formula","编辑历史":"Edit history","无更多修改历史":"No more edit history","无修改历史":"No edit history","已查询到%s，暂未找到编辑记录":"Queryed %s, no edit history found yet","继续查询":"continue","请求失败":"Request error","用":"New","修改为":"Modified to","增加了":"Add","删除了":"Remove","替换了":"Old"}},2603:function(t,e){t.exports={"改动来源于数据透视表":"ピボットテーブルの結果","改动来源于数组公式":"配列数式の結果","改动来源于 %s 单元格公式":"%s の配列数式の結果","编辑历史":"編集履歴","无更多修改历史":"編集履歴はもうありません","无修改历史":"編集履歴なし","已查询到%s，暂未找到编辑记录":"%sがクエリされました。編集履歴はまだ見つかりません","继续查询":"クエリを続行","请求失败":"リクエストに失敗しました","用":"新しい","修改为":"変更後","增加了":"増やす","删除了":"削除する","替换了":"古い"}},2604:function(t,e,n){"use strict";var r,i,s,o=n(1),a=n.n(o),c=n(0),l=n.n(c),u=n(3),h=n(2605),f=n(2606),d=n(2607),m=(n.n(d),n(2609)),v=this&&this.t||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=this&&this.e||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},y=this&&this.r||function(){return(y=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},b=this&&this.s||function(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{c(r.next(t))}catch(t){s(t)}}function a(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,a)}c((r=r.apply(t,e||[])).next())})},x=this&&this.o||function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},g=u.sheets,w=g.utils,k=g.constants,N=g.changeset,C=g.Events,I=g.track,j=w.dateTime,O=N.stringifyPosition,_=function(t){function e(e){var n=t.call(this,e)||this;return n.show=function(t,e){var r=t.row,i=t.col,s=t.sheetId;n.setState({open:!0,cell:{row:r,col:i}}),n.requestHistory({cell:{row:r,col:i,sheetId:s,sheetIndex:n.props.A.spread.sheets.findIndex(function(t){return t.id===s})},from:e})},n.onDialogClosed=function(){n.setState({open:!1,historyItems:[],lastItem:"loading",firstItem:null,activeIndex:0}),n.reset()},n.continueFetch=function(){n.fetchResult.isFetchExceed=!1,n.requestHistory(),I(2,"13002")},n.prev=function(){var t=n.state,e=t.activeIndex,r=t.historyItems,i=t.lastItem,s=t.firstItem,o=r.length+(s?1:0);if(e<o){var a=e+1;n.setState({activeIndex:a}),a===o&&"loading"===i&&n.requestHistory(),I(2,"13001")}},n.next=function(){var t=n.state.activeIndex;0!==t&&n.setState({activeIndex:t-1})},n.state={open:!1,historyItems:[],firstItem:null,lastItem:"loading",activeIndex:0,cell:{row:0,col:0}},n.isFetching=!1,n}return v(e,t),e.prototype.render=function(){return this.state.open?l.a.createElement(h.a,{A:this.props.A,relativeCell:this.state.cell,inner:this.inner(),zIndex:10,onDialogClosed:this.onDialogClosed}):null},e.prototype.reset=function(){this.isFetching=!1},e.prototype.requestHistory=function(t){return b(this,void 0,Promise,function(){var e,n,r,i,s,o;return x(this,function(a){switch(a.label){case 0:if(e=this.genFetchParams(t),this.isFetching||!e)return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),t&&(n=t.cell,r=t.from,i=function(t,e){try{var n=t.row,r=t.col,i=t.sheetId,s=e.spread.getSheet(i);if(!s)return;var o=s.E,a=function(t,e,n){return t._getArrayFormulaInfo(e,n)||function(t,e,n){var r=t.getArrayValueMark(e,n);if("string"==typeof r){var i=r.split("@");return{row:+i[1],col:+i[2]}}}(t,e,n)}(o,n,r);if(a){var c=function(t,e,n){if(t.getFormula(e,n).indexOf("PIVOTTABLE")>-1)return"pivottable";if(t._getArrayFormulaInfo(e,n))return"range";return"other"}(o,a.row,a.col);if("pivottable"===c||"range"===c||!function(t,e){return t.row===e.row&&t.col===e.col}(a,t))return{type:"formula",data:{type:c,cell:O(a.row,a.col)}}}}catch(t){e.emit(C.Track,k.ERR_CODE.WS,{stack:t&&t.stack,type:"get array formula error"})}}(n,this.props.A))?(this.setState({firstItem:i}),this.fetchResult={cell:n,rev:r,cellChanges:[],lastHistory:void 0,isFetchExceed:!1},[2]):(this.isFetching=!0,this.setState({lastItem:"loading"}),s=this,[4,Object(m.a)(e)]);case 2:return s.fetchResult=a.sent(),this.setState({lastItem:function(t){var e=t.rev,n=t.cell,r=t.isFetchExceed;if(Object(m.b)(e,n))return"end";if(r)return"max";return"loading"}(this.fetchResult),historyItems:function(t){for(var e=t.cellChanges,n=t.cell,r=t.rev,i=[],s=Object(m.b)(r,n),o=0,a=e.length;o<a;o++){var c=e[o],l=z(c);if(1===a&&l)break;if(1!==a&&o===a-1&&(l||!s))break;i.push({user:c.user,prev:e[o+1]&&e[o+1].data||s&&{text:""},cur:c.data})}return i}(this.fetchResult)}),[3,4];case 3:return o=a.sent(),this.props.A.emit(C.Track,k.ERR_CODE.WS,{stack:o&&o.stack}),this.setState({lastItem:"error"}),[3,4];case 4:return this.isFetching=!1,[2]}})})},e.prototype.genFetchParams=function(t){return t||this.fetchResult?y({fetchUrl:this.props.fetchHistoryApi,prevCellChanges:[]},t||{cell:this.fetchResult.cell,from:this.fetchResult.rev,prevCellChanges:this.fetchResult.cellChanges}):null},e.prototype.activeItem=function(){var t=this.state,e=t.activeIndex,n=t.historyItems,r=t.firstItem,s=r?1:0;if(0===e&&r){var o=r.data,c=o.cell,u=o.type,h="pivottable"===u?a()("改动来源于数据透视表"):"range"===u?a()("改动来源于数组公式"):a()(i||(i=p(["改动来源于 "," 单元格公式"],["改动来源于 "," 单元格公式"])),c);return l.a.createElement("span",{className:"sm-sheet-cell-history-first"},h)}return n[e-s]?l.a.createElement(f.a,{data:n[e-s]}):l.a.createElement("span",{className:"sm-sheet-cell-history-last"},this.getLastItemEle())},e.prototype.inner=function(){var t=this.state,e=t.activeIndex,n=t.historyItems,r=t.firstItem?1:0,i=e>=n.length+r,s=0===e;return l.a.createElement("div",{className:"sm-sheet-cell-history-container"},l.a.createElement("div",{className:"sm-sheet-cell-history-header"},l.a.createElement("span",{className:"sm-sheet-cell-history-header-label"},a()("编辑历史")),l.a.createElement("span",{className:"sm-sheet-cell-history-header-prev "+(i?"disabled":""),onClick:this.prev}),l.a.createElement("span",{className:"sm-sheet-cell-history-header-next "+(s?"disabled":""),onClick:this.next})),l.a.createElement("div",{className:"sm-sheet-cell-history-body"},this.activeItem()))},e.prototype.getLastItemEle=function(){var t=this.state.lastItem,e=this.state.historyItems.length>0;if("end"===t)return l.a.createElement("span",{className:"sm-sheet-cell-history-body-text"},e?a()("无更多修改历史"):a()("无修改历史"));if("max"===t){var n=this.fetchResult&&this.fetchResult.lastHistory,r=n?j.format(n.updatedAt):"";return l.a.createElement("span",{className:"sm-sheet-cell-history-body-text"},a()(s||(s=p(["已查询到","，暂未找到编辑记录"],["已查询到","，暂未找到编辑记录"])),r)," ",l.a.createElement("span",{className:"sm-sheet-cell-history-continue-request",onClick:this.continueFetch},a()("继续查询")))}return"error"===t?l.a.createElement("span",{className:"sm-sheet-cell-history-body-text"},a()("请求失败")):l.a.createElement("span",{className:"sm-sheet-loading-rotate"})},e}(l.a.Component);function z(t){var e=t.data,n=e.text,r=e.url;return!(n||r)}e.a=_},2605:function(t,e,n){"use strict";(function(t){var r,i=n(0),s=n.n(i),o=n(3),a=this&&this.t||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=o.sheets.Core.Spread.Sheets.Events,l=c.TopRowChanged,u=c.LeftColumnChanged,h=c.LayoutChanged,f=c.SelectionChanged,d=c.ActiveSheetChanged,m=function(e){function n(t){var n=e.call(this,t)||this;return n.onLayoutChanged=function(){n.recalcPos=!0,n.forceUpdate()},n.onSelectionChanged=function(){n.A.csApplier.isApplingChange||n.close()},n.onActiveSheetChanged=function(){n.close()},n.onSheetFullApply=function(t){var e=t.rows,r=t.cols,i=n.state.relativeCell,s=i.row,o=i.col;s=v(e,s),o=v(r,o),-1===s||-1===o?n.close():(n.recalcPos=!0,n.setState({relativeCell:{row:s,col:o}}))},n.bindEvents(),n.A=t.A,n.state={relativeCell:n.props.relativeCell,visibility:"hidden",pos:{left:0,top:0}},n.recalcPos=!0,n}return a(n,e),n.prototype.render=function(){var t=this.state,e=t.pos,n=t.visibility,r=e.left,i=e.top;return s.a.createElement("div",{className:"sm-sheet-floating-dialog",style:{zIndex:this.props.zIndex||1,left:r,top:i,visibility:n}},this.props.inner)},n.prototype.componentWillReceiveProps=function(t){this.props.inner!==t.inner&&(this.recalcPos=!0)},n.prototype.componentDidMount=function(){this.rePosition()},n.prototype.componentDidUpdate=function(){this.rePosition()},n.prototype.componentWillUnmount=function(){var t=this;setTimeout(function(){t.destroy()})},n.prototype.bindEvents=function(){this.props.A.spread.gcSpread.bind(l,this.onLayoutChanged),this.props.A.spread.gcSpread.bind(u,this.onLayoutChanged),this.props.A.spread.gcSpread.bind(h,this.onLayoutChanged),this.props.A.spread.gcSpread.bind(f,this.onSelectionChanged),this.props.A.spread.gcSpread.bind(d,this.onActiveSheetChanged),this.props.A.on(o.sheets.Events.AfterSheetFullApply,this.onSheetFullApply)},n.prototype.destroy=function(){this.props.A.spread.gcSpread.unbind(l,this.onLayoutChanged),this.props.A.spread.gcSpread.unbind(u,this.onLayoutChanged),this.props.A.spread.gcSpread.unbind(h,this.onLayoutChanged),this.props.A.spread.gcSpread.unbind(f,this.onSelectionChanged),this.props.A.spread.gcSpread.unbind(d,this.onActiveSheetChanged),this.props.A.off(o.sheets.Events.AfterSheetFullApply,this.onSheetFullApply)},n.prototype.rePosition=function(){this.recalcPos&&(this.recalcPos=!1,this.setState(this.getContainerPosition()))},n.prototype.close=function(){this.props.onDialogClosed()},n.prototype.getContainerPosition=function(){var e=this.state.relativeCell,n=e.row,r=e.col,i=this.A.spread.gcSpread.B(),s=i.getCellRect(n,r),o=s.x,a=s.y,c=s.width,l=s.height,u=t("#sm-canvas-container-viewport").offset(),h=t(".sm-sheet-floating-dialog").offset();return{pos:{left:function(t,e,n,r){return t+e+n>r?r-n:t+e}(o,c,h.width,u.width),top:function(e,n,r,i){var s=(c=t("#sm-canvas-container-viewport").offset(),l=t(".sm-sheet-view-container").offset(),c.top-l.top),o=i+22,a=Math.max(e,o);var c,l;return(a+n>r?r-n:a)+s}(a,h.height,u.height,function(t,e){var n=t.frozenRowCount(),r=0;if(n<=e)for(var i=0;i<n;i++)r+=t.getRowHeight(i);return r}(i,n))},visibility:o+c<=0||a+l<=0?"hidden":"visible"}},n}(s.a.Component);function v(t,e){if(!t)return e;for(var n=e,r=0;r<t.length;r++){var i=t[r],s=i.type,o=i.index,a=i.amount;if("insert"===s&&o<=e)n+=a;else if("remove"===s)if(o+a-1<n)n-=a;else if(o+a-1>=n&&o<=n)return-1}return n}e.a=m}).call(e,n(22))},2606:function(t,e,n){"use strict";e.a=function(t){var e=t.data,n=e.user,r=e.prev,s=e.cur;return o.a.createElement("div",{className:"sm-sheet-cell-hisotry-item"},o.a.createElement("div",{className:"cell-hisotry-item-user"},o.a.createElement("img",{src:n.avatar,className:"cell-hisotry-item-user-img"}),o.a.createElement("span",{className:"cell-hisotry-item-user-name"},n.name),o.a.createElement("span",{className:"cell-hisotry-item-user-time"},a.format(n.updatedAt))),o.a.createElement("div",{className:"cell-hisotry-item-content"},function(t,e){var n=c(t),r=c(e);if(!t)return[{des:i()("修改为"),data:e}];if(n&&r)return[{des:i()("用"),data:e},{des:i()("替换了"),data:t}];if(n)return[{des:i()("删除了"),data:t}];if(r)return[{des:i()("增加了"),data:e}];return[]}(r,s).map(function(t,e){var n=t.des,r=t.data;return o.a.createElement("div",{className:"cell-hisotry-item-content-action",key:e},o.a.createElement("span",{className:"cell-hisotry-item-content-action-label"},n+":"),o.a.createElement("span",{className:"cell-hisotry-item-content-action-content"},r.url?o.a.createElement("a",{href:r.url,target:"_blank"},r.text||r.url):r.text))})))};var r=n(1),i=n.n(r),s=n(0),o=n.n(s),a=n(3).sheets.utils.dateTime;function c(t){return!(!t||!t.text&&!t.url)}},2607:function(t,e,n){var r=n(2608);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(1736)(r,i);r.locals&&(t.exports=r.locals)},2608:function(t,e,n){(t.exports=n(1735)(!1)).push([t.i,".sm-sheet-floating-dialog {\n  position: absolute;\n  background: white;\n  box-shadow: 0 0 20px #c8c8c8;\n  left: 400px;\n  top: 200px;\n  border-radius: 2px; }\n\n.sm-sheet-cell-history-container {\n  width: 240px;\n  box-sizing: border-box;\n  font-size: 12px; }\n\n.sm-sheet-cell-history-loading {\n  width: 20px;\n  height: 20px;\n  margin: 0 110px; }\n\n.sm-sheet-cell-history-body-text {\n  padding: 0 15px;\n  display: inline-block; }\n\n.sm-sheet-cell-history-body {\n  font-size: 0px; }\n  .sm-sheet-cell-history-body .sm-sheet-loading-rotate {\n    width: 20px;\n    height: 20px;\n    margin: 0 110px;\n    box-sizing: border-box; }\n\n.sm-sheet-cell-history-continue-request {\n  color: #6da0e3;\n  cursor: pointer; }\n  .sm-sheet-cell-history-continue-request:hover {\n    color: #6290cc; }\n\n.sm-sheet-cell-history-first,\n.sm-sheet-cell-history-last {\n  display: inline-block;\n  line-height: 20px;\n  margin: 12px 0;\n  font-size: 12px;\n  color: #a5a5a5; }\n\n.sm-sheet-cell-history-first {\n  margin-left: 15px; }\n\n.sm-sheet-cell-history-header {\n  height: 36px;\n  line-height: 36px;\n  background: #f7f7f7;\n  padding: 0 15px;\n  color: #333;\n  position: relative; }\n\n.sm-sheet-cell-history-header-prev,\n.sm-sheet-cell-history-header-next {\n  display: inline-block;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  line-height: 20px;\n  vertical-align: -5px;\n  position: absolute;\n  top: 7px;\n  cursor: pointer;\n  opacity: 0.6; }\n  .sm-sheet-cell-history-header-prev::before,\n  .sm-sheet-cell-history-header-next::before {\n    content: '';\n    border-style: solid;\n    border-color: #494949;\n    border-width: 0 0 2px 2px;\n    width: 5px;\n    height: 5px;\n    display: block;\n    position: absolute;\n    top: 7px; }\n  .sm-sheet-cell-history-header-prev:hover,\n  .sm-sheet-cell-history-header-next:hover {\n    opacity: 1; }\n  .sm-sheet-cell-history-header-prev.disabled,\n  .sm-sheet-cell-history-header-next.disabled {\n    opacity: 0.3; }\n    .sm-sheet-cell-history-header-prev.disabled:hover,\n    .sm-sheet-cell-history-header-next.disabled:hover {\n      opacity: 0.3; }\n\n.sm-sheet-cell-history-header-prev {\n  right: 51px; }\n  .sm-sheet-cell-history-header-prev::before {\n    transform: rotate(45deg);\n    left: 8px; }\n\n.sm-sheet-cell-history-header-next {\n  right: 15px; }\n  .sm-sheet-cell-history-header-next::before {\n    transform: rotate(-135deg);\n    left: 6px; }\n\n.sm-sheet-cell-hisotry-item {\n  font-size: 12px; }\n\n.cell-hisotry-item-user {\n  background: #f7f7f7;\n  height: 32px;\n  padding: 4px 15px 12px; }\n\n.cell-hisotry-item-user-img {\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n  float: left; }\n\n.cell-hisotry-item-user-time {\n  margin-top: 8px;\n  color: #a5a5a5; }\n\n.cell-hisotry-item-user-name {\n  color: #333; }\n\n.cell-hisotry-item-user-name,\n.cell-hisotry-item-user-time {\n  display: block;\n  margin-left: 44px; }\n\n.cell-hisotry-item-content {\n  padding: 12px 15px;\n  line-height: 20px; }\n\n.cell-hisotry-item-content-action {\n  overflow-x: hidden;\n  overflow-y: auto;\n  overflow-wrap: break-word;\n  word-wrap: break-word; }\n\n.cell-hisotry-item-content-action-label {\n  color: #a5a5a5;\n  white-space: nowrap; }\n\n.cell-hisotry-item-content-action-content {\n  margin-left: 8px;\n  color: #333; }\n  .cell-hisotry-item-content-action-content a {\n    color: #6da0e3;\n    text-decoration: none; }\n",""])},2609:function(t,e,n){"use strict";e.a=function t(e,n){var r=e.fetchUrl,h=e.from,f=e.cell,d=e.prevCellChanges;void 0===n&&(n=0);return s(this,void 0,Promise,function(){var e,m,v,p,y,b,x;return o(this,function(g){switch(g.label){case 0:return[4,function(t,e,n){return s(this,void 0,Promise,function(){return o(this,function(r){switch(r.label){case 0:return[4,a(null,{url:t,params:{from:n,to:e}})];case 1:return[2,r.sent()]}})})}(r,h,Math.max(h-l,1))];case 1:return e=g.sent(),m=Object(i.a)(e.reverse(),f,d),v=m.cellChanges,p=m.cell,y=m.rev,b=d.length>0&&v.length>0||v.length>1,x=function(t){return t>=c}(n),n+=e.length,v.unshift.apply(v,d),b||u(y,p)||x?[2,{cellChanges:v,cell:p,rev:y,lastHistory:e[e.length-1],isFetchExceed:x}]:[2,t({fetchUrl:r,from:y,cell:p,prevCellChanges:v},n)]}})})},e.b=u;var r=n(3),i=n(2610),s=this&&this.s||function(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{c(r.next(t))}catch(t){s(t)}}function a(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,a)}c((r=r.apply(t,e||[])).next())})},o=this&&this.o||function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},a=r.sheets.ajax.ajax,c=3e3,l=300;function u(t,e){return t<1||Object(i.b)(e)}},2610:function(t,e,n){"use strict";e.a=function(t,e,n){for(var r=Object.assign({},e),i=[],s=t[t.length-1].rev,o=0;o<t.length;o++){var a=t[o],c=u(a,r);if(r=c.cell,c.cellChange&&(i.push(c.cellChange),i=p(n,i)),m(r)||v(n,i)){s=a.rev;break}}return{cellChanges:i,cell:r,rev:s-1}},e.b=m;var r=n(3),i=r.sheets.utils,s=i.modoc,o=i.decodeFormula,a=r.sheets.formatter,c=a.GeneralFormatter,l=a.composeFormatterAndPrecision;function u(t,e){for(var n=null,r=null,i=e.sheetIndex,o=-1,a=new s.Delta(t.delta).getIter();a.hasNext();){var c=a.next(),l=c.action,u=c.data,f="number"==typeof u?u:1,d=o+f,m=o<i,v=d>=i;if("retain"===l&&v){n=(p=h(c,e)).cell,r=p.cellChangeData;break}if("remove"===l&&m)i+=f;else if("insert"===l&&m){if(v){var p;i=-1,n=(p=h(c,e)).cell,r=p.cellChangeData;break}i-=f}"insert"!==l&&(o=d)}return{cell:Object.assign(e,{sheetIndex:i},n),cellChange:r&&function(t,e){return{data:e,user:{name:t.user.name,avatar:t.user.avatar,updatedAt:t.updatedAt}}}(t,r)}}function h(t,e){var n=t.getAttributes();if(n&&n.id&&n.id!==e.sheetId)return{cell:{row:-1,col:-1},cellChangeData:null};var r=t.data,i=e.row,s=e.col;if("number"==typeof r)return{cell:{row:i,col:s},cellChangeData:null};var a=t.getParsedData(),u=a[0],h=a[1];return{cell:{row:f(u,i),col:f(h,s)},cellChangeData:function(t,e,n){if(!t)return null;var r=t.getIter(),i=null,s=-1;for(;r.hasNext();){var a=r.next(),u=a.action,h="number"==typeof a.data?a.data:1;if(("retain"===u||"insert"===u)&&(s+=h)>=n){i=a;break}}return i&&"number"!==i.dataType?function(t,e){var n,r=t.getParsedData().getIter(),i=-1;for(;r.hasNext();){var s=r.next(),a="number"==typeof s.data?s.data:1;if((i+=a)>=e){n=s;break}}if(n)return function(t){var e=t.getAttributes(),n=e.formula,r=e.link,i=e.backgroundImage,s=function(t){if(t){var e=o(t),n=!(!e||!e.a),r="="+(e?e.f:t);return n?"{"+r+"}":r}return""}(n)||function(t){var e=t.cellValue,n=t.format,r=t.autoFormatter,i=t.precision;if(null!=e&&(n||r)){var s=n||r;return n&&"number"==typeof i&&(s=l(n,i)),new c(s).format(e,{})}if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();return""}(e);if(r)return{text:s,url:r};if(i)return{text:"图片",url:i};if(e.hasOwnProperty("cellValue")||e.hasOwnProperty("formula"))return{text:s};return null}(n);return null}(i,e):null}(h,i,s)}}function f(t,e){if(!t)return e;for(var n=-1,r=e,i=t.getIter();i.hasNext();){var s=i.next(),o=s.action,a="number"==typeof s.data?s.data:1,c=n+a,l=n<r,u=c>=r;if("retain"===o&&u)break;if("remove"===o&&l)r+=a;else if("insert"===o&&l){if(u){r=-1;break}r-=a}"insert"!==o&&(n=c)}return r}function d(t){var e=t.text,n=t.url;return!(!e&&!n)}function m(t){var e=t.sheetIndex,n=t.row,r=t.col;return-1===e||-1===n||-1===r}function v(t,e){return t.length&&e.length>0||e.length>1}function p(t,e){var n=t[t.length-1];return e.filter(function(t,r){var i=0===r?n:e[r-1];return d(t.data)||!i||i&&d(i.data)})}}});