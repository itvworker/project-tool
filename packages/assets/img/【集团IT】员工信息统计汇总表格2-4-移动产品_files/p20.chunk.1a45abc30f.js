webpackJsonpSm_name_([9],{1857:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(223),o=(n.n(i),n(1)),a=n.n(o),s=n(0),l=n.n(s),u=n(12),f=n.n(u),c=n(3),p=n(2721),h=n(2722),d=n(2724),g=n.n(d),m=n(2725),v=(n(2726),n(2729)),b=(n.n(v),this&&this.t||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})),y=this&&this.r||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}l((r=r.apply(t,e||[])).next())})},w=this&&this.o||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},x=c.sheets,k=x.path,O=x.Plugin,_=(x.root,x.render),A=x.changeset,P=x.Events,C=x.constants,E=x.track,T=(k.setByPath,_.applySheetsChangeset),D=A.addParamsToOperator,j=A.calcOperatorCs,N="FileSlimming",S=300,I=20,M=function(t){function e(n){var r=t.call(this,{name:N,Constructor:e,config:n})||this;return r.fileInfo=null,r.showDialog=function(){return y(r,void 0,void 0,function(){var t=this;return w(this,function(e){this.dialogRef.show(),this.fileInfo=null;try{this.worker=new g.a}catch(t){this.opts.A.emit(P.Track,C.ERR_CODE.XB,{label:"file slimming",msg:t&&t.stack})}return this.worker.onmessage=function(e){var n=e.data,r=n.cmd,i=n.data;switch(r){case"data":t.fileInfo=i,t.s(i);break;case"done":t.fileInfo=i,t.s(i);var o=Object(m.a)(i);t.dialogRef.changeStatus(o?2:4)}},this.worker.onerror=function(){t.fileInfo=null},this.doScanFile(),E(2,"16000"),[2]})})},r.doScanFile=function(){r.opts.A.getContent().then(function(t){var e=t.stringify(),n=r.opts,i={cmd:"scan",content:e,opts:{maxEmptyRows:n.maxEmptyRows,maxEmptyCols:n.maxEmptyCols}};r.worker.postMessage(i)})},r.getMenuConfig=function(){return Object(p.a)({showDialog:r.showDialog})},r.cancelScan=function(){r.worker.terminate()},r.cleanFile=function(){return y(r,void 0,void 0,function(){var t,e,n,r,i,o,a,s,l,u,f,c,p,h,d,g,m,v,b,y,x;return w(this,function(w){if(null==this.fileInfo)return[2];for(o in t=this.opts.A,e=t.spread.B(),n=e.E,r=this.fileInfo.sheets,i={},r){if(a=r[o],s=a.rowCount,l=a.emptyRowCount,u=a.colCount,f=a.emptyColCount,c=a.invalidImages,p=a.invalidCells,h={},d={sheetId:o,sheetIndex:t.spread.getCsIndexBySheetId(o)},Object.keys(c).length>0&&(h.floatingObjects=c),l>0&&(h.rows={index:s-l,count:l}),f>0&&(h.cols={index:u-f,count:f}),Object.keys(p).length>0){for(m in g=[],p)for(v in p[m])g.push(p[m][v]);h.cells=g}Object.keys(h).length>0&&(h.tableAttributes=d,i[o]=h)}return E(2,"16001"),b={fnName:"fileSlimming",params:t.opProcessor([n.guid(),i])},y=D({A:t},b),x=j({A:t},y),T({sheet:n,A:t,source:"fileSlimming"},x[0]),t._operatorQueue.calcCsQueue.addToQueue({calcOpRes:[x],label:"fileSlimming",isCalcInWorker:!0}),[2]})})},r.s=function(t){var e=r.opts.A.spread.sheets.map(function(t){return{name:t.name,id:t.id}});r.dialogRef.updateView(t,e)},r.l=function(){f.a.render(l.a.createElement(h.a,{cleanFile:r.cleanFile,doScanFile:r.doScanFile,cancelScan:r.cancelScan,A:r.opts.A,ref:function(t){return r.dialogRef=t}}),r.pluginContainer)},r.opts=Object.assign({},n,{maxEmptyRows:S,maxEmptyCols:I}),r.l(),r.install(),r}return b(e,t),e.prototype.setLocale=function(t){a.a.setLocaleSync(t)},e}(O);e.default=M},2138:function(t,e,n){t.exports=n.p+"images/icon_warning.ee631d1799.svg"},2139:function(t,e,n){t.exports=n.p+"images/loading.b6fdacf21a.svg"},2721:function(t,e,n){"use strict";var r,i,o=n(1),a=n.n(o),s=n(0),l=n.n(s),u=n(89),f=n(183),c=n(49),p=n(82),h=this&&this.t||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.permissionUpdateKeys=["canEditRange"],e.onFileSlimming=function(){i.showDialog(),p.A.markAsOld()},e}return h(e,t),Object.defineProperty(e.prototype,"disabled",{get:function(){return!this.props.permission.canEditRange||this.props.selection.hasArrayFormulaCellsInRange},enumerable:!0,configurable:!0}),e.prototype.render=function(){return l.a.createElement(c.e,{A:this.props.A,icon:"file_slimming",text:a()("文件瘦身"),disabled:this.disabled,onTap:this.onFileSlimming},p.A.visible&&l.a.createElement("span",{className:"badge"}))},e}(u.a);e.a=function(t){var e;return i=t,{tabList:(e={},e[f.a.help]=d,e)}}},2722:function(t,e,n){"use strict";var r,i,o=n(1),a=n.n(o),s=n(0),l=n.n(s),u=n(2723),f=n(3),c=n(26),p=n.n(c),h=n(19),d=n.n(h),g=this&&this.t||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),m=this&&this.r||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}l((r=r.apply(t,e||[])).next())})},v=this&&this.o||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},b=f.sheets.cell.stringifyPosition;!function(t){t[t.scanning=1]="scanning",t[t.clean=2]="clean",t[t.cleaning=3]="cleaning",t[t.done=4]="done"}(i||(i={}));var y=2e5,w=1e4,x=10240,k={1:a()("扫描中..."),2:a()("清理"),3:a()("清理中..."),4:a()("完成")},O={fileSize:0,sheets:{}},_=function(t){function e(e){var n=t.call(this,e)||this;return n.show=function(){n.setState({visible:!0,status:1,data:O})},n.stopScan=function(){var t=n.props.cancelScan,e=n.state.data,r=Object.assign({},e,{current:""});t(),n.setState({status:4,data:r})},n.hideDialog=function(){var t=n.props.cancelScan;1===n.state.status&&t(),n.setState({visible:!1,status:1})},n.handStatus=function(){return m(n,void 0,void 0,function(){var t,e,n=this;return v(this,function(r){if(t=this.props.cleanFile,e=this.state.status,this.isOldSheet)return[2];if(2===e)try{this.setState({status:3}),setTimeout(function(){return m(n,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,t()];case 1:return e.sent(),this.resetViewData(),[2]}})})})}catch(t){}return 4===e&&this.setState({visible:!1,status:1}),[2]})})},n.resetViewData=function(){var t=n.props.A,e=n.state.data,r=e.sheets,i=e.fileSize;for(var o in r){var a=r[o];a&&Object.assign(a,{invalidAttrCount:0,emptyRowCount:0,emptyColCount:0,invalidImagesCount:0})}t.getContent().then(function(t){var r=t.stringify(),o=Math.ceil(i-r.length/1024);e.removedSize=o>1024?Math.ceil(o/1024)+"Mb":o+"Kb",n.setState({status:4,data:e})})},n.showCell=function(t,e){var r=n.props.A.spread;r.TK(t);var i=r.getSheet(t),o=e.row,a=e.col;i&&(n.setState({visible:!1}),i.E.showCell(o,a),i.E.TG(o,a,1,1))},n.getFileSize=function(){var t=n.state.data.fileSize;return d()(t)?l.a.createElement("em",null,"0 KB"):l.a.createElement("em",null,t>1024?(t/1024).toFixed(2)+" MB":t+" KB")},n.getAllCount=function(t){var e=0,r=n.state.data.sheets;for(var i in r){var o=r[i];if(o)e+=d()(o[t])?0:o[t]}var a=0===e?"gray":"";return l.a.createElement("em",{className:a},n.getCountStr(t,e))},n.getInvalidDataTip=function(){var t=!0,e=n.state.data.sheets;for(var r in e){var i=e[r],o=i.invalidRowPos,s=i.invalidColPos;(o||s)&&(t=!1)}return!0===t?l.a.createElement("em",{className:"gray"},"无"):l.a.createElement("div",{className:"invalid-data-tip"},a()("待清理"),l.a.createElement(u.a,null,a()("以下数据导致工作表出现了大量空白单元格，十分影响表格运行速度。请点击下方单元格位置前往查看，然后手动清理。")))},n.getItemDetail=function(t){var e=n.state,r=e.sheetsInfo,i=e.data,o=function(t,e,r,i){return l.a.createElement("div",{className:"detail-item",key:e},l.a.createElement("em",null,n.getCountStr(r,i),n.getItemTip(r,i)),l.a.createElement("span",{title:t},t))};return r.map(function(e){var n=e.name,r=e.id,a=i.sheets[r];if("cellCount"===t){var s=a?a[t]:"...";return o(n,r,t,s)}return a&&0!==a[t]?o(n,r,t,a[t]):null})},n.getInvalidDataDetail=function(){var t=n.state,e=t.sheetsInfo,r=t.data;return e.map(function(t){var e=t.name,i=t.id,o=r.sheets[i];if(o){var a=o.invalidRowPos,s=o.invalidColPos;return a||s?l.a.createElement("div",{className:"detail-item",key:i},l.a.createElement("em",null,a&&l.a.createElement("i",{onClick:function(){return n.showCell(i,a)}},b(a.row,a.col)),a&&s?"|":null,s&&l.a.createElement("i",{onClick:function(){return n.showCell(i,s)}},b(s.row,s.col))),l.a.createElement("span",null,e)):null}return null})},n.getItemTip=function(t,e){var n="";return"cellCount"===t&&e>=y&&(n=a()("单元格数量过多会影响运行速度。如果您觉得卡顿，可考虑拆分表格或精简行列来减少单元格数量。")),"formulaCount"===t&&e>=w&&(n=a()("公式数量过多 / 引用范围太大时，会影响运行速度。如果您觉得卡顿，可考虑优化公式写法（比如采用石墨的数组公式，见公式-自定义公式），或拆分成多个表格。")),"filterDataSize"===t&&e>x&&(n=a()("表格的筛选视图过大，请清理数量。")),n?l.a.createElement(u.a,null,n):null},n.getCountStr=function(t,e){return"filterDataSize"===t?e>1024?(e/1024).toFixed(2)+" MB":e+" KB":e>1e4?(e/1e4).toFixed(2)+" "+a()("万"):String(e)},n.changeStatus=function(t){n.setState({status:t})},n.updateView=function(t,e){n.setState({data:t,sheetsInfo:e})},n.state={visible:!1,status:1,data:O,sheetsInfo:[]},n}return g(e,t),Object.defineProperty(e.prototype,"isOldSheet",{get:function(){return this.props.A.fileType>-4},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"statusTip",{get:function(){if(this.isOldSheet)return l.a.createElement("div",{className:"old-sheet-tip"},a()("该表格是旧版本，您可以导出再导入转成新版本表格，提升运行速度。"));var t=this.state,e=t.status,n=t.data,r=n.current,i=n.removedSize;return r?l.a.createElement("div",{className:"scanning-tip"},""+a()("正在扫描")+r+"...",l.a.createElement("span",{className:"hicon icon-close cancel-scan",onClick:this.stopScan})):4===e&&i?l.a.createElement("div",{className:"result-tip"},""+a()("您已清理"),l.a.createElement("strong",null,i),""+a()("的数据")):null},enumerable:!0,configurable:!0}),e.prototype.render=function(){var t=this.state,e=t.visible,n=t.status,r=p()("file-slimming-dialog-mask",{"file-slimming-dialog-mask-show":e}),i=p()("sm-btn sm-btn-primary",{"btn-disable":this.isOldSheet||1===n,"btn-clean":2===n,"btn-cleaning":3===n}),o=k[n];return l.a.createElement("div",{className:r},l.a.createElement("div",{className:"file-slimming-dialog-container"},l.a.createElement("div",{className:"file-slimming-dialog-hd"},l.a.createElement("span",{className:"hicon icon-close file-slimming-close",onClick:this.hideDialog}),a()("文件瘦身")),l.a.createElement("div",{className:"file-slimming-dialog-bd"},l.a.createElement("div",{className:"file-info-area"},l.a.createElement("h3",{className:"area-title"},"表格信息"),l.a.createElement("div",{className:"scroll-area"},l.a.createElement("div",{className:"file-info-item "},l.a.createElement("div",{className:"item-file-size"},this.getFileSize(),l.a.createElement("span",null,a()("数据大小"),":"))),l.a.createElement("div",{className:"file-info-item"},l.a.createElement("div",{className:"item-cell-count"},this.getAllCount("cellCount"),l.a.createElement("span",null,a()("单元格数量"),":")),this.getItemDetail("cellCount")),l.a.createElement("div",{className:"file-info-item"},l.a.createElement("div",{className:"item-formula-count"},this.getAllCount("formulaCount"),l.a.createElement("span",null,a()("公式数量"),":")),this.getItemDetail("formulaCount")),l.a.createElement("div",{className:"file-info-item"},l.a.createElement("div",{className:"item-filter-size"},this.getAllCount("filterDataSize"),l.a.createElement("span",null,a()("筛选视图"),":")),this.getItemDetail("filterDataSize")))),l.a.createElement("div",{className:"clean-target-area"},l.a.createElement("h3",{className:"area-title"},"清理对象"),l.a.createElement("div",{className:"scroll-area"},l.a.createElement("div",{className:"clear-target-item"},l.a.createElement("div",{className:"item-invalid-attrs"},this.getAllCount("invalidAttrCount"),l.a.createElement("span",null,a()("无效属性"),":"))),l.a.createElement("div",{className:"clear-target-item"},l.a.createElement("div",{className:"item-invalid-img"},this.getAllCount("invalidImagesCount"),l.a.createElement("span",null,a()("无效图片"),":"))),l.a.createElement("div",{className:"clear-target-item"},l.a.createElement("div",{className:"item-empty-row"},this.getAllCount("emptyRowCount"),l.a.createElement("span",null,a()("冗余空白行"),":"))),l.a.createElement("div",{className:"clear-target-item"},l.a.createElement("div",{className:"item-empty-col"},this.getAllCount("emptyColCount"),l.a.createElement("span",null,a()("冗余空白列"),":"))),l.a.createElement("div",{className:"clear-target-item"},l.a.createElement("div",{className:"item-invalid-data"},this.getInvalidDataTip(),l.a.createElement("span",null,a()("疑似冗余数据"),":")),this.getInvalidDataDetail())))),l.a.createElement("div",{className:"file-slimming-dialog-ft"},l.a.createElement("div",{className:"ft-tip"},this.statusTip),l.a.createElement("button",{className:i,onClick:this.handStatus},o))))},e}(s.Component);e.a=_},2723:function(t,e,n){"use strict";var r=n(0),i=n.n(r);e.a=function(t){var e=Object(r.useRef)(null),n=Object(r.useState)({left:"0",top:"0"}),o=n[0],a=n[1];return i.a.createElement("div",{className:"prompt",ref:e,onMouseEnter:function(){if(null!==e.current){var t=e.current.getBoundingClientRect(),n=t.right,r=t.top;a({left:n+10+"px",top:r-15+"px"})}},onMouseLeave:function(){a({display:"none"})}},i.a.createElement("div",{className:"prompt_inner",style:o},t.children))}},2724:function(t,e,n){t.exports=function(){return n(790)('!function(t){var r={};function n(e){if(r[e])return r[e].exports;var i=r[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=r,n.d=function(t,r,e){n.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:e})},n.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(r,"a",r),r},n.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},n.p="",n(n.s=13)}([function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=function(){function t(t,r){this.deltaConstructor=t,this.operatorConstructor=r}return t.prototype.compose=function(t,r,n){throw new Error("#compose() is not implemented")},t.prototype.transform=function(t,r,n){throw new Error("#transform() is not implemented")},t.prototype.invert=function(t,r){throw new Error("#invert() is not implemented")},t.prototype.parse=function(t){throw new Error("#parse() is not implemented")},t.prototype.pack=function(t,r){throw new Error("#pack() is not implemented")},t.prototype.toJSON=function(t){throw new Error("#toJSON() is not implemented")},t.prototype.explain=function(t,r){return""+t+r},t}();r.default=e},function(t,r,n){"use strict";var e;Object.defineProperty(r,"__esModule",{value:!0}),function(t){t[t.PUSHED=0]="PUSHED",t[t.MERGED=1]="MERGED",t[t.REORDERED=2]="REORDERED"}(e=r.PushResult||(r.PushResult={}));var i=function(){function t(t){void 0===t&&(t=[]),this.stringified=!1,this.ops=t}return t.prototype.push=function(t){if(this.stringified)throw new Error("Cannot push new operators to a stringified operatorList");var r=this.ops.length;if(0===r)return this.ops.push(t),e.PUSHED;var n=e.PUSHED,i=this.ops[r-1];if("remove"===i.action&&"insert"===t.action&&(r-=1,i=this.ops[r-1],n=e.REORDERED,void 0===i))return this.ops.unshift(t),n;var o=i.merge(t);return o?(this.ops[r-1]=o,n=e.MERGED):r===this.ops.length?this.ops.push(t):this.ops.splice(r,0,t),n},t.prototype.stringify=function(t){void 0===t&&(t=!1),this.stringified=!0;for(var r=this.ops.length,n="",e=0;e<r;e++){var i=this.ops[e];(!t||e<r-1||!i.isEmpty())&&(n+=i.stringify())}return n},t}();r.default=i},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TYPE_PROPERTY="__MODOC_NAME__"},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(8),i=n(9),o="0:",a=function(){function t(r,n){this.action=r.action;var e,i=r.data;if(null===i||void 0===i)throw new Error(\'"data" is required for an Operator\');if("object"==typeof i){var a=Object.keys(i)[0],u=i[a];if("string"==typeof u)this.data=i,this.dataType=a;else{var s=t.dataHandlers[a];if(!s)throw new Error(\'Unsupported nested data type "\'+a+\'"\');var f=s.pack(u,"insert"===this.action);"delta"===a&&f===o?(this.data=1,this.dataType="number"):(this.data=((e={})[a]=f,e),this.dataType=a)}}else this.data=i,this.dataType=typeof i;this.packedAttributes=r.packedAttributes,this.pool=r.pool,this.packedData=n}return t.isOperator=function(t){return"function"==typeof t.getAttributes},t.registerDataHandler=function(r,n){t.dataHandlers[r]=n},t.getUnresolvedAttributes=function(t){return"function"==typeof t.getUnresolvedAttributes?t.getUnresolvedAttributes():t.getAttributes()},Object.defineProperty(t.prototype,"length",{get:function(){return"string"==typeof this.data?this.data.length:"number"==typeof this.data?this.data:1},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return"retain"===this.action&&(""===this.packedAttributes||void 0===this.packedAttributes)&&"number"==typeof this.data},t.prototype.getParsedData=function(){var r=t.dataHandlers[this.dataType];if(void 0===r)throw new Error("Unknown handler for "+this.dataType);return r.parse(this.getCustomData())},t.prototype.hasAttributes=function(){return void 0!==this.packedAttributes&&""!==this.packedAttributes},t.prototype.getAttributes=function(){return void 0!==this.pool&&this.hasAttributes()?this.pool.unpackAttributes(this.packedAttributes):{}},t.prototype.stringify=function(){if(void 0===this.packedData){var t=this.data,r=void 0;switch(this.action){case"insert":r="!";break;case"retain":r="@";break;default:r="#"}if("number"==typeof t)r+=t.toString(36)+"#";else if("string"==typeof t)r+=t.length.toString(36)+"!"+t;else{var n=this.dataType;if(void 0===n)throw new Error("ASSERT: dataType === undefined");var i=e.objectKeyToInitial[n];if(!i)throw new Error(\'Unsupport object data type: "\'+n+\'"\');var o=""+i+t[n];r+=o.length.toString(36)+"@"+o}this.packedData=r}var a=void 0===this.packedAttributes?this.packedData:this.packedData+this.packedAttributes;return a.length.toString(36)+a},t.prototype.merge=function(r){if(this.action!==r.action)return null;var n=typeof this.data;if("object"===n||n!==typeof r.data)return null;var e=this.hasAttributes();if(e!==r.hasAttributes())return null;if(e)if(this.pool===r.pool){if(this.packedAttributes!==r.packedAttributes)return null}else if(!function(t,r){if(t===r)return!0;var n=Object.keys(t),e=n.length;if(e!==Object.keys(r).length)return!1;for(var i=0;i<e;i++)if(t[n[i]]!==r[n[i]])return!1;return!0}(this.getUnresolvedAttributes(),t.getUnresolvedAttributes(r)))return null;return new t({action:this.action,data:this.data+r.data,pool:this.pool,packedAttributes:this.packedAttributes})},t.prototype.getCustomData=function(){switch(typeof this.data){case"string":case"number":throw new Error("Cannot get custom data from a simple operator");default:return this.data[this.dataType]}},t.prototype.compose=function(r,n){if("remove"===this.action)throw new Error("Removing operator cannot compose other operators");if("retain"!==r.action)throw new Error("Only retaining operator can be composed");var e,a,u,s=!1;if(r.hasAttributes()){if(void 0===this.pool)throw new Error("this.pool is undefined when composing");var f=t.getUnresolvedAttributes(r);s=f.hasOwnProperty("cellValue");var c=i.merge(this.getUnresolvedAttributes(),f,!n);a=this.pool.packAttributes(c)}else a=this.packedAttributes;if(s)e="number"===r.dataType?r.data:1;else if("number"===this.dataType)e=r.data;else if("number"===r.dataType)e=this.data;else{if(void 0===this.dataType)throw new Error(\'Missing "dataType" when composing \'+this.data+" with "+r.data);if(this.dataType!==r.dataType)throw new Error("Expect "+r.dataType+" to equal "+this.dataType+" when composing "+this.data+" with "+r.data);var l=t.dataHandlers[this.dataType];if(void 0===l)throw new Error("Unknown handler for "+this.dataType);var h=l.compose(this.getCustomData(),r.getCustomData(),n);e="delta"===this.dataType&&h===o?1:((u={})[this.dataType]=h,u)}return new t({action:this.action,data:e,pool:this.pool,packedAttributes:a})},t.prototype.transform=function(r,n){if(void 0===n&&(n=!1),"retain"!==this.action)throw new Error("Only retaining operator can transform other operators");if("retain"!==r.action)throw new Error("Only retaining operator can be transformed");var e,a,u;if("number"===this.dataType||"number"===r.dataType)e=r.data;else{if(void 0===this.dataType)throw new Error(\'Missing "dataType" when transforming \'+this.data+" with "+r.data);if(this.dataType!==r.dataType)throw new Error("Expect "+r.dataType+" to equal "+this.dataType+" when transforming "+this.data+" with "+r.data);var s=t.dataHandlers[this.dataType];if(void 0===s)throw new Error("Unknown handler for "+this.dataType);var f=s.transform(this.getCustomData(),r.getCustomData(),n);e="delta"===this.dataType&&f===o?1:((u={})[this.dataType]=f,u)}if(r.hasAttributes()){var c=i.transform(this.getUnresolvedAttributes(),t.getUnresolvedAttributes(r),n);if(void 0===r.pool)throw new Error("ASSERT: other.pool === undefined when transforming");a=r.pool.packAttributes(c)}else a="";return new t({action:this.action,data:e,pool:r.pool,packedAttributes:a})},t.prototype.invert=function(r,n){if("insert"!==this.action)throw new Error(\'invert should only apply to the "insert" action (\'+this.dataType+")");if("retain"!==r.action)throw new Error("Only retaining operator can be inverted");var e,a,u,s=!1;if(r.hasAttributes()){var f=t.getUnresolvedAttributes(r);s=f.hasOwnProperty("cellValue");var c=i.invert(this.getUnresolvedAttributes(),f);if(void 0===r.pool)throw new Error("ASSERT: other.pool === undefined when inverting");a=r.pool.packAttributes(c)}else a="";if(s)e=this.data;else if(void 0!==n)e=n;else if("number"==typeof r.data)e=r.data;else if("number"==typeof this.data&&"delta"!==r.dataType)e=this.data;else{if(void 0===this.dataType)throw new Error(\'Missing "dataType" when inverting \'+this.data+" with "+r.data);if("number"===this.dataType&&"delta"===r.dataType){e={delta:(l=t.dataHandlers.delta).invert(o,r.getCustomData())}}else{if(this.dataType!==r.dataType)throw new Error("Expect "+r.dataType+" to equal "+this.dataType+" when inverting "+this.data+" with "+r.data);var l;if(void 0===(l=t.dataHandlers[this.dataType]))throw new Error("Unknown handler for "+this.dataType);var h=l.invert(this.getCustomData(),r.getCustomData());e="delta"===this.dataType&&h===o?1:((u={})[this.dataType]=h,u)}}return new t({data:e,action:"retain",pool:r.pool,packedAttributes:a})},t.prototype.toJSON=function(){var r,n={action:this.action};if(this.hasAttributes()&&(n.attributes=this.getAttributes()),"number"===this.dataType||"string"===this.dataType)n.data=this.data;else{var e=t.dataHandlers[this.dataType],i=this.getCustomData();n.data=((r={})[this.dataType]=e?e.toJSON(i):i,r)}return n},t.prototype.explain=function(r){void 0===r&&(r="");var n=this.stringify().length,e=r+"["+this.dataType+"("+this.action+")] #"+(n-String(n).length)+":\\n";if("number"===this.dataType||"string"===this.dataType)e+=r+this.data;else{var i=t.dataHandlers[this.dataType],o=this.getCustomData();e+=i?i.explain(r+"  ",o):o}return e+"\\n"+r+"PackedAttributes:"+this.packedAttributes+"\\n"},t.prototype.getUnresolvedAttributes=function(){return void 0!==this.pool&&this.hasAttributes()?this.pool.unpackAttributes(this.packedAttributes,!1):{}},t.dataHandlers={},t}();r.default=a},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(5);r.Delta=e.Delta;var i=n(7);r.Pool=i.default},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(6);r.Delta=e.default;var i=n(3);n(17).registerDataHandlers(i.default,e.default,i.default)},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(1),i=n(7),o=n(2),a=n(3),u=n(16),s=n(10),f=function(){function t(t,r){if(this[o.TYPE_PROPERTY]="Delta",Array.isArray(t)){var n=new e.default;i.default.isPool(r)&&0!==t.length||(r=new i.default);for(var u=0,s=t;u<s.length;u++){var f=s[u],c=r.packAttributes(f.attributes);n.push(new a.default({action:f.action,data:f.data,pool:r,packedAttributes:c}))}this.ops=n.stringify(!0),this.pool=r}else if(void 0===r){var l=t.indexOf(":");if(l<=0)throw new Error("Invalid delta: "+t);var h=parseInt(t.substring(0,l),36);if(isNaN(h))throw new Error("Invalid delta: "+t);var v=l+1+h;this.ops=t.substring(l+1,v),this.pool=0===h||t.length===v?new i.default:new i.default(t.substring(l+h+1))}else this.ops=t,this.pool=""===t?new i.default:r}return t.prototype.isEmpty=function(){return 0===this.ops.length},t.prototype.getIter=function(t){var r=void 0===t?{}:t,n=r.targetPool,e=r.sourcePool;return new u.default(this.ops,e||this.pool,n||this.pool,a.default)},Object.defineProperty(t.prototype,"length",{get:function(){for(var t=this.getIter(),r=0;t.hasNext();)r+=t.peekLength(),t.skip();return r},enumerable:!0,configurable:!0}),t.prototype.getPoolCopy=function(){return this.pool.clone()},t.prototype.map=function(r){for(var n=[],e=this.getIter();e.hasNext();)n.push(r(e.next()));return new t(n)},t.prototype.compose=function(r,n){var i=this.getPoolCopy(),o=new e.default([]),a=this.getIter({sourcePool:i,targetPool:i});Array.isArray(r)&&(r=new t(r,i));for(var u=r.getIter({targetPool:i});;){var s=a.hasNext(),f=u.hasNext();if(!s&&!f)break;if(!f)return new t(a.remainingStrs(o),i);if(!s&&u.isPoolCompatible())return new t(u.remainingStrs(o),i);if("insert"===u.peekAction())o.push(u.next());else if("remove"===a.peekAction())o.push(a.next());else{var c=Math.min(a.peekLength(),u.peekLength()),l=s?a.next(c):null,h=u.next(c);"retain"===h.action?o.push(l?l.compose(h,void 0===n?"insert"===l.action:n):h):l&&"retain"!==l.action||o.push(h)}}return new t(o.stringify(!0),i)},t.prototype.transform=function(r,n){void 0===n&&(n=!1),Array.isArray(r)&&(r=new t(r));for(var i=r.getPoolCopy(),o=new e.default,u=this.getIter(),s=r.getIter({sourcePool:i,targetPool:i});s.hasNext();){if(!u.hasNext())return new t(s.remainingStrs(o),i);if("insert"!==u.peekAction()||!n&&"insert"===s.peekAction())if("insert"===s.peekAction())o.push(s.next());else{var f=Math.min(u.peekLength(),s.peekLength()),c=u.next(f),l=s.next(f);if("remove"===c.action){if(c.hasAttributes()||"remove"===l.action&&l.hasAttributes())throw new Error("Cannot transform removing operations with attributes");continue}if("remove"===l.action){if(l.hasAttributes())throw new Error("Cannot transform removing operations with attributes");o.push(l)}else o.push(c.transform(l,n))}else o.push(new a.default({action:"retain",data:u.peekLength()})),u.skip()}return new t(o.stringify(!0),i)},t.prototype.invert=function(r,n){for(var o=new i.default,u=new e.default,s=this.getIter({targetPool:o}),f=(Array.isArray(r)?new t(r,new i.default):r).getIter({targetPool:o});f.hasNext();)if("insert"===f.peekAction())u.push(new a.default({action:"remove",data:f.peekLength()})),f.skip();else{if(!s.hasNext())throw new Error("Delta should be smaller than document");if("insert"!==s.peekAction())throw new Error("Only document can invert deltas");var c=Math.min(s.peekLength(),f.peekLength()),l=f.next(c),h=s.next(c);"remove"===l.action?u.push(h):u.push(n?n(h,l):h.invert(l))}return new t(u.stringify(!0),o)},t.prototype.stringify=function(){return this.isEmpty()?"0:":this.ops.length.toString(36)+":"+this.ops+this.pool.stringify()},t.prototype.toJSON=function(){for(var t=[],r=this.getIter();r.hasNext();)t.push(r.next().toJSON());return t},t.prototype.explain=function(t){void 0===t&&(t="");for(var r=t+"Delta #"+this.ops.length+":\\n",n=this.getIter();n.hasNext();)r+=n.next().explain(t+"  ");return""+r+t+"Pool: "+this.pool.stringify()+"\\n"},t.prototype.validateTable=function(){for(var t={},r=this.getIter();r.hasNext();){var n=r.next();if("table"===n.dataType){var e=n.getAttributes().name;if("string"!=typeof e)continue;var i="$$"+e+"$$";if(t.hasOwnProperty(i))throw new Error("Duplicated table name found: "+e);t[i]=!0}}return this},t.isDelta=s.isDelta,t}();r.default=f},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(2),i=n(14),o=n(15),a=!1,u=!1,s=function(){function t(t){void 0===t&&(t={array:[],packedData:""}),this[e.TYPE_PROPERTY]="Pool",this.cache={},"string"==typeof t?(this.array=JSON.parse(t),this.packedData=t):(this.array=t.array,this.packedData=t.packedData)}return t.isPool=function(t){return"object"==typeof t&&null!==t&&"Pool"===t[e.TYPE_PROPERTY]},t.setIPoolConfig=function(t){t&&(a=!!t.enableCache,u=!!t.enableNullIgnore)},t.prototype.isSubsetOf=function(t){if(this===t)return!0;var r=this.array.length;if(0===r)return!0;if(r>t.array.length)return!1;for(var n=0;n<r;n++)if(this.array[n]!==t.array[n])return!1;return!0},t.prototype.getMap=function(){if(!this.map){this.map={};for(var t=0;t<this.array.length;t++)this.map[this.array[t]]=String(t)}return this.map},t.prototype.packAttributes=function(t){if(!t)return"";var r=Object.keys(t),n=r.length;if(0===n)return"";for(var e=[],i=[],a=0;a<n;a++){var u=r[a],s=t[u];if("object"==typeof s&&null!==s)for(var f=0,c=o.objectToKeyPaths(s,"."+u);f<c.length;f++){var l,h=c[f];" "===(l=this.getAddress(h[0],h[1]))[0]?e.push(l):i.push(l)}else" "===(l=this.getAddress(u,s))[0]?e.push(l):i.push(l)}return i.sort().join("")+e.sort().join("")},t.prototype.getAddress=function(t,r){var n=i.combinedAttributeWithValue(t,r),e=i.getGulByCombinedKeyValue(n);if("string"==typeof e)return e;var o=this.getMap();if(!o.hasOwnProperty(n)){this.packedData=void 0;var a=this.array.length;o[n]=String(a),this.array.push(n)}return" "+o[n]},t.prototype.unpackAttributes=function(t,r){void 0===r&&(r=!0);for(var n={},e=0;e<t.length&&" "!==t[e];){var s=i.getKeyValueByGul(t[e]),f=s[0],c=s[1];r&&"."===f[0]?o.keyPathToObject(n,f,c):n[f]=c,e+=1}if(e<t.length-1)for(var l=0,h=t.substring(e+1).split(" ");l<h.length;l++){var v=h[l],d=a?this.cache[v]||(this.cache[v]=i.parseCombinedAttributeValue(this.array[v])):i.parseCombinedAttributeValue(this.array[v]);f=d[0],c=d[1];r&&"."===f[0]?o.keyPathToObject(n,f,c):u&&null===c||(n[f]=c)}return n},t.prototype.stringify=function(){return"string"!=typeof this.packedData&&(this.packedData=this.array.length?JSON.stringify(this.array):""),this.packedData},t.prototype.clone=function(){return new t({array:this.array.slice(),packedData:this.packedData})},t}();r.default=s},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.initialToObjectKey={A:"attachment",C:"cell",I:"image",D:"delta",T:"table",P:"presentation",S:"slide",M:"mention",N:"inline-break",V:"divide",U:"upload-placeholder-attachment",G:"gallery",B:"gallery-block",Z:"mindmap",O:"object",F:"form"},r.objectKeyToInitial=Object.keys(r.initialToObjectKey).reduce(function(t,n){return t[r.initialToObjectKey[n]]=n,t},{})},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.merge=function(t,r,n){var e=Object.keys(t);if(n&&0===e.length)return r;for(var i=0,o=Object.keys(r);i<o.length;i++){var a=o[i];t[a]=r[a],n||null!==t[a]||delete t[a]}return t},r.transform=function(t,r,n){if(n)return r;var e=Object.keys(r);if(0===e.length)return r;var i=Object.keys(t);if(0===i.length)return r;if(i.length>e.length)for(var o=0,a=e;o<a.length;o++){var u=a[o];t.hasOwnProperty(u)&&delete r[u]}else for(var s=0,f=i;s<f.length;s++)delete r[f[s]];return r},r.invert=function(t,r){var n=Object.keys(r);if(0===n.length)return r;if(0===Object.keys(t).length)for(var e=0,i=n;e<i.length;e++)r[u=i[e]]=null;else for(var o=0,a=n;o<a.length;o++){var u,s=t[u=a[o]];r[u]=void 0===s?null:s}return r}},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(2);r.isDelta=function(t){return"object"==typeof t&&null!==t&&"Delta"===t[e.TYPE_PROPERTY]}},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.possibleDeltaInputToString=function(t,r){if(void 0===r||null===r)return"";if(Array.isArray(r)){if(0===r.length)return"";var n=new t(r);return n.isEmpty()?"":n.stringify()}return r.isEmpty()?"":r.stringify()}},function(t,r,n){"use strict";var e,i=this&&this.t||(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(r,"__esModule",{value:!0});var o=n(11),a=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return i(r,t),r.prototype.compose=function(t,r,n){for(var e=this.parse(t).slice(0),i=this.parse(r).slice(0),o=Math.max(e.length,i.length),a=new Array(o),u=0;u<o;u++){var s=e[u],f=i[u];a[u]=s?f?s.compose(f,n):s:f}return this.pack(a)},r.prototype.transform=function(t,r,n){for(var e=this.parse(t).slice(0),i=this.parse(r).slice(0),o=Math.max(e.length,i.length),a=new Array(o),u=0;u<o;u++){var s=e[u],f=i[u];a[u]=s?f?s.transform(f,n):void 0:f}return this.pack(a)},r.prototype.invert=function(t,r){for(var n=this.parse(t).slice(0),e=this.parse(r).slice(0),i=Math.max(n.length,e.length),o=new Array(i),a=0;a<i;a++){var u=n[a],s=e[a];o[a]=u?s?u.invert(s):void 0:s}return this.pack(o)},r.prototype.parse=function(t){for(var r=0,n=[];r<t.length;){var e=t.indexOf("$",r);if(-1===e)break;var i=parseInt(t.substring(r,e),36),o=e+1+i,a=0===i?void 0:new this.deltaConstructor(t.substring(e+1,o));r=o,n.push(a)}return n},r.prototype.pack=function(t){for(var r="",n=0,e=t;n<e.length;n++){var i=e[n],a=o.possibleDeltaInputToString(this.deltaConstructor,i);r+=a.length.toString(36)+"$"+a}return r},r.prototype.toJSON=function(t){return this.parse(t).map(function(t){return t?t.toJSON():void 0})},r.prototype.explain=function(t,r){for(var n=t+"List:\\n",e=this.parse(r),i=0;i<e.length;i++){var o=e[i];n+=t+"Item #"+i+":\\n",n+=o?o.explain(t):"[EMPTY]"}return n},r}(n(0).default);r.default=a},function(t,r,n){var e=function(){return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,r){var n=[],e=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(e=(a=u.next()).done)&&(n.push(a.value),!r||n.length!==r);e=!0);}catch(t){i=!0,o=t}finally{try{!e&&u.return&&u.return()}finally{if(i)throw o}}return n}(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(4);function a(t,r){var n={};for(var e in t)r.indexOf(e)>=0||Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n}var u=function(t,r,n,o){var a=c(t),u=l(r),h=o.maxEmptyRows,p=o.maxEmptyCols,g={rowCount:a,colCount:u,cellCount:a*u,formulaCount:0,invalidRowPos:null,invalidColPos:null,invalidCells:{},invalidAttrCount:0},y={},O={},_=-1,j=-1,E=0;for(var k in r.forEach(function(t){var r=t.data,n="number"==typeof r?r:1,o=0;"object"===(void 0===r?"undefined":i(r))&&r.delta.forEach(function(t){var r=t.attributes,n=t.data,i="number"==typeof n?n:1,a=d(r),u=v(r),s=w(r),f=e(s,2),c=f[0],l=f[1];if(u&&(g.formulaCount+=i),a){for(var h=0;h<i;h++){var b=o+h;void 0===y[b]&&(y[b]=E)}void 0===O[E]&&(O[E]=o)}if(c)for(var p=0;p<i;p++){var m=o+p;(g.invalidCells[E]||(g.invalidCells[E]={}))[m]=[m,E,l],g.invalidAttrCount+=1}o+=i});E+=n}),n){if(0===k.indexOf("pivot-table"))try{var M=JSON.parse(n[k]).location,A=m(M),S=A.row,P=A.col;y[S]=P,O[P]=S}catch(t){}if("fixedColumnsLeft"===k){var I=n[k]-1;O[I]=0,j=I}if("fixedRowsTop"===k){var x=n[k]-1;y[x]=0,_=x}}var C=b(n);for(var D in C)g[D]=C[D];var T=s(y,h,_),N=e(T,2),R=N[0],Y=N[1];R&&(g.invalidRowPos={row:R,col:Y});var z=s(O,p,j),$=e(z,2),J=$[0],L=$[1];return J&&(g.invalidColPos={row:L,col:J}),g.emptyRowCount=f(y,a,h),g.emptyColCount=f(O,u,p),g},s=function(t,r,n){var e=0;for(var i in t){var o=~~i;if(o-e>=r&&n!==o)return[o,t[i]];e=o}return[]},f=function(t,r,n){var e=Object.keys(t).map(function(t){return~~t}).sort(function(t,r){return t-r>0?1:-1}),i=r-(e[e.length-1]||0);return i>=n?r-i<n?Math.max(i-n,0):i:0},c=function(t){var r=0;return t.forEach(function(t){var n=t.data;r+="number"==typeof n?n:1}),r},l=function(t){var r=0;return t.forEach(function(t){var n=t.data;r+="number"==typeof n?n:1}),r},h=function(t){return Math.ceil(t.stringify().length/1024)},v=function(t){return!!t&&!p(t.formula)},d=function(t){if(!t)return!1;var r=t.formula,n=t.link,e=t.backgroundImage,i=t.cellValue;return!(p(i)&&p(r)&&p(n)&&p(e))},b=function(t){var r=0,n=0,i={};for(var o in t){if(0===o.indexOf("picture-")){var a=JSON.parse(t[o]).slice(-3),u=e(a,3),s=u[0],f=u[1];u[2];(s<=1||f<=1)&&(i[o]=null,n+=1)}0===o.indexOf("filter_")&&(r+=Math.floor(t[o].length/1024))}return{invalidImages:i,invalidImagesCount:n,filterDataSize:r}},w=function(t){if(!t)return[!1];var r={},n=!1;for(var e in t){var i=t[e];(null===i||void 0===i||""===i&&"cellValue"!==e)&&(r[e]=null,n=!0)}return[n,{attrs:r}]},p=function(t){return void 0===t||null===t||""===t},m=function(t){for(var r=0,n=0,e=0;e<t.length;e++){var i=t[e].charCodeAt(0);if(i>=65&&i<=90)n=26*n+i-64;else{if(!(i>=48&&i<=57))return null;r=10*r+i-48}}return{row:r-1,col:n-1}};self.addEventListener("message",function(t){var r=t.data;switch(r.cmd){case"scan":!function(t,r){var n={fileSize:0,sheets:{}},e={fileSize:0,sheets:{},current:""},i=h(t);n.fileSize=i,e.fileSize=i;var s=t.getIter();for(o.Pool.setIPoolConfig({enableCache:!0});s.hasNext();){var f=s.next();e.current=f.getAttributes().name,postMessage({cmd:"data",data:e});var c=f.toJSON(),l=c.data,v=c.attributes,d=l.table,b=d.rows,w=d.cols,p=u(b,w,v,r),m=(p.invalidCells,a(p,["invalidCells"]));n.sheets[v.id]=p,e.sheets[v.id]=m,postMessage({cmd:"data",data:e})}postMessage({cmd:"done",data:n}),o.Pool.setIPoolConfig({}),self.close()}(new o.Delta(r.content),r.opts)}})},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.keyToGul={color:"0",background:"1","font-size":"2",width:"3",height:"4",rowspan:"5",colspan:"6",align:"7",bold:"8",italic:"9",underline:"a",vertical:"b",strike:"c",wrap:"d",fixedRowsTop:"e",fixedColumnsLeft:"f",link:"g",format:"h",formula:"i",filter:"j","border-top":"k","border-right":"l","border-bottom":"m","border-left":"n",line:"o",guid:"p",author:"q",size:"r",list:"s",layout:"t",margin:"u",font:"v",header:"w",indent:"x",comment:"y","comment-block":"z","code-block":"A",name:"B",order:"C",autoFit:"D",userID:"E",nextIndex:"F",id:"G",colVisible:"H",rowVisible:"I",autoFormatter:"J",copyIndex:"K",manualAlign:"L",lock:"M",left:"N",top:"O"};var e=["color","background","font-size","width","height","rowspan","colspan","align","bold","italic","underline","vertical","strike","wrap","fixedRowsTop","fixedColumnsLeft","link","format","formula","filter","border-top","border-right","border-bottom","border-left","line","guid","author","size","list","layout","margin","font","header","indent","comment","comment-block","code-block","name","order","autoFit","userID","nextIndex","id","colVisible","rowVisible","autoFormatter","copyIndex","manualAlign","lock","left","top","cellValue"];function i(t){var r,n=t.charCodeAt(0);if(n>=48&&n<=57)r=e[n-48];else if(n>=65&&n<=90)r=e[n-29];else{if(!(n>=97&&n<=122))throw new Error(\'Unknown gul "\'+t+\'"\');r=e[n-87]}return r}function o(t){var n=r.keyToGul[t];if(n)return n;var e=t.length.toString(36),i=e.length;if(i>2)throw new Error("Key length of attribute should <= 2: "+e);return""+(1===i?"$":"%")+e+t}r.getAttributeKeyByGul=i,r.getGulByAttributeKey=o,r.combinedAttributeWithValue=function(t,r){var n=o(t);return"string"==typeof r?n+":"+r:"number"==typeof r?n+"*"+r.toString():"boolean"==typeof r?n+(r?"1":"0"):n},r.keyValueToGul={81:"!","2*12":\'"\',"2*11":"#","2*10":"$","2*9":"%","2*8":"&","6*2":"\'","6*3":"(","6*4":")","5*2":"*","5*3":"+","5*4":",","0:#ff0000":"-","0:#ffffff":".","b:bottom":"/","h:normal":"0",1:"1","1:#ffffff":"2","1:#ff0000":"3","1:#ffff00":"4","1:#00ffff":"5","7:left":"6","7:center":"7","7:right":"8","1*4":"9","d:text-wrap":":","d:text-no-wrap":";","h:YYYY/MM/DD":"<",\'l:["",1]\':"=",\'n:["",1]\':">",\'k:["",1]\':"?",\'m:["",1]\':"@",\'l:["#2b2b2b",1]\':"A",\'n:["#2b2b2b",1]\':"B",\'k:["#2b2b2b",1]\':"C",\'m:["#2b2b2b",1]\':"D"};var a=[["bold",!0],["font-size",12],["font-size",11],["font-size",10],["font-size",9],["font-size",8],["colspan",2],["colspan",3],["colspan",4],["rowspan",2],["rowspan",3],["rowspan",4],["color","#ff0000"],["color","#ffffff"],["vertical","bottom"],["format","normal"],["background",null],["background","#ffffff"],["background","#ff0000"],["background","#ffff00"],["background","#00ffff"],["align","left"],["align","center"],["align","right"],["background",4],["wrap","text-wrap"],["wrap","text-no-wrap"],["format","YYYY/MM/DD"],["border-right",\'["",1]\'],["border-left",\'["",1]\'],["border-top",\'["",1]\'],["border-bottom",\'["",1]\'],["border-right",\'["#2b2b2b",1]\'],["border-left",\'["#2b2b2b",1]\'],["border-top",\'["#2b2b2b",1]\'],["border-bottom",\'["#2b2b2b",1]\']];r.getGulByCombinedKeyValue=function(t){return r.keyValueToGul.hasOwnProperty(t)?r.keyValueToGul[t]:null},r.getKeyValueByGul=function(t){var r=t.charCodeAt(0)-33;return a[r]},r.parseCombinedAttributeValue=function(t){var r;if("$"===t[0]){var n=parseInt(t[1],36);r=t.substring(2,2+n),t=t.substring(1+n)}else"%"===t[0]?(n=parseInt(t[1]+t[2],36),r=t.substring(3,3+n),t=t.substring(2+n)):r=i(t[0]);if(1===t.length)return[r,null];var e=t[1];if("1"===e)return[r,!0];if("0"===e)return[r,!1];var o=t.substring(2);return[r,":"===e?o:Number(o)]}},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.objectToKeyPaths=function t(r,n,e){void 0===e&&(e=[]);for(var i=0,o=Object.keys(r);i<o.length;i++){var a=o[i],u=r[a],s=n+"."+a;"object"==typeof u&&null!==u?t(u,s,e):e.push([s,u])}return e},r.keyPathToObject=function(t,r,n){for(var e=r.split("."),i=e.length,o=1;o<i-1;o++){var a=e[o],u=t[a];t="object"==typeof u&&null!==u?u:t[a]={}}var s=e[i-1];null===n&&void 0!==t[s]&&null!==t[s]||(t[s]=n)}},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(8),i=n(1),o=function(){function t(t,r,n,e){this.ops=t,this.pool=r,this.targetPool=n,this.operatorConstructor=e,this.cursor=0,this.offset=0}return t.prototype.isPoolCompatible=function(){return void 0===this.isCompatible&&(this.isCompatible=this.pool.isSubsetOf(this.targetPool)),this.isCompatible},t.prototype.hasNext=function(){return this.cursor<this.ops.length},t.prototype.remainingStrs=function(t){for(;this.hasNext();){var r=this.next();if(t.push(r)!==i.PushResult.REORDERED){var n=this.cursor;return this.cursor=this.ops.length,this.nextData=void 0,t.stringify()+this.ops.substring(n)}}return t.stringify(!0)},t.prototype.skip=function(t){void 0===t&&(t=1/0);var r=this.peekNext();if(null===r)throw new Error("No more operators");var n,e=this.offset;return t+e>=r.dataLength?(n=r.dataLength-e,this.nextData=void 0,this.cursor=r.opIndex+r.opLength,this.offset=0):(n=t,this.offset+=n),[n,e,r]},t.prototype.next=function(t,r){void 0===t&&(t=1/0);var n,i=this.skip(t),o=i[0],a=i[1],u=i[2];switch(u.dataType){case"number":n=o;break;case"string":n=this.ops.substring(u.dataIndex+1+a,u.dataIndex+1+a+o);break;default:var s=this.ops[u.dataIndex+1+a],f=this.ops.substring(u.dataIndex+1+1,u.dataIndex+1+u.actualLength);(l={})[e.initialToObjectKey[s]]=f,n=l}var c,l,h=this.ops.substring(u.dataIndex+1+u.actualLength,u.opIndex+u.opLength),v=this.targetPool,d=""!==h&&!this.isPoolCompatible();return 0!==a||o!==u.dataLength||d||(c=this.ops.substring(u.opIndex,u.dataIndex+1+u.actualLength)),d&&(h=v.packAttributes(this.pool.unpackAttributes(h))),new this.operatorConstructor({action:r||u.action,data:n,packedAttributes:h,pool:v},c)},t.prototype.peekAction=function(){var t=this.peekNext();return null===t?"retain":t.action},t.prototype.peekLength=function(){var t=this.peekNext();return null===t?1/0:t.dataLength-this.offset},t.prototype.peekNext=function(){if(!this.hasNext())return null;if(void 0===this.nextData){var t=void 0,r=void 0;r=this.cursor+1;for(var n=this.ops.length;r<n;){switch(this.ops[r]){case"!":t="insert";break;case"@":t="retain";break;case"#":t="remove"}if(void 0!==t)break;r+=1}var e=r,i=parseInt(this.ops.substring(this.cursor,e),36);r=e+1;for(var o=void 0;r<n;){switch(this.ops[r]){case"!":o="string";break;case"#":o="number";break;case"@":o="object"}if(void 0!==o)break;r+=1}var a=r,u=parseInt(this.ops.substring(e+1,a),36),s="number"===o?0:u,f="object"===o?1:u;this.nextData={action:t,dataIndex:a,dataLength:f,opIndex:e,opLength:i,dataType:o,actualLength:s}}return this.nextData},t}();r.default=o},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(18),i=n(20),o=n(21),a=n(22),u=n(23),s=n(12);r.registerDataHandlers=function(t,r,n){var f=function(t,r){return function(n){return new n(t,r)}}(r,n);t.registerDataHandler("delta",f(i.default)),t.registerDataHandler("table",f(e.default)),t.registerDataHandler("presentation",f(a.default)),t.registerDataHandler("slide",f(o.default)),t.registerDataHandler("mindmap",f(o.default)),t.registerDataHandler("object",f(u.default)),t.registerDataHandler("form",f(s.default))}},function(t,r,n){"use strict";var e,i=this&&this.t||(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(r,"__esModule",{value:!0});var o=n(11),a=n(19),u=n(0),s=n(4),f=n(1),c=n(6),l=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return i(r,t),r.prototype.pack=function(t){var r=t.rows,n=t.cols,e=o.possibleDeltaInputToString(this.deltaConstructor,r),i=o.possibleDeltaInputToString(this.deltaConstructor,n);return e.length.toString(36)+"$"+e+i},r.prototype.toJSON=function(t){var r=this.parse(t),n=r[0],e=r[1];return{rows:null===n?null:n.toJSON(),cols:null===e?null:e.toJSON()}},r.prototype.explain=function(t,r){var n=t+"Rows:\\n",e=this.parse(r),i=e[0],o=e[1];return n+=null===i?"[EMPTY]":i.explain(t),n+=t+"Cols:\\n",n+=null===o?"[EMPTY]":o.explain(t)},r.prototype.parse=function(t){var r=t.indexOf("$"),n=parseInt(t.substring(0,r),36),e=r+1+n;return[0===n?null:new this.deltaConstructor(t.substring(r+1,e)),t.length===e?null:new this.deltaConstructor(t.substring(e))]},r.prototype.compose=function(t,r,n){var e=this.parse(t),i=e[0],o=e[1],u=this.parse(r),s=u[0],f=u[1],c=null===s?i:null===i?s:i.compose(s,n),l=a.reindexInnerDeltas(o,s),h=null===f?l:null===l?f:l.compose(f,n);return this.pack({rows:c,cols:h})},r.prototype.transform=function(t,r,n){var e=this.parse(t),i=e[0],o=e[1],u=this.parse(r),s=u[0],f=u[1],c=null===i||null===s?s:i.transform(s,n),l=null===i||null===s?i:s.transform(i,!n),h=a.reindexInnerDeltas(o,c),v=a.reindexInnerDeltas(f,l),d=null===h||null===v?v:h.transform(v,n);return this.pack({rows:c,cols:d})},r.prototype.invert=function(t,r){var n=this,e=this.parse(t),i=e[0],o=e[1],u=this.parse(r),l=u[0],h=u[1],v=l&&(null===i?new this.deltaConstructor([]):i).invert(l),d=a.invertInnerDeltas(o,l);if(null!==h){var b=null===o?new c.default([]):o;if(d){var w=a.DeltaToIndexModifiers(h);d=a.reindexDelta(d,w)}var p=a.reindexInnerDeltas(h,v);if(null===p)throw new Error("ASSERT: targetCols === null");var m=b.invert(p,function(t,r){if("delta"!==r.dataType)return t.invert(r);for(var e=new s.Pool,i=new f.default([]),o="number"===t.dataType?null:new n.deltaConstructor(t.getCustomData()).getIter({targetPool:e}),a=new n.deltaConstructor(r.getCustomData()).getIter({targetPool:e});a.hasNext();){var u=void 0,c=void 0;if(null!==o&&o.hasNext()){var l=Math.min(o.peekLength(),a.peekLength());u=o.next(l,"insert"),c=a.next(l)}else{var h=a.peekLength();u=new n.operatorConstructor({action:"insert",data:h}),c=a.next()}i.push(u.invert(c))}return t.invert(r,{delta:new n.deltaConstructor(i.stringify(!0),e).stringify()})});d=d?d.compose(m):m}return this.pack({rows:v,cols:d})},r}(u.default);r.default=l},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(1),i=n(5),o=n(3);function a(t){for(var r=[],n=-1,e=t.getIter();e.hasNext();){var i=e.next(),o=i.action,a=i.length;-1!==n&&r[n][0]===o?r[n][1]+=a:r[++n]=[o,a]}return r}function u(t,r){for(var n=t.getPoolCopy(),a=new e.default([]),u=t.getIter({sourcePool:n,targetPool:n}),s=new Array(r.length),f=0;f<r.length&&u.hasNext();f++){var c=s[f]||r[f],l=c[0],h=c[1];switch(l){case"insert":a.push(new o.default({action:"retain",data:h,packedAttributes:"",pool:n}));break;case"retain":(v=u.peekLength())>=h?a.push(u.next(h)):(a.push(u.next()),s[f]=["retain",h-v],f-=1);break;case"remove":var v;(v=u.peekLength())>=h?u.skip(h):(u.skip(),s[f]=["remove",h-v],f-=1)}}for(;u.hasNext();)a.push(u.next());return new i.Delta(a.stringify(!0),n)}r.DeltaToIndexModifiers=a,r.reindexDelta=u,r.reindexInnerDeltas=function(t,r){if(null===t||null===r)return t;var n=a(r);return 0===n.length?t:t.map(function(t){var r={action:t.action,data:t.data};if("remove"!==r.action&&t.hasAttributes()&&(r.attributes=t.getAttributes()),"delta"===t.dataType){var e=u(new i.Delta(t.getCustomData()),n);r.data=e.isEmpty()?1:{delta:e.stringify()}}else r.data=t.data;return r})},r.invertInnerDeltas=function(t,r){if(null===t||null===r)return null;for(var n=a(r),u=!1,s=0,f=n;s<f.length;s++)if("remove"===f[s][0]){u=!0;break}return u?t.map(function(t){var r={action:"retain",data:t.data};if(t.hasAttributes()&&(r.attributes=t.getAttributes()),"delta"===t.dataType){var a=function(t,r){for(var n=t.getPoolCopy(),a=new e.default([]),u=t.getIter({sourcePool:n,targetPool:n}),s=new Array(r.length),f=0;f<r.length&&u.hasNext();f++){var c=s[f]||r[f],l=c[0],h=c[1];switch(l){case"retain":var v=u.peekLength(),d=Math.min(h,v);a.push(new o.default({action:"retain",data:d,packedAttributes:"",pool:n})),u.skip(d),v<h&&(s[f]=["retain",h-v],f-=1);break;case"remove":(v=u.peekLength())>=h?a.push(u.next(h)):(a.push(u.next()),s[f]=["remove",h-v],f-=1)}}for(var b=0;u.hasNext();)b+=u.peekLength(),u.skip();return b>0&&a.push(new o.default({action:"retain",data:b,packedAttributes:"",pool:n})),new i.Delta(a.stringify(!0),n)}(new i.Delta(t.getCustomData()),n);r.data=a.isEmpty()?1:{delta:a.stringify()}}else r.data=t.data;return r}):null}},function(t,r,n){"use strict";var e,i=this&&this.t||(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(r,"__esModule",{value:!0});var o=n(0),a=n(10),u=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return i(r,t),r.prototype.compose=function(t,r,n){return this.parse(t).compose(this.parse(r),n).stringify()},r.prototype.transform=function(t,r,n){return this.parse(t).transform(this.parse(r),n).stringify()},r.prototype.invert=function(t,r){return this.parse(t).invert(this.parse(r)).stringify()},r.prototype.parse=function(t){return new this.deltaConstructor(t)},r.prototype.pack=function(t){if(Array.isArray(t))return new this.deltaConstructor(t).stringify();if(a.isDelta(t))return t.stringify();throw new Error("Unsupported delta value for packing "+t)},r.prototype.toJSON=function(t){return this.parse(t).toJSON()},r.prototype.explain=function(t,r){return this.parse(r).explain(t)},r}(o.default);r.default=u},function(t,r,n){"use strict";var e,i=this&&this.t||(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(r,"__esModule",{value:!0});var o=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return i(r,t),r.prototype.compose=function(t,r,n){for(var e=this.parse(t),i=this.parse(r),o=0,a=Object.keys(i);o<a.length;o++){var u=a[o],s=e[u],f=i[u];e[u]=void 0===s?f:s.compose(f,n)}return this.pack(e)},r.prototype.transform=function(t,r,n){for(var e=this.parse(t),i=this.parse(r),o=0,a=Object.keys(i);o<a.length;o++){var u=a[o],s=e[u];if(void 0!==s){var f=i[u];i[u]=s.transform(f,n)}}return this.pack(i)},r.prototype.invert=function(t,r){for(var n=this.parse(t),e=this.parse(r),i=0,o=Object.keys(e);i<o.length;i++){var a=o[i],u=n[a]||new this.deltaConstructor([]);e[a]=u.invert(e[a])}return this.pack(e)},r.prototype.parse=function(t){for(var r={},n=0;n<t.length;){var e=t.substring(n,n+8),i=t.indexOf("#",n+8),o=parseInt(t.substring(n+8,i),36),a=new this.deltaConstructor(t.substring(i+1,i+1+o));r[e]=a,n=i+1+o}return r},r.prototype.pack=function(t){for(var r="",n=0,e=Object.keys(t).sort();n<e.length;n++){var i=e[n];if(8!==i.length)throw new Error("element id length must equal to 8, got "+i);var o=t[i],a=Array.isArray(o)?new this.deltaConstructor(o):o;if(a.getIter().hasNext()){var u=a.stringify();r+=""+i+u.length.toString(36)+"#"+u}}return r},r.prototype.toJSON=function(t){for(var r={},n=this.parse(t),e=0,i=Object.keys(n);e<i.length;e++){var o=i[e],a=n[o];r[o]=a.toJSON()}return r},r.prototype.explain=function(t,r){for(var n=t+"Elements:\\n",e=this.parse(r),i=0,o=Object.keys(e);i<o.length;i++){n+=e[o[i]].explain(t)}return n},r}(n(0).default);r.default=o},function(t,r,n){"use strict";var e,i=this&&this.t||(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(r,"__esModule",{value:!0});var o=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return i(r,t),r.prototype.pack=function(r){return t.prototype.pack.call(this,Array.isArray(r)?r:[r.slides,r.layouts,r.notes])},r.prototype.toJSON=function(r){var n=t.prototype.toJSON.call(this,r);return{slides:n[0],layouts:n[1],notes:n[2]}},r.prototype.explain=function(t,r){var n=t+"Slides:\\n",e=this.parse(r),i=e[0],o=e[1],a=e[2];return n+=i?i.explain(t):"[EMPTY]",n+=t+"Layouts:\\n",n+=o?o.explain(t):"[EMPTY]",n+=t+"Notes:\\n",n+=a?a.explain(t):"[EMPTY]"},r}(n(12).default);r.default=o},function(t,r,n){"use strict";var e,i=this&&this.t||(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(r,"__esModule",{value:!0});var o=n(0),a=n(9),u=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return i(r,t),r.prototype.compose=function(t,r,n){return this.pack(a.merge(this.parse(t),this.parse(r),!n),n)},r.prototype.transform=function(t,r,n){return this.pack(a.transform(this.parse(t),this.parse(r),n),!1)},r.prototype.invert=function(t,r){return this.pack(a.invert(this.parse(t),this.parse(r)),!1)},r.prototype.parse=function(t){return JSON.parse(t)},r.prototype.pack=function(t,r){return r?JSON.stringify(t,function(t,r){return null===r?void 0:r}):JSON.stringify(t)},r.prototype.toJSON=function(t){return this.parse(t)},r.prototype.explain=function(t,r){return JSON.stringify(this.parse(r),null,t)},r}(o.default);r.default=u}]);',null)}},2725:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(t){var e=t.sheets,n=!1;for(var r in e){var i=e[r],o=i.invalidAttrCount,a=i.invalidImagesCount,s=i.emptyRowCount,l=i.emptyColCount;(o>0||a>0||s>0||l>0)&&(n=!0)}return n}},2726:function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(2727),a=n.n(o),s=n(2728),l=n.n(s);i.a.addLocaleResource("en-US",a.a),i.a.addLocaleResource("ja-JP",l.a),i.a.setLocaleSync({en:"en-US",jp:"ja-JP"}[document.documentElement.lang]||document.documentElement.lang||"zh-CN")},2727:function(t,e){t.exports={"开始扫描":"Start scan","扫描中...":"Scan...","清理":"Clear","清理中...":"Cleaning...","完成":"Done","该表格是旧版本，您可以导出再导入转成新版本表格，提升运行速度。":"This table is an old version, you can export and import it to convert to a new version table to improve the running speed.","正在扫描":"scanning","待清理":"To be cleared","以下数据导致工作表出现了大量空白单元格，十分影响表格运行速度。请点击下方单元格位置前往查看，然后手动清理。":"The following data caused a large number of blank cells in the worksheet, which greatly affected the speed of the table. Please click on the cell location below to view and manually clean up.","单元格数量过多会影响运行速度。如果您觉得卡顿，可考虑拆分表格或精简行列来减少单元格数量。":"Too many cells can affect speed. If you feel stuck, consider splitting the table or streamlining the columns to reduce the number of cells.","公式数量过多 / 引用范围太大时，会影响运行速度。如果您觉得卡顿，可考虑优化公式写法（比如采用石墨的数组公式，见公式-自定义公式），或拆分成多个表格。":"Too many formulas / too large reference range will affect the running speed. If you feel stuck, you can consider optimizing the formulation of the formula (such as the graphite array formula, see Formula-Custom Formula), or split into multiple tables.","表格的筛选视图过大，请清理数量。":"The filter viewport data is too large, please clear the quantity.","万":"","文件瘦身":"File slimming","数据大小":"Data size","单元格数量":"Cell count","公式数量":"Formula count","筛选视图":"Filter size","无效属性":"Invalid Attributes","无效图片":"Invalid Image","冗余空白行":"Redundant blank row","冗余空白列":"Redundant blank columns","疑似无效数据":"Suspected redundant data"}},2728:function(t,e){t.exports={"开始扫描":"スキャンを開始","扫描中...":"スキャン中...","清理":"片付け","清理中...":"片付け...","完成":"完了","该表格是旧表格, 您可以导出再导入转成新版本表格,提升运行速度":"このテーブルは古いバージョンです。エクスポートおよびインポートして新しいバージョンのテーブルに変換し、実行速度を向上させることができます。","正在扫描":"スキャン中","待清理":"クリアされる","以下数据导致工作表出现了大量空白单元格，十分影响表格运行速度。请点击下方单元格位置前往查看，然后手动清理。":"次のデータにより、ワークシートに多数の空白セルが発生し、テーブルの速度に大きく影響しました。 下のセルの場所をクリックして表示し、手動でクリーンアップしてください。","单元格数量过多会影响运行速度。如果您觉得卡顿，可考虑拆分表格或精简行列来减少单元格数量。":"セルが多すぎると速度に影響する可能性があります。 行き詰まっていると感じた場合は、セルの数を減らすために、テーブルを分割するか、列を合理化することを検討してください。","公式数量过多 / 引用范围太大时，会影响运行速度。如果您觉得卡顿，可考虑优化公式写法（比如采用石墨的数组公式，见公式-自定义公式），或拆分成多个表格。":"数式が多すぎる/参照範囲が大きすぎると、走行速度に影響します。 行き詰まっていると感じた場合は、式の定式化（グラファイトアレイ式など、Formula-Custom Formulaを参照）を最適化するか、複数のテーブルに分割することを検討できます。","表格的筛选视图过大，请清理数量。":"テーブルのフィルタリングされたビューが大きすぎます。数量をクリアしてください。","万":"万","文件瘦身":"ファイルスリミング","数据大小":"データサイズ","单元格数量":"セル数","公式数量":"フォーミュラ番号","筛选视图":"フィルタービュー","无效属性":"無効な属性","无效图片":"無効な画像","冗余空白行":"冗長な空白行","冗余空白列":"冗長な空白列","疑似无效数据":"冗長データが疑われる"}},2729:function(t,e,n){var r=n(2730);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(1736)(r,i);r.locals&&(t.exports=r.locals)},2730:function(t,e,n){var r=n(1737);(t.exports=n(1735)(!1)).push([t.i,".file-slimming-dialog-mask {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.1);\n  display: none; }\n\n.file-slimming-dialog-mask-show {\n  display: block; }\n\n.file-slimming-dialog-container {\n  width: 676px;\n  height: 580px;\n  box-sizing: border-box;\n  padding: 20px 40px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  font-size: 12px;\n  border-radius: 2px;\n  box-shadow: 0 2px 3px 1px rgba(0, 0, 0, 0.1);\n  background-image: linear-gradient(to bottom, #ffffff, #fafafa);\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  margin-top: -290px;\n  margin-left: -338px; }\n\n.file-slimming-dialog-hd {\n  font-size: 16px;\n  margin: 10px 0 20px 0;\n  cursor: default; }\n  .file-slimming-dialog-hd span {\n    float: right;\n    cursor: default; }\n\n@keyframes rotate {\n  0% {\n    -webkit-transform: rotate(0deg); }\n  100% {\n    -webkit-transform: rotate(360deg); } }\n\n.file-slimming-dialog-ft {\n  cursor: default;\n  height: 34px; }\n  .file-slimming-dialog-ft .ft-tip {\n    display: inline-block;\n    vertical-align: top;\n    color: #666; }\n  .file-slimming-dialog-ft .old-sheet-tip {\n    line-height: 34px; }\n    .file-slimming-dialog-ft .old-sheet-tip::before {\n      content: '';\n      display: inline-block;\n      width: 16px;\n      height: 16px;\n      margin-right: 8px;\n      background-image: url("+r(n(2138))+");\n      background-size: 100%;\n      vertical-align: -4px; }\n  .file-slimming-dialog-ft .scanning-tip {\n    line-height: 34px; }\n    .file-slimming-dialog-ft .scanning-tip::before {\n      content: '';\n      background-image: url("+r(n(2139))+");\n      display: inline-block;\n      width: 16px;\n      height: 16px;\n      margin-right: 8px;\n      animation: rotate 1s linear infinite;\n      background-size: 100%;\n      margin-right: 12px;\n      vertical-align: -3px; }\n    .file-slimming-dialog-ft .scanning-tip span {\n      display: inline-block;\n      margin-left: 10px;\n      vertical-align: -4px; }\n  .file-slimming-dialog-ft .result-tip {\n    line-height: 34px; }\n    .file-slimming-dialog-ft .result-tip strong {\n      padding: 0 5px;\n      color: #cd4747; }\n  .file-slimming-dialog-ft .sm-btn {\n    float: right;\n    line-height: 34px;\n    width: 100px; }\n    .file-slimming-dialog-ft .sm-btn.btn-disable {\n      background: #d9dadb; }\n      .file-slimming-dialog-ft .sm-btn.btn-disable:hover {\n        border-color: #d9dadb; }\n\n.file-slimming-dialog-bd {\n  margin-bottom: 32px; }\n  .file-slimming-dialog-bd:after {\n    content: '';\n    display: block;\n    clear: both; }\n\n.file-info-area,\n.clean-target-area {\n  border: solid 1px #e5e5e5;\n  background-color: #ffffff;\n  padding: 24px 0 8px;\n  position: relative; }\n  .file-info-area .scroll-area,\n  .clean-target-area .scroll-area {\n    padding: 0 17px 0 24px;\n    height: 345px;\n    box-sizing: border-box;\n    overflow-x: hidden;\n    overflow-y: auto; }\n\n.file-info-area {\n  width: 256px;\n  float: left; }\n\n.clean-target-area {\n  width: 320px;\n  float: right; }\n\n.area-title {\n  font-size: 14px;\n  line-height: 1.14;\n  color: #41464b;\n  margin-bottom: 26px;\n  padding-left: 24px; }\n\n.file-info-item {\n  margin-bottom: 28px; }\n\n.item-file-size,\n.item-cell-count,\n.item-formula-count,\n.item-filter-size {\n  overflow: hidden; }\n  .item-file-size em,\n  .item-cell-count em,\n  .item-formula-count em,\n  .item-filter-size em {\n    float: right;\n    line-height: 24px;\n    font-style: normal;\n    color: #6da0e3;\n    margin-right: 21px; }\n    .item-file-size em.gray,\n    .item-cell-count em.gray,\n    .item-formula-count em.gray,\n    .item-filter-size em.gray {\n      color: #ccc; }\n  .item-file-size span,\n  .item-cell-count span,\n  .item-formula-count span,\n  .item-filter-size span {\n    float: left;\n    line-height: 24px;\n    font-weight: 500;\n    color: #333; }\n    .item-file-size span:before,\n    .item-cell-count span:before,\n    .item-formula-count span:before,\n    .item-filter-size span:before {\n      content: '';\n      display: inline-block;\n      width: 24px;\n      height: 24px;\n      margin-right: 8px;\n      vertical-align: top; }\n\n.item-file-size span:before {\n  background-image: url("+r(n(2731))+"); }\n\n.item-cell-count span:before {\n  background-image: url("+r(n(2732))+"); }\n\n.item-formula-count span:before {\n  background-image: url("+r(n(2733))+"); }\n\n.item-filter-size span:before {\n  background-image: url("+r(n(2734))+"); }\n\n.detail-item {\n  padding: 13px 21px 0 32px; }\n  .detail-item em {\n    float: right;\n    font-style: normal;\n    color: #ccc;\n    white-space: nowrap; }\n    .detail-item em i {\n      font-size: 13px;\n      font-style: normal;\n      cursor: pointer;\n      color: #555;\n      padding: 0 5px; }\n      .detail-item em i:hover {\n        color: #6290cc; }\n  .detail-item span {\n    float: left;\n    width: 79px;\n    overflow: hidden;\n    height: 13px;\n    color: #555; }\n  .detail-item .prompt {\n    vertical-align: -4px;\n    margin: 0 -21px 0 5px; }\n  .detail-item:after {\n    content: '';\n    display: block;\n    clear: both;\n    height: 0;\n    font-size: 0; }\n\n.clear-target-item {\n  margin-bottom: 29px;\n  min-height: 40px; }\n\n.item-invalid-attrs span,\n.item-invalid-img span,\n.item-empty-row span,\n.item-empty-col span,\n.item-invalid-data span {\n  float: left;\n  height: 40px;\n  line-height: 40px;\n  font-weight: 500;\n  color: #333; }\n  .item-invalid-attrs span:before,\n  .item-invalid-img span:before,\n  .item-empty-row span:before,\n  .item-empty-col span:before,\n  .item-invalid-data span:before {\n    content: '';\n    display: inline-block;\n    vertical-align: top;\n    width: 40px;\n    height: 40px;\n    background-size: 100%;\n    margin-right: 16px; }\n\n.item-invalid-attrs em,\n.item-invalid-img em,\n.item-empty-row em,\n.item-empty-col em,\n.item-invalid-data em {\n  float: right;\n  line-height: 40px;\n  color: #cd4747;\n  font-style: normal;\n  font-size: 16px;\n  margin-right: 24px; }\n  .item-invalid-attrs em.gray,\n  .item-invalid-img em.gray,\n  .item-empty-row em.gray,\n  .item-empty-col em.gray,\n  .item-invalid-data em.gray {\n    color: #ccc; }\n\n.item-invalid-attrs::after,\n.item-invalid-img::after,\n.item-empty-row::after,\n.item-empty-col::after,\n.item-invalid-data::after {\n  content: '';\n  display: block;\n  clear: both;\n  height: 0;\n  overflow: hidden; }\n\n.item-invalid-attrs span::before {\n  background-image: url("+r(n(2735))+"); }\n\n.item-invalid-img span::before {\n  background-image: url("+r(n(2736))+"); }\n\n.item-empty-row span::before {\n  background-image: url("+r(n(2737))+"); }\n\n.item-empty-col span::before {\n  background-image: url("+r(n(2738))+"); }\n\n.item-invalid-data span::before {\n  background-image: url("+r(n(2739))+"); }\n\n.invalid-data-tip {\n  float: right;\n  color: #cd4747;\n  font-size: 16px;\n  line-height: 40px; }\n  .invalid-data-tip .prompt {\n    margin-left: 8px;\n    margin-top: 12px; }\n\n.prompt {\n  width: 16px;\n  height: 16px;\n  display: inline-block;\n  vertical-align: top;\n  background-image: url("+r(n(2138))+");\n  background-size: 100%; }\n  .prompt:hover .prompt_inner {\n    display: block; }\n  .prompt .prompt_inner {\n    width: 250px;\n    border-radius: 2px;\n    box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.2);\n    border: solid 0.5px rgba(229, 229, 229, 0.1);\n    background-color: #ffffff;\n    padding: 20px;\n    box-sizing: border-box;\n    position: fixed;\n    top: -15px;\n    left: 30px;\n    font-size: 12px;\n    line-height: 1.67;\n    color: #666;\n    display: none;\n    z-index: 2;\n    white-space: normal; }\n    .prompt .prompt_inner::before {\n      content: '';\n      display: inline-block;\n      width: 16px;\n      height: 12px;\n      background-image: url("+r(n(2740))+");\n      position: absolute;\n      top: 15px;\n      left: -13px;\n      transform: rotate(-90deg);\n      background-size: 100%; }\n\n.btn-clean,\n.btn-cleaning,\n.btn-clean:hover,\n.btn-cleaning:hover {\n  border: solid 1px #cd4747;\n  background-image: linear-gradient(to top, #cd4747, #e95555); }\n\n.btn-cleaning::before {\n  content: '';\n  background-image: url("+r(n(2139))+");\n  display: inline-block;\n  width: 16px;\n  height: 16px;\n  margin-right: 5px;\n  margin-left: -15px;\n  animation: rotate 1s linear infinite;\n  background-size: 100%;\n  vertical-align: -3px; }\n",""])},2731:function(t,e,n){t.exports=n.p+"images/icon_file_size.002809b2be.svg"},2732:function(t,e,n){t.exports=n.p+"images/icon_cell_count.3314f01619.svg"},2733:function(t,e,n){t.exports=n.p+"images/icon_formula_count.205d8125c5.svg"},2734:function(t,e,n){t.exports=n.p+"images/icon_filter_size.0384193c10.svg"},2735:function(t,e,n){t.exports=n.p+"images/icon_invalid_attrs.39b07a177e.svg"},2736:function(t,e,n){t.exports=n.p+"images/icon_invalid_img.c852b364ce.svg"},2737:function(t,e,n){t.exports=n.p+"images/icon_empty_row.93c7af2a67.svg"},2738:function(t,e,n){t.exports=n.p+"images/icon_empty_col.b3133abe97.svg"},2739:function(t,e,n){t.exports=n.p+"images/icon_invalid_data.154c816a27.svg"},2740:function(t,e,n){t.exports=n.p+"images/arrow.5870154810.png"}});